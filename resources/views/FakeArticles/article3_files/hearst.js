var _____WB$wombat$assign$function_____ = function(name) {return (self._wb_wombat && self._wb_wombat.local_init && self._wb_wombat.local_init(name)) || self[name]; };
if (!self.__WB_pmw) { self.__WB_pmw = function(obj) { this.__WB_source = obj; return this; } }
{
  let window = _____WB$wombat$assign$function_____("window");
  let self = _____WB$wombat$assign$function_____("self");
  let document = _____WB$wombat$assign$function_____("document");
  let location = _____WB$wombat$assign$function_____("location");
  let top = _____WB$wombat$assign$function_____("top");
  let parent = _____WB$wombat$assign$function_____("parent");
  let frames = _____WB$wombat$assign$function_____("frames");
  let opener = _____WB$wombat$assign$function_____("opener");

(function(){var getDG=function(){var x={};return x;};var getP=function(){var x={};try{x['-1270055264']=[' div.article-body div.article-text > p:nth-of-type(2)', 'div.article-body > p:nth-of-type(2)', 'div.hdnce-item-87761 > header > div.button', 'div.hdnce-item-87761 > header > div.button > a', 'li.ht-saved > span', 'li[id=\'subscribe\']', 'li[id=\'subscription\'] > button', 'li[id=\'subscription\'] > button.btn', 'section.body > p:nth-of-type(2)'];x['-196441184']=['#OOP', '.header-title', 'a.breadcrumb', 'div#pagecontent > div.core-headline-list', 'div#section-title', 'div.article-body', 'div.article-body > div.article-text > p:nth-of-type(2)', 'div.article-text > p:nth-of-type(2)', 'div.hdnce-collection-72611-core_headline_list > div.core-headline-list', 'div.hdnce-collection-80738-core_package > div.core-package ', 'div.hdnce-collection-81342-core_promo > div.core-promo', 'div.most-popular', 'div.pkt-pagetitle', 'div[id=\'siteheader\']', 'h1.headline', 'li.social-links-comments > a.hdn-analytics'];x['1144686976']=['.article--footer > .content-wrapper:first-child', 'a.breadcrumb', 'div.article-body > p:nth-of-type(2)', 'div.article-sidebar > div.most-popular', 'div.article-title > h1', 'div.articleFooter', 'div.asset_relatedlinks', 'div.hdnce-collection-53891-core_centerpiece > div.core-centerpiece > div.centerpiece-container', 'div.hdnce-collection-53891-core_centerpiece > div.core-centerpiece > div.centerpiece-container > div.centerpiece-headlinelist', 'div.hdnce-collection-62078-core_promo > div.core-promo', 'div.hdnce-collection-78469-core_centerpiece > div.core-centerpiece', 'div.hdnce-collection-81342-core_promo > div.core-promo', 'div.hdnce-item-33813 > div#hst-mediumrectangle4', 'div.most-popular > div.header > h2', 'div.mostPopular', 'div.subHead', 'div:nth-of-type(2) > div.six-3', 'div:nth-of-type(2) > div.six-3 > div.most-popular', 'div:nth-of-type(2) > div.six-3 > div.most-popular > div.header > h2', 'html > body > header', 'li.text'];x['-184702304']=x['1144686976'];x['-1953928160']=x['1144686976'];x['1569898976']=x['1144686976'];x['-1955062144']=x['1144686976'];x['-983973056']=x['1144686976'];x['-1267200480']=['.article--footer > .content-wrapper:first-child', 'div:nth-of-type(2) > div.six-3 > div.hdnce-collection-72904-core_multimedia_package > div.core-multimedia-package'];x['-1917018816']=['.aside:first-of-type', 'aside[id=\'zoneC\'] > div.mostPopular', 'div.article-body > p:nth-of-type(2)', 'div.article-body > p:nth-of-type(3)', 'div.article-body >p:last-of-type', 'div.article-body div.article-text > p:nth-of-type(2)', 'div.articleFooter', 'div.author-module', 'div.hst-freeform', 'div.moduleHeader', 'div.mostPopular', 'div.zone-5 > div.hide-rss-link > div.collection > div:nth-of-type(1)', 'div[id=\'articleRibbon\'] > div.lock', 'div[id=\'module_B_first\']', 'div[id=\'zoneAR\']', 'div[id=\'zoneAR\'] > div.hdnce-item-94672', 'div[id=\'zoneAR\'] > div.hide-rss-link > div.collectionHeader', 'div[id=\'zoneAR\'] > div.hide-rss-link > section.thumbnailList', 'div[id=\'zoneAR\'] > div.hide-rss-link > section.thumbnailList > div.thumbnailList--wrapper > ul.thumbnailList--items > li.thumbnailList--item > div.thumbnailList--item-abstract', 'div[id=\'zoneAR\'] > div.hide-rss-link > section.thumbnailList > div.thumbnailList--wrapper > ul.thumbnailList--items > li.thumbnailList--item > div.thumbnailList--item-header > a.thumbnailList--item-headline', 'div[id=\'zoneBL\'] > div.hide-rss-link > section.core-package > ul.corePackage--items-5', 'footer.article--footer > div.content-wrapper', 'li[id=\'subscribe\']', 'li[id=\'subscription\'] > button', 'section.body', 'section.body > :last-child', 'section.body > p:nth-of-type(1)', 'section.body > p:nth-of-type(2)', 'section.coreHeadlineList'];x['1886537920']=['.header-title', 'a.breadcrumb', 'div#pagecontent > div.core-headline-list', 'div.article-body', 'div.article-body > div.article-text > p:nth-of-type(2)', 'div.article-text > p:nth-of-type(2)', 'div.hdnce-collection-80738-core_package > div.core-package', 'div.hdnce-collection-81342-core_promo > div.core-promo', 'div[id=\'siteheader\']', 'h1.headline', 'li.social-links-comments > a.hdn-analytics', 'section.coreHeadlineList', 'section.coreHeadlineList > ul'];x['492304000']=['a.breadcrumb', 'div.article-body', 'div.article-body > p:nth-of-type(2)', 'div.article-body > p:nth-of-type(7)', 'div.article-share > div.social-links > ul.right > li.print > a.hdn-analytics > span.icon', 'div.article-sidebar > div.most-popular', 'div.article-title', 'div.article-title > h1', 'div.hdnce-collection-53891-core_centerpiece > div.core-centerpiece > div.centerpiece-container', 'div.hdnce-collection-78469-core_centerpiece > div.core-centerpiece', 'div.hdnce-collection-81342-core_promo > div.core-promo', 'div.hdnce-collection-81635-core_promo > div.core-promo', 'div.hdnce-collection-86143-core_promo > div.core-promo', 'div.hdnce-item-33813 > div#hst-mediumrectangle4', 'div.most-popular', 'div.most-popular > div.header > h2', 'div.subHead', 'div:nth-of-type(2) > div.six-3 > div.most-popular', 'div:nth-of-type(2) > div.six-3 > div.most-popular > div.header > h2', 'li.text'];x['-1060344064']=['a.featureSubscribe', 'a.regSubscribe', 'a.special-nav-subscribe-link', 'article.article--content > p:nth-of-type(2)', 'aside[id=\'zoneC\'] > div.mostPopular', 'div.article-body > p:nth-of-type(2)', 'div.articleFooter', 'div.gallery--list > div:nth-of-type(1)', 'div.hst-freeform > div > a', 'div.most-popular', 'div.mostPopular', 'div.pagecontent', 'div.slideshow--description', 'div[id=\'paywall\']', 'div[id=\'paywall\'] > p:nth-of-type(1)', 'div[id=\'paywall\'] > p:nth-of-type(3)', 'div[id=\'zoneAR\']', 'footer.article--footer > div:nth-of-type(1)', 'html > body > header', 'li.rss', 'li.subscribe', 'li.subscribe > a.subMenuLink', 'li.text', 'li[id=\'subscription\'] > button', 'li[id=\'subscription\'] > button.btn', 'section.article--body > :last-child', 'section.article--body > p:nth-of-type(3)', 'section.factBox', 'ul.pageHeader--links'];x['961723840']=x['-1060344064'];x['1975512864']=x['-1060344064'];x['30815072']=['a.featureSubscribe', 'a.special-nav-subscribe-link', 'a[id=\'menu-open\']', 'button.hidden-xs', 'div#ctpl-fullbanner2', 'div.article-body > p:nth-of-type(1)', 'div.most-popular', 'div:nth-of-type(2) > div.column', 'div:nth-of-type(2) > div.six-3 > div.hst-freeform > div.ftb-widget', 'div[id=\'paywall\'] > p:nth-of-type(1)', 'div[id=\'subHead\']', 'footer.article--footer > div.content-wrapper', 'html > body > header', 'nav#navigation', 'section.factBox', 'section.relatedStories', 'span[id=\'sub_nonmember\']'];x['1569223328']=['a.featureSubscribe', 'a.special-nav-subscribe-link', 'a[id=\'nav_subscribe\']', 'button.hidden-xs', 'div.article-body > p:nth-of-type(1)', 'div.most-popular', 'div[id=\'paywall\'] > p:nth-of-type(1)', 'div[id=\'subHead\']', 'footer.article--footer > div.content-wrapper', 'html > body > header', 'li.cars > a.subMenuLink', 'nav[id=\'siteNav\']', 'span[id=\'sub_nonmember\']'];x['900192000']=['a.featureSubscribe', 'a.special-nav-subscribe-link', 'aside[id=\'zoneC\'] > div.mostPopular', 'aside[id=\'zoneD\']> div:nth-of-type(1)', 'div#gigya-premium-user-logged-in-limbo', 'div.article-body > p:nth-of-type(2)', 'div.article-body div.article-text > p:nth-of-type(2)', 'div.article-text', 'div.article-text > div:nth-of-type(2)', 'div.articleFooter', 'div.author-module', 'div.card', 'div.centerpiece-tab-secondary', 'div.featuredStory--header', 'div.hdnce-collection-105157-dynamic_featured_story > div.featuredStory', 'div.hdnce-collection-105611-dynamic_package > section.core-package', 'div.hdnce-collection-105778-dynamic_package > section.core-package', 'div.hdnce-collection-106132-dynamic_featured_story > div.featuredStory', 'div.hdnce-item-87761 > header > div.button', 'div.headlineList', 'div.hourly > div.header', 'div.hst-freeform > iframe', 'div.most-popular', 'div.mostPopular', 'div.zone-2', 'div.zone-8', 'div[id=\'articleRibbon\'] > div.lock', 'div[id=\'module_B_first\']', 'div[id=\'paywall\'] > p:nth-of-type(1)', 'div[id=\'spcv_conversation\'] > div', 'div[id=\'zoneAL\']', 'div[id=\'zoneAL\'] > div.hst-freeform', 'div[id=\'zoneAR\'] > div.hdnce-item-94672', 'div[id=\'zoneAR\'] > div.hdnce-item-94807', 'div[id=\'zoneAR\'] > div.hide-rss-link > div.featuredStory', 'div[id=\'zoneEL\'] > div.hide-rss-link > section.core-package', 'div[id=\'zoneEL\'] > div.hide-rss-link > section.core-package > ul.corePackage--items-5', 'footer > div.content-wrapper > div:nth-of-type(1)', 'html > body > header', 'iframe[id=\'datawrapper-chart-KhdcR\']', 'img.wide-only', 'li.ht-saved', 'li[id=\'subscribe\']', 'li[id=\'subscription\'] > button', 'li[id=\'subscription\'] > button.btn', 'section.body > :last-child', 'section.body > p:nth-of-type(1)', 'section.body > p:nth-of-type(10)', 'section.body > p:nth-of-type(2)', 'section.body > p:nth-of-type(3)', 'section.body > p:nth-of-type(5)', 'section.body > p:nth-of-type(6)', 'section.core-package', 'section.coreHeadlineList', 'section.dynamic-river', 'section.factBox'];x['2081625024']=x['900192000'];x['1483332768']=x['900192000'];x['722941248']=['a.featureSubscribe', 'a.special-nav-subscribe-link', 'aside[id=\'zoneC\'] > div.mostPopular', 'aside[id=\'zoneD\']> div:nth-of-type(1)', 'div.article-body > p:nth-of-type(2)', 'div.article-body div.article-text > p:nth-of-type(2)', 'div.articleFooter', 'div.author-module', 'div.hc-ft-columnists', 'div.hdnce-collection-105810-dynamic_thumbnail_list > section.thumbnailListAuthor', 'div.hdnce-collection-106282-dynamic_thumbnail_list > div.collectionHeader', 'div.hdnce-collection-106300-dynamic_featured_story > div.featuredStory > div.card', 'div.hdnce-item-95230 > iframe', 'div.hst-freeform > div', 'div.mostPopular', 'div[id=\'articleRibbon\'] > div.lock', 'div[id=\'module_B_first\']', 'div[id=\'paywall\'] > p:nth-of-type(1)', 'div[id=\'zoneAR\']', 'div[id=\'zoneBR\'] > div.hide-rss-link', 'footer > div.content-wrapper > div:nth-of-type(1)', 'html > body > header', 'li.ht-saved', 'li[id=\'subscription\'] > button', 'li[id=\'subscription\'] > button.btn', 'section.body > p:nth-of-type(2)', 'section.body >:last-child', 'section.factBox'];x['-80394400']=x['722941248'];x['1686783328']=x['722941248'];x['614631808']=['a.featureSubscribe', 'a.special-nav-subscribe-link', 'aside[id=\'zoneC\'] > div.mostPopular', 'div.article-body > p:nth-of-type(1)', 'div.article-body > p:nth-of-type(2)', 'div.article-text > p:nth-of-type(2)', 'div.articleFooter', 'div.full-page', 'div.hc-ft-columnists', 'div.hc_breaking', 'div.hdnce-item-95003', 'div.header-branding', 'div.hst-freeform', 'div.mostPopular', 'div.right-rail>div:first-of-type', 'div.wide-only:first-of-type', 'div:nth-of-type(1) > div.sticky > div.adModule', 'div[data-tb-region=\"zoneAR\"]>div:first-of-type', 'div[id=\'articleRibbon\'] > div.lock', 'div[id=\'module_A_first\']', 'div[id=\'module_A_last\']', 'div[id=\'module_B_first\']', 'div[id=\'paywall\'] > p:nth-of-type(1)', 'div[id=\'zoneAR\'] > div.hide-rss-link > section.thumbnail-list', 'footer > div.content-wrapper > div:nth-of-type(1)', 'html > body > header', 'li.ht-saved > span', 'li[id=\'subscription\'] > button', 'li[id=\'subscription\'] > button.btn', 'main[id=\'content\'] > article > p:nth-of-type(1)', 'section.body > p:nth-of-type(1)', 'section.body > p:nth-of-type(2)', 'section.body >:last-child', 'section.factBox'];x['570455488']=x['614631808'];x['-1583596096']=['a.featureSubscribe', 'a.special-nav-subscribe-link', 'button.hidden-xs', 'div.article-body > p:nth-of-type(1)', 'div.most-popular', 'div[id=\'paywall\'] > p:nth-of-type(1)', 'div[id=\'subHead\']', 'footer.article--footer > div.content-wrapper', 'html > body > header', 'span[id=\'sub_nonmember\']'];x['-1743355680']=x['-1583596096'];x['1772560736']=x['-1583596096'];x['1422286496']=x['-1583596096'];x['-297623584']=x['-1583596096'];x['1087950208']=x['-1583596096'];x['989910848']=['a.featureSubscribe', 'a.special-nav-subscribe-link', 'button.hidden-xs', 'div.author-module', 'div.hdnce-collection-97550-premium_headlinelist_illus > div.headlineList', 'div.hdnce-collection-97550-premium_headlinelist_illus > div.headlineList > div.moduleHeader', 'div[id=\'BC-ctpremium-hp-nl-signup\']', 'div[id=\'paywall\'] > p:nth-of-type(1)', 'div[id=\'zoneAR\'] > div.hide-rss-link', 'div[id=\'zoneBR\']', 'footer.article--footer > div.content-wrapper', 'html > body > header', 'li[id=\'subscription\'] > button', 'li[id=\'subscription\'] > button.btn', 'section.body > em > p', 'section.body > p:nth-of-type(1)', 'section.body > p:nth-of-type(2)', 'section.centerpiece', 'section.centerpiece-container'];x['1923229568']=x['989910848'];x['-1918359264']=x['989910848'];x['-1407488128']=['a.featureSubscribe', 'a.special-nav-subscribe-link', 'button.hidden-xs', 'div.most-popular', 'div[id=\'paywall\'] > p:nth-of-type(1)', 'footer.article--footer', 'footer.article--footer > div.content-wrapper', 'html > body > header', 'section.body > :last-child'];x['-1455777568']=['a.featureSubscribe', 'a.special-nav-subscribe-link', 'button.hidden-xs', 'div.most-popular', 'div[id=\'paywall\'] > p:nth-of-type(1)', 'html > body > header'];x['-1517567936']=['a.featureSubscribe', 'a.special-nav-subscribe-link', 'button.hidden-xs', 'div[id=\'paywall\'] > p:nth-of-type(1)', 'html > body > header'];x['-719858528']=x['-1517567936'];x['-1304132704']=x['-1517567936'];x['201560640']=x['-1517567936'];x['303413952']=x['-1517567936'];x['-228479808']=x['-1517567936'];x['623482336']=x['-1517567936'];x['1644699296']=x['-1517567936'];x['-1853206656']=x['-1517567936'];x['-484630464']=x['-1517567936'];x['-887210720']=x['-1517567936'];x['1027706080']=x['-1517567936'];x['-940894304']=x['-1517567936'];x['-1964687616']=x['-1517567936'];x['1396345440']=['a.regSubscribe', 'article.article--content-body > p:nth-of-type(3)', 'div#paywall > p:first-child', 'div.article-body > p:nth-of-type(2)', 'div.article-body > p:nth-of-type(7)', 'div.core-centerpiece', 'div.moduleHeader', 'div.most-popular', 'div.pagecontent', 'html > body > header', 'li.rss', 'li.text > a', 'li[id=\'subscription\'] > button', 'li[id=\'subscription\'] > button.btn', 'section.article--body > p:last-of-type', 'section.article--body > p:nth-of-type(3)'];x['-1176760992']=x['1396345440'];x['-1675972800']=['a.regSubscribe', 'button.hidden-xs', 'div.entry', 'div.entry > p:nth-of-type(2)', 'div.pagecontent'];x['405745664']=['a.subMenuLink > span.logo', 'html > body > header', 'li[id=\'subscription\'] > button'];x['1096748224']=x['405745664'];x['917271232']=['a[id=\'mastheadLogo\']', 'div:nth-of-type(2) > div.six-3 > div.most-popular', 'div:nth-of-type(9) > div.col > div.most-popular'];x['-284143136']=['a[id=\'nav_subscribe\']', 'button.hidden-xs', 'div.most-popular', 'div.subHead', 'html > body > header', 'span[id=\'sub_nonmember\']'];x['-378314176']=['article.article--content > div.content-wrapper', 'article.article--content > p:nth-of-type(2)', 'aside[id=\'zoneC\'] > div.mostPopular', 'aside[id=\'zoneE\']', 'div.BC_wrapper', 'div.article-body > :last-child', 'div.article-body > p:nth-of-type(2)', 'div.articleFooter', 'div.articleFooter--bio > p', 'div.hdnce-collection-104461-dynamic_thumbnail_list', 'div.mostPopular', 'div.pagecontent', 'div.readMore--container', 'html > body > main > section:nth-of-type(2)', 'li[id=\'subscription\'] > button', 'section.article--body > :last-child', 'section.article--body > p:last-of-type', 'section.article--body > p:nth-of-type(3)', 'section.article--content > article', 'section.body > p:nth-of-type(2)'];x['-320925696']=['aside.aside'];x['-606554400']=['aside.aside:first-of-type', 'aside[id=\'zoneC\'] > div.mostPopular', 'div.article-body > p:nth-of-type(2)', 'div.author-module', 'div.collection.hc-ft-columnists', 'div.hdnce-collection-106130-dynamic_featured_story', 'div.hst-freeform', 'div.mostPopular', 'div.mostPopuldiv.SubABenefit_BCwrapperBenefitdiv.SubABenefit_BCwrapperBenefitar', 'div.right-rail>div:first-of-type', 'div.wide-only:first-of-type', 'div[data-tb-region=\"zoneAR\"]>div:first-of-type', 'div[id=\'articleRibbon\'] > div.lock', 'div[id=\'module_B_first\']', 'div[id=\'paywall\'] > p:nth-of-type(1)', 'footer.article--footer', 'footer.article--footer > div.content-wrapper', 'section.body', 'section.body > p:nth-of-type(1)', 'section.body > p:nth-of-type(2)', 'section.body >:last-child'];x['-1927707456']=['aside[id=\'zoneC\'] > div.mostPopular', 'div.article-body > p:nth-of-type(2)', 'div.article-body div.article-text > p:nth-of-type(2)', 'div.articleFooter', 'div.author-module', 'div.mostPopular', 'div:nth-of-type(2) > aside.ad-point', 'div[id=\'articleRibbon\'] > div.lock', 'div[id=\'module_B_first\']', 'footer.article--footer > div.content-wrapper > div:nth-of-type(1)', 'section.body > p:nth-of-type(2)', 'section.body >:last-child'];x['-276597760']=['button.hidden-xs', 'div.article-body > p:nth-of-type(2)', 'div:nth-of-type(2) > div.hst-freeform', 'div:nth-of-type(2) > div.most-popular', 'div[id=\'paywall\']', 'html > body > header', 'span[id=\'sub_nonmember\']'];x['447954144']=['button.hidden-xs', 'div.article-body > p:nth-of-type(2)', 'div:nth-of-type(2) > div.most-popular', 'html > body > header', 'span[id=\'sub_nonmember\']'];x['-606908608']=['button.hidden-xs', 'div.article-body > p:nth-of-type(2)', 'div:nth-of-type(2) > div.most-popular', 'span[id=\'sub_nonmember\']'];x['-435351360']=['button.hidden-xs', 'div.article-body > p:nth-of-type(2)', 'html > body > header', 'span[id=\'sub_nonmember\']'];x['-506345280']=['button.hidden-xs', 'div.article-body > p:nth-of-type(2)', 'html > body > header'];x['899991040']=['button.hidden-xs', 'div.article-body > p:nth-of-type(2)', 'span[id=\'sub_nonmember\']'];x['-1767692224']=['button.hidden-xs', 'div.hdnce-collection-64735-core_promo > div.core-promo', 'div.hdnce-collection-64735-core_promo > div.core-promo > div.header > a > h2', 'div.hdnce-collection-85508-core_centerpiece_tab > div.core-centerpiece-tab > ul > li.first > span.centerpiece-item > a.hdn-analytics', 'div.most-popular', 'li[id=\'reg_member\'] > a:nth-of-type(1)', 'span#reg_nonmember > a:nth-of-type(1)', 'span[id=\'sub_nonmember\'] > a'];x['-404793696']=['button.hidden-xs', 'div.most-popular', 'div:nth-of-type(2) > div.column', 'div:nth-of-type(2) > div.six-3 > div.hst-freeform > div.ftb-widget', 'div[id=\'subHead\']', 'html > body > header', 'li:nth-of-type(11)', 'span[id=\'sub_nonmember\']'];x['-1911783904']=['button.hidden-xs', 'div.most-popular', 'div[id=\'subHead\']', 'html > body > header', 'span[id=\'sub_nonmember\']'];x['1183155872']=x['-1911783904'];x['2122520864']=x['-1911783904'];x['1652373984']=['button.hidden-xs', 'div:nth-of-type(2) > div.six-3 > div.most-popular', 'div:nth-of-type(9) > div.col > div.most-popular', 'div[id=\'subHead\']', 'html > body > header', 'span[id=\'sub_nonmember\']'];x['2122138144']=['button.hidden-xs', 'div:nth-of-type(2) > div.six-3 > div.most-popular', 'div:nth-of-type(9) > div.col > div.most-popular', 'html > body > header'];x['362820416']=['button.hidden-xs', 'html > body > header', 'span[id=\'sub_nonmember\']'];x['-2010476576']=['button.hidden-xs', 'html > body > header'];x['-172491584']=x['-2010476576'];x['-127674496']=x['-2010476576'];x['1113332320']=x['-2010476576'];x['2031745056']=x['-2010476576'];x['3650784']=x['-2010476576'];x['-221101504']=x['-2010476576'];x['-1971990464']=x['-2010476576'];x['594549152']=x['-2010476576'];x['898283040']=x['-2010476576'];x['529295168']=x['-2010476576'];x['533220416']=x['-2010476576'];x['-115949120']=x['-2010476576'];x['-1298993824']=x['-2010476576'];x['1152741760']=['button.hidden-xs'];x['18176160']=['div#bcProfileContainer', 'div.article-body > p:nth-of-type(2)', 'div.article-body div.article-text > p:nth-of-type(2)', 'div.hc-ft-columnists', 'div.header-social', 'div.hst-freeform > div', 'div.stickyItem', 'div.sync-inline-overlay > p:nth-of-type(n+3)', 'div[id=\'articleRibbon\'] > div.lock', 'div[id=\'module_B_first\']', 'div[id=\'zoneAR\'] > div.hide-rss-link > div.featuredStory > div.card', 'html > body > header', 'li.ht-saved', 'li.ht-saved > span > a', 'li[id=\'subscription\'] > button', 'li[id=\'subscription\'] > button.btn', 'section.body > p:nth-of-type(13)', 'section.body > p:nth-of-type(2)'];x['981099456']=['div#ctpl-mediumrectangle1', 'div.centerpiece-container', 'div.comments-in > div', 'div.hdnce-collection-66595-core_headline_list > div.core-headline-list', 'div:nth-of-type(4) > div.column > div.hst-freeform > div.newsletter-section-sign-up', 'div:nth-of-type(6) > div.column > div.hst-freeform', 'div[id=\'siteheader\']', 'span.subscribe'];x['193741024']=['div#ctpl-mediumrectangle1', 'div.comments-in > div', 'div.hdnce-collection-66595-core_headline_list > div.core-headline-list', 'div:nth-of-type(4) > div.column > div.hst-freeform > div.newsletter-section-sign-up', 'div:nth-of-type(6) > div.column > div.hst-freeform > div.newsletter-section-sign-up', 'div[id=\'siteheader\']', 'span.subscribe'];x['1730984928']=['div#gigya-profile-user-logged-in > div.gya-greeting', 'div.article-body > p:nth-of-type(2)', 'div.article-body div.article-text > p:nth-of-type(2)', 'div.article-text', 'div.article-text > div#AP300', 'div.collection > div.ad_container', 'div.hc-ft-columnists', 'div.hdnce-item-93751', 'div.sync-inline-overlay > p:nth-of-type(n+1)', 'div.zone-2 > div.hide-rss-link > div.collection', 'div[id=\'articleRibbon\'] > div.lock', 'div[id=\'module_B_first\']', 'html > body > header', 'li.ht-saved', 'li.ht-saved > span > a', 'li[id=\'subscribe\']', 'li[id=\'subscription\'] > button', 'li[id=\'subscription\'] > button.btn', 'section.body > p:nth-of-type(2)'];x['1339329216']=['div#paywall > p:nth-of-type(3)', 'div.SubABenefit_BCwrapperBenefit', 'div.article-body > p:nth-of-type(2)', 'div.article-text > p:nth-of-type(2)', 'div.author-module', 'div.coreHeadlineList--header > h2', 'div.left > div.hst-freeform', 'div.mostPopular', 'div.pageHeader--wrapper', 'div.right > div.hide-rss-link > section.coreHeadlineList', 'div[id=\'articleRibbon\'] > div.lock', 'div[id=\'module_A_2\']', 'div[id=\'module_A_first\']', 'div[id=\'module_A_last\']', 'div[id=\'module_B_2\']', 'div[id=\'module_B_first\']', 'div[id=\'module_B_last\']', 'div[id=\'module_C_2\']', 'div[id=\'module_C_3\']', 'div[id=\'module_C_first\']', 'div[id=\'module_C_last\']', 'html > body > header', 'iframe[id=\'google_ads_iframe_\/36117602\/hnp-hearstdemosite\/hearstdemozone_3\']', 'li.ht-saved > span', 'li[id=\'subscription\'] > button', 'li[id=\'subscription\'] > button.btn', 'section.body > p:nth-of-type(1)', 'section.body > p:nth-of-type(2)'];x['-1738399232']=['div#paywall > p:nth-of-type(3)', 'div.author-module', 'div.centerpiece-tab-secondary', 'div.pageHeader--wrapper', 'div[id=\'zoneAR\'] > div.hide-rss-link', 'div[id=\'zoneAR\'] > div.hst-freeform', 'div[id=\'zoneBR\'] > div.hide-rss-link', 'footer.article--footer > div.content-wrapper', 'footer.footer', 'html > body > header', 'li[id=\'subscription\'] > button', 'section.body > p:nth-of-type(1)', 'section.body > p:nth-of-type(2)', 'section.centerpiece-container', 'ul.pageHeader--links'];x['-1903245856']=x['-1738399232'];x['1594125536']=x['-1738399232'];x['-281235872']=['div#paywall > p:nth-of-type(3)', 'div.hdnce-collection-97561-premium_headlinelist_illus', 'div[id=\'BC-ctpremium-hp-nl-signup\']', 'div[id=\'container\']', 'div[id=\'headerZone\'] > div.hst-freeform', 'li[id=\'subscription\'] > button', 'section.body > p:nth-of-type(2)', 'section.body >:last-child'];x['-1567874496']=x['-281235872'];x['-1027963648']=x['-281235872'];x['643054304']=['div.app-container > nav'];x['-1611187712']=x['643054304'];x['1303574976']=x['643054304'];x['-2143469088']=x['643054304'];x['-1483599232']=['div.article-body > div.article-text > p:nth-of-type(2)', 'div.article-text > p:nth-of-type(2)'];x['2110513824']=['div.article-body > div.article-text > p:nth-of-type(2)', 'div.core-thumbnail-list', 'div.pkt-pagetitle', 'div[id=\'siteheader\']', 'span.subscribe', 'span.subscribe > a'];x['-1306773888']=['div.article-body > div.article-text > p:nth-of-type(2)', 'div.core-thumbnail-list', 'div.pkt-pagetitle', 'div[id=\'siteheader\']'];x['-295196960']=['div.article-body > div.article-text > p:nth-of-type(2)', 'div.pkt-pagetitle'];x['716379968']=x['-295196960'];x['494026112']=['div.article-body > p:nth-of-type(1)', 'html > body > header', 'span[id=\'sub_nonmember\']', 'span[id=\'sub_nonmember\'] > a'];x['2141993504']=['div.article-body > p:nth-of-type(2)', 'div.pagecontent'];x['1742529280']=['div.article-body > p:nth-of-type(2)', 'div.right-rail > div:first-of-type', 'section.body > p:nth-of-type(2)'];x['273014304']=['div.article-body > p:nth-of-type(2)', 'div:nth-of-type(2) > div.most-popular', 'span[id=\'sub_nonmember\']'];x['718604576']=['div.article-body > p:nth-of-type(2)', 'div[id=\'paywall\']'];x['421376224']=['div.article-body > p:nth-of-type(2)', 'li.ht-saved', 'li.ht-saved > span > a', 'li[id=\'subscription\'] > button', 'li[id=\'subscription\'] > button.btn', 'section.body > p:nth-of-type(2)'];x['273014304']=['div.article-body > p:nth-of-type(2)'];x['-1899967616']=['div.article-body', 'div.article-body > div.perfectPixel', 'div.article-body > p:nth-of-type(2)', 'div.article-share > div.social-links > ul.right > li.print > a.hdn-analytics > span.icon', 'div.article-sidebar > div.most-popular', 'div.article-sidebar > div.most-popular > div.header > h2', 'div.article-title', 'div.article-title > h1', 'div.articleFooter', 'div.asset-media', 'div.hdnce-collection-62743-core_thumbnail_list > div.core-thumbnail-list', 'div.hdnce-collection-65948-core_package > div.core-package', 'div.hdnce-collection-76268-core_promo > div.core-promo', 'div.hdnce-collection-77057-core_promo > div.core-promo', 'div.hdnce-collection-77057-core_promo > div.core-promo > ul > li:nth-last-child(-n+2)', 'div.hdnce-collection-77057-core_promo > div.core-promo > ul > li:nth-of-type(3)', 'div.hdnce-collection-77057-core_promo > div.core-promo > ul > li:nth-of-type(4)', 'div.hdnce-collection-81325-core_thumbnail_list > div.core-thumbnail-list', 'div.most-popular', 'div.subHead', 'div:nth-of-type(2) > div.hst-freeform', 'div:nth-of-type(2) > div.six-3 > div.most-popular', 'div:nth-of-type(2) > div.six-3 > div.most-popular > div.header > h2', 'div:nth-of-type(6) > div.col', 'h1.headline', 'span#sub_nonmember'];x['-1660041888']=['div.article-body', 'div.article-body > div.perfectPixel', 'div.article-body > p:nth-of-type(2)', 'div.article-share > div.social-links > ul.right > li.print > a.hdn-analytics > span.icon', 'div.article-sidebar > div.most-popular', 'div.article-sidebar > div.most-popular > div.header > h2', 'div.article-title', 'div.article-title > h1', 'div.articleFooter', 'div.core-package', 'div.hdnce-collection-62743-core_thumbnail_list > div.core-thumbnail-list', 'div.hdnce-collection-63166-core_centerpiece > div.core-centerpiece > div.centerpiece-container', 'div.hdnce-collection-77057-core_promo > div.core-promo', 'div.hdnce-collection-80819-core_centerpiece > div.core-centerpiece', 'div.hdnce-collection-81325-core_thumbnail_list > div.core-thumbnail-list', 'div.hst-freeform > img', 'div.subHead', 'div.tbRegion > div.most-popular', 'div:nth-of-type(2) > div.six-3 > div.most-popular', 'div:nth-of-type(2) > div.six-3 > div.most-popular > div.header > h2', 'div[id=\'zoneAR\'] > div.hide-rss-link', 'footer > div.content-wrapper > div:nth-of-type(1)', 'h1.headline', 'html > body > header', 'li.homeLink > a.subMenuLink', 'li[id=\'subscription\'] > button', 'span#sub_nonmember'];x['810324736']=x['-1660041888'];x['1315604960']=x['-1660041888'];x['-199283136']=x['-1660041888'];x['-2032773248']=x['-1660041888'];x['-1697607648']=x['-1660041888'];x['1391123808']=['div.article-body', 'div.article-body > p:nth-of-type(2)', 'div.article-body > p:nth-of-type(7)', 'div.article-title', 'div.article-title > h1', 'div.articleFooter', 'div.hdnce-item-33813 > div#hst-mediumrectangle4', 'div.subHead', 'figure[id=\'image-19378493\']', 'figure[id=\'image-19378494\']', 'figure[id=\'image-19378494\'] > picture.image'];x['-2005023680']=['div.article-body', 'div.article-body > p:nth-of-type(2)', 'div.article-body > p:nth-of-type(7)', 'div.article-title', 'div.article-title > h1', 'div.hdnce-item-33813 > div#hst-mediumrectangle4', 'div.subHead', 'li.text > a'];x['-1055972128']=['div.article-body', 'div.article-text > div.perfectPixel', 'div.hdnce-collection-62743-core_thumbnail_list > div.core-thumbnail-list', 'div.hdnce-collection-81325-core_thumbnail_list > div.core-thumbnail-list', 'div.hdnce-item-70056', 'div.most-popular', 'span.subscribe'];x['454985280']=x['-1055972128'];x['2018223328']=['div.article-wrapper > p:nth-of-type(3)', 'div[id=\'intro-text\'] > p:nth-of-type(3)'];x['-606242112']=['div.articleFooter', 'main[id=\'content\'] > article', 'section.body > p:nth-of-type(3)', 'section[id=\'articleTop\']'];x['-1433243840']=['div.footer-top > div.pt-4', 'div.order-0'];x['1676686176']=x['-1433243840'];x['-417690208']=['div.hdnce-collection-53891-core_centerpiece > div.core-centerpiece > div.centerpiece-container > div.centerpiece-headlinelist > div.hide-rss-link > div.core-headline-list'];x['1361236224']=['div.hdnce-collection-64735-core_promo > div.core-promo', 'div.hdnce-collection-64735-core_promo > div.core-promo > div.header > a > h2', 'div.hdnce-collection-69743-core_package > div.core-package', 'div.most-popular', 'html > body > header', 'li[id=\'reg_member\'] > a:nth-of-type(1)', 'li[id=\'subscription\'] > button', 'span#reg_nonmember > a:nth-of-type(1)', 'span#sub_nonmember', 'span[id=\'sub_nonmember\'] > a'];x['-28674176']=['div.hdnce-collection-64735-core_promo > div.core-promo', 'div.hdnce-collection-64735-core_promo > div.core-promo > div.header > a > h2', 'div.most-popular', 'span.subscribe'];x['2085061600']=['div.hdnce-collection-64735-core_promo > div.core-promo', 'div.hdnce-collection-64735-core_promo > div.core-promo > div.header > a > h2'];x['1991396736']=['div.hdnce-collection-66894-core_headline_list > div.core-headline-list', 'div[id=\'siteheader\']', 'span.subscribe'];x['1936911584']=x['1991396736'];x['-1498552576']=['div.hdnce-collection-66895-core_headline_list > div.core-headline-list', 'div[id=\'siteheader\']', 'span.subscribe'];x['-2014824608']=x['-1498552576'];x['-822684544']=['div.hdnce-collection-66896-core_headline_list > div.core-headline-list', 'div[id=\'siteheader\']', 'span.subscribe'];x['1665464096']=x['-822684544'];x['-580203552']=['div.hdnce-collection-77057-core_promo > div.core-promo'];x['-1624553216']=['div.hst-freeform > div', 'li.ht-saved'];x['-1519990816']=['div.most-popular', 'div:nth-of-type(2) > div.six-3 > div.most-popular'];x['-1257378528']=['div.most-popular'];x['73367008']=x['-1257378528'];x['1014326912']=['div.sync-inline-overlay > p:nth-of-type(2)'];x['-1197854400']=['div[id=\'BC-ctpremium-hp-nl-signup\']'];x['1990879392']=x['-1197854400'];x['1198668416']=['div[id=\'paywall\'] > p:nth-of-type(3)'];x['1781642144']=['head'];x['-2115966240']=['html > body > header', 'li[id=\'subscription\'] > button'];x['483203904']=x['-2115966240'];x['1394866592']=x['-2115966240'];x['-2048974144']=['html > body > header', 'span[id=\'sub_nonmember\']'];x['-274007488']=x['-2048974144'];x['-122285632']=x['-2048974144'];x['999920704']=x['-2048974144'];x['-1646369824']=x['-2048974144'];x['-2003301568']=['html > body > header'];x['-940021056']=x['-2003301568'];x['-44432288']=x['-2003301568'];x['-1083124256']=x['-2003301568'];x['2126893504']=x['-2003301568'];x['-178054336']=x['-2003301568'];x['590400768']=['li.treg-is-gigya'];x['255461632']=['li[id=\'subscription\'] > button.btn', 'span[id=\'sub_nonmember\'] > a'];x['2145729344']=['section.body > p:nth-of-type(2)'];x['-2077504608']=x['2145729344'];x['-1400872160']=['span.subscribe > a'];x['-446485856']=x['-1400872160'];x['850531104']=x['-1400872160'];x['502828640']=x['-1400872160'];x['918905856']=x['-1400872160'];x['-754338944']=x['-1400872160'];x['1794228864']=x['-1400872160'];x['2116395008']=['span.subscribe'];x['993794848']=x['2116395008'];x['1493374368']=x['2116395008'];x['-634433344']=['span[id=\'sub_nonmember\']'];}catch(err){}return x;};(function(p){window.blueConicPreListeners=[];(function(){var p=!1,ta=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.BCClass=function(){};BCClass.extend=function(O){function U(){!p&&this.init&&this.init.apply(this,arguments)}var Q=this.prototype;p=!0;var oa=new this;p=!1;for(var R in O)oa[R]="function"==typeof O[R]&&"function"==typeof Q[R]&&ta.test(O[R])?function(p,E){return function(){var R=this._super;this._super=Q[p];var V=E.apply(this,arguments);this._super=R;return V}}(R,O[R]):O[R];U.prototype=
oa;U.constructor=U;U.extend=arguments.callee;return U}})();var InteractionType=BCClass.extend({init:function(){},getPreloadProperties:function(){return [];},getContent:function(){},onEvent:function() {},importLibraries:function(urls) {blueConic.fn.importLibraries.call(this, urls);}});(function(){// ==ClosureCompiler==
// @output_file_name default.js
// @compilation_level SIMPLE_OPTIMIZATIONS
// ==/ClosureCompiler==

var InteractionTypeImpl = InteractionType.extend({

    init: function(blueConicClient, context) {
        this.blueConicClient = blueConicClient;
        this.context = context ? context : null;
        this.profile = blueConicClient.profile.getProfile();
        this.pollCounter = 0;
        //Refresh properties
        this.realmRefreshHappened = false;
        this.entitlementSet = false;
        this.isPremiumSite = true;

    },

    // Zendesk #5397: Using onPrepare() instead of onLoad() to make sure that the
    // segments based on the profile properties set here can be used on the first
    // page view. This assumes that the script "treg.hearstnp.com/treg.js" will be
    // run BEFORE the BlueConic script.
    onPrepare: function() {
        // Built to specs of Zendesk #5149
        var regexp;
        var hostname = window.location.hostname;
        var referrer = document.referrer;

        window.detection = window.detection || {};
        window.detection.hc_ent_detection_complete = false;
        //Reset entitlement sources
        this.blueConicClient.profile.getProfile().setValue("entitlement_sources", undefined);
        //metered no paywall
        this.blueConicClient.profile.getProfile().setValue("paywall_policy", window.HDN.dataLayer.paywall.policy);
        //set the most recent realm id
        if(window.localStorage.getItem('bc.realm.id')){
            this.blueConicClient.profile.getProfile().setValue("realm_identifier_most_recent_", window.localStorage.getItem('bc.realm.id'));
        }
        //get the pubdate
        var pubdate;
        try{
            pubdate = Date.parse(window.HDN.dataLayer.content.pubDate);
        }catch(e){
            console.log('Unexpected pubDate');
            pubdate = ""
        }
        this.blueConicClient.profile.getProfile().setValue("article_publication_date", pubdate);
        //clear the welcome shown field
        window.blueConicClient.profile.getProfile().setValue('welcome_unit_shown_single_page_', 'false'); 
        //
        // UX Segements
        //
        //set current date in local storage for the CT Interstitial 
        if(localStorage.getItem('cti_interstial_seen_date')){
            //check the date
            var storedDate = localStorage.getItem('cti_interstial_seen_date');
            var dateDifference = (Date.now() - storedDate)/ (1000 * 60);  
            if(dateDifference > 24){
                this.blueConicClient.profile.getProfile().setValue("cti_welcome_seen", 'false');
            }
            else{
                this.blueConicClient.profile.getProfile().setValue("cti_welcome_seen", 'true');
            }
        }
        else{
            this.blueConicClient.profile.getProfile().setValue("cti_welcome_seen", 'false');
        }

        //hide header unless toaster was shown 
        if(localStorage.getItem('toaster_shown_date')){
            //check the date
            var storedDate = localStorage.getItem('toaster_shown_date');
            var dateDifference = (Date.now() - storedDate)/ (1000 * 60 ); //hours  
            if(dateDifference > 24){
                this.blueConicClient.profile.getProfile().setValue("welcome_toaster_seen", 'false');
            }
            else{
                this.blueConicClient.profile.getProfile().setValue("welcome_toaster_seen", 'true');
            }
        }
        else{
            this.blueConicClient.profile.getProfile().setValue("welcome_toaster_seen", 'false');
        }
        //hide header unless toaster was shown 
        if(localStorage.getItem('tos_banner_shown_date')){
            //check the date
            var storedDate = localStorage.getItem('tos_banner_shown_date');
            var dateDifference = (Date.now() - storedDate)/ (1000 * 60 ); //hours  
            if(dateDifference > 24){
                this.blueConicClient.profile.getProfile().setValue("tos_banner_seen", 'false');
            }
            else{
                this.blueConicClient.profile.getProfile().setValue("tos_banner_seen", 'true');
            }
        }
        else{
            this.blueConicClient.profile.getProfile().setValue("tos_banner_seen", 'false');
        }
        //
        // UX Segments
        //
        //STARBUCKS ENTITLEMENTS
        if(window.detection && window.detection.hc_ent_detection_complete) {
            this.blueConicClient.createEvent("hc_ent_detection_complete");
            console.log('onLoad: AFTER - Calling the event - HC ENT DETECTION COMPLETE');
          }
            console.log("refferer: " + referrer);
            
            if (referrer && (referrer.toLowerCase().indexOf("https://web.archive.org/web/20211007044655/https://www.houstonchronicle.com/starbucks") > -1 || referrer.toLowerCase().indexOf("https://web.archive.org/web/20211007044655/https://www.sfchronicle.com/starbucks") > -1 || referrer.toLocaleLowerCase().indexOf("https://web.archive.org/web/20211007044655/https://wifi.starbucks.com/") > -1)) {
                
            this.blueConicClient.profile.getProfile().setValue("starbucks_referrer", "true");
                console.log('From starbucks netowork');
                //set the entitlements
                var me = this;
                if (!window.HDN) {
                    window.HDN = {};
                }
                window.HDN.dataLayer = window.HDN.dataLayer || {};
                window.HDN.dataLayer.paywall = window.HDN.dataLayer.paywall || {};
                window.HDN.dataLayer.paywall.accessRule = "starbucksFreeOffer";
                var sfcRegexp = new RegExp("\\.sfchronicle\\.com$", "i");
                var houRegexp = new RegExp("\\.houstonchronicle\\.com$", "i");
                if(sfcRegexp.test(hostname)) {
                    me._setStarbucksCookie("hrstctok", "", 4, "sfchronicle.com");
                    me.blueConicClient.profile.getProfile().setValue("sfc_entitlement_status", "true");
                    me.blueConicClient.profile.getProfile().setValue("sfc_starbucks_entitlement_status", "true");
                    console.log("SFC Starbucks entitlements set!");
                    me.blueConicClient.profile.getProfile().addValue("entitlement_sources", "starbucks");
                } else if (houRegexp.test(hostname)) {
                    me._setStarbucksCookie("hrstctok", "", 4, "houstonchronicle.com");
                    me.blueConicClient.profile.getProfile().setValue("hou_entitlement_status", "true");
                    me.blueConicClient.profile.getProfile().setValue("hou_tsn_entitlement_status", "true");
                    me.blueConicClient.profile.getProfile().setValue("hou_starbucks_entitlement_status", "true");
                    me.blueConicClient.profile.getProfile().addValue("entitlement_sources", "starbucks");
                    console.log("HOU Starbucks entitlements set!");                
                }
                me.blueConicClient.profile.updateProfile();
                if(document.URL.toLowerCase().indexOf("https://web.archive.org/web/20211007044655/https://www.houstonchronicle.com/starbucks") > -1 || document.URL.toLowerCase().indexOf("https://web.archive.org/web/20211007044655/https://www.sfchronicle.com/starbucks") > -1) {
                    //redirect to the home 
                    console.log('starbucks redirect');
                    window.location.href = window.location.hostname;
                }
             } else {
                 this.blueConicClient.profile.getProfile().setValue("starbucks_referrer", "false");
                 //let the vendor  cookie time out
            }
        //END STARBUCKS ENTITLEMENTS
        // Domain houstonchronicle.com
        // regexp = new RegExp("cmf\\.qa\\d\\.houstonchronicle\\.com$", "i");
        // if (regexp.test(hostname) && document.URL.indexOf('cmf.qa1') < -1) {
        //     // ZD #8486
        //     // console.log("before calling set cookies: EVENT");
        //     // this.contentServiceURL = "https://web.archive.org/web/20211007044655/https://casper-services-dev2-dot-eco-cyclist-168716.ue.r.appspot.com/userManager/getEntitlementStatusForBC"; //new
        //     // this.marketValue="HC";
        //     // this._setStatusBasedOnTreg("hou_logged_in_status", "houstonchronicle.com", this._processHOULoggedInStatus);
        //     // this._setStatusAndEntitlementBasedOnTreg("HC","hou_logged_in_status");
        //     //let the plugin handle it 
        // } else {
        //     regexp = new RegExp("\\.houstonchronicle\\.com$", "i");
        //     if (regexp.test(hostname) && document.URL.indexOf('subscription.') < 0 && document.URL.indexOf('cmf.qa1') < 0) {
        //             // console.log("before calling set cookies Prod: EVENT");
        //             // this.contentServiceURL = "https://web.archive.org/web/20211007044655/https://casper-services-prod-dot-eco-cyclist-168716.appspot.com/getEdbpToken";
        //             // this.marketValue="HOU";
        //             // this._setStatusBasedOnTreg("hou_logged_in_status", "houstonchronicle.com", this._processHOULoggedInStatus);
        //         this._setStatusAndEntitlementBasedOnTreg("HC","hou_logged_in_status");
        //     }
        // }
        // // Domain chron.com
        // regexp = new RegExp("\\.chron\\.com$", "i");

        // if (regexp.test(hostname)) {
        //     this.isPremiumSite = false;
        //     // this._setStatusBasedOnTreg("hou_logged_in_status", "chron.com");
        //     this._setStatusAndEntitlementBasedOnTreg("HC","hou_logged_in_status");
        // }
            
        // regexp = new RegExp("\\.sfchronicle\\.com$", "i");
        // if (regexp.test(hostname) && document.URL.indexOf('subscription.') < 0 && document.URL.indexOf("cmf.qa1") < 0) {
        //         this._setStatusAndEntitlementBasedOnTreg("SFC","sfc_logged_in_status");
        // }

        // regexp = new RegExp("\\.sfgate\\.com$", "i");
        // if (regexp.test(hostname)) {
        //     this.isPremiumSite = false;
        //     //this._setStatusBasedOnTreg("sfc_logged_in_status", "sfgate.com", this._processSFLoggedInStatus);
        //     this._setStatusAndEntitlementBasedOnTreg("SFC","sfc_logged_in_status");
        // }

        //ctinsider
        // regexp = new RegExp("\\.ctinsider\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "ctinsider.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }

        // //ct freesites
        // regexp = new RegExp("\\.ctpost\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     if(document.URL.indexOf('/projects/') < 0){
        //         // this.isPremiumSite = false;
        //     }
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "ctpost.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }
        
        // regexp = new RegExp("\\.stamfordadvocate\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     if(document.URL.indexOf('/projects/') < 0){
        //         // this.isPremiumSite = false;
        //     }
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "stamfordadvocate.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }
        
        // regexp = new RegExp("\\.greenwichtime\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     if(document.URL.indexOf('/projects/') < 0){
        //         // this.isPremiumSite = false;
        //     }
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "greenwichtime.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }
        
        // regexp = new RegExp("\\.nhregister\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     if(document.URL.indexOf('/projects/') < 0){
        //         // this.isPremiumSite = false;
        //     }
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "nhregister.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }
        
        // regexp = new RegExp("\\.thehour\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     if(document.URL.indexOf('/projects/') < 0){
        //         // this.isPremiumSite = false;
        //     }
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "thehour.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }
        
        // regexp = new RegExp("\\.newstimes\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     if(document.URL.indexOf('/projects/') < 0){
        //         // this.isPremiumSite = false;
        //     }
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "newstimes.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }
        // // 1CT additional Publications
        // regexp = new RegExp("\\.middletownpress\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     if(document.URL.indexOf('/projects/') < 0){
        //         // this.isPremiumSite = false;
        //     }
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "newstimes.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }

        // regexp = new RegExp("\\.registercitizen\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     if(document.URL.indexOf('/projects/') < 0){
        //         // this.isPremiumSite = false;
        //     }
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "newstimes.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }

        // regexp = new RegExp("\\.darientimes\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     if(document.URL.indexOf('/projects/') < 0){
        //         // this.isPremiumSite = false;
        //     }
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "newstimes.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }
        // regexp = new RegExp("\\.milfordmirror\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     if(document.URL.indexOf('/projects/') < 0){
        //         // this.isPremiumSite = false;
        //     }
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "newstimes.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }
        // regexp = new RegExp("\\.ncadvertiser\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     if(document.URL.indexOf('/projects/') < 0){
        //         // this.isPremiumSite = false;
        //     }
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "newstimes.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }
        // regexp = new RegExp("\\.theridgefieldpress\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     if(document.URL.indexOf('/projects/') < 0){
        //         // this.isPremiumSite = false;
        //     }
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "newstimes.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }
        // regexp = new RegExp("\\.trumbulltimes\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     if(document.URL.indexOf('/projects/') < 0){
        //         // this.isPremiumSite = false;
        //     }
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "newstimes.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }
        // regexp = new RegExp("\\.sheltonherald\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     if(document.URL.indexOf('/projects/') < 0){
        //         // this.isPremiumSite = false;
        //     }
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "newstimes.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }
        // regexp = new RegExp("\\.wiltonbulletin\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     if(document.URL.indexOf('/projects/') < 0){
        //         // this.isPremiumSite = false;
        //     }
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "newstimes.com", this._processCTILoggedInStatus);
        //     if(document.URL.indexOf('cmf.qa') === -1)this._setStatusAndEntitlementBasedOnTreg("CTI","cti_logged_in_status");
        // }




        // regexp = new RegExp("\\.mrt\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "newstimes.com", this._processCTILoggedInStatus);
        //     this._setStatusAndEntitlementBasedOnTreg("MP_MRT","mrt_logged_in_status");
        // }
        
        // regexp = new RegExp("\\.beaumontenterprise\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "newstimes.com", this._processCTILoggedInStatus);
        //     this._setStatusAndEntitlementBasedOnTreg("BE_BMT","bmt_logged_in_status");
        // }
        
        // regexp = new RegExp("\\.lmtonline\\.com$", "i");//change to cmf
        // if (regexp.test(hostname)) {
        //     // this._setStatusBasedOnTregCT("cti_logged_in_status", "newstimes.com", this._processCTILoggedInStatus);
        //     this._setStatusAndEntitlementBasedOnTreg("SA_LMT","lmt_logged_in_status");
        // }

        // Domain timesunion.com
        // regexp = new RegExp("\\.timesunion\\.com$", "i");
        // if (regexp.test(hostname) && !(document.URL.indexOf("subscription.") > -1) && document.URL.indexOf("cmf.qa1") < 0) {
        //     this._setStatusAndEntitlementBasedOnTreg("TU","alby_logged_in_status");
        //     // // https://blueconic.zendesk.com/agent/tickets/9140
        //     // this.timesunionContentServiceUrl = "https://web.archive.org/web/20211007044655/https://edbp.timesunion.com/contentservice.svc/gettokensbyid";
        //     // this._setStatusBasedOnTregTU("alby_logged_in_status", "timesunion.com", this._processTULoggedInStatus)
        //     // // this._setTUStatus();
        //     // this.edbId = this._getEdbId();
        //     // // set EDB e-mail address according to https://blueconic.zendesk.com/agent/tickets/7817
        //     // this._setEdbEmailAddress();
        // } 
        
         // Domain expressnews.com
        // regexp = new RegExp("\\.expressnews\\.com$", "i");
        // if (regexp.test(hostname) && document.URL.indexOf('subscription.') < 0 && document.URL.indexOf("cmf.qa1") < 0) {
        //     this._setStatusAndEntitlementBasedOnTreg("SAEN","saen_logged_in_status");
        //     // console.log("before calling set cookies: EVENT");
        //     // this.contentServiceURL = "https://web.archive.org/web/20211007044655/https://casper-services-qa-dot-eco-cyclist-168716.appspot.com/getEdbpToken";
        //     // this.marketValue="SAEN";
        //     // this._setStatusBasedOnTreg("saen_logged_in_status", "expressnews.com", this._processSAENLoggedInStatus);
        //     // this.profile.setValue("saen_hnpabt2_cookie", this.blueConicClient.util.cookie.getCookie("hnpabt2"));
        //     //Incase that fails...
        //     // this._setCookiesFromCMF("https://"+hostname+"/validateAndSetHrstctok.php", this._setENEntitlementStatus);
        //         // https://blueconic.zendesk.com/agent/tickets/7879
        //         if (referrer && referrer.toLowerCase().indexOf("mysanantonio.com") > -1) {
        //             this.profile.setValue("saen_meter_audience", "MySA");
        //         } else if (referrer && referrer.toLowerCase().indexOf("google.com") > -1) {
        //             this.profile.setValue("saen_meter_audience", "google");
        //         } else if (referrer && referrer.toLowerCase().indexOf("facebook.com") > -1) {
        //             this.profile.setValue("saen_meter_audience", "facebook");
        //         } else if (referrer && referrer.toLowerCase().indexOf("pinterest.com") > -1) {
        //             this.profile.setValue("saen_meter_audience", "pinterest");
        //         } else if (referrer && referrer.toLowerCase().indexOf("t.co") > -1) {
        //             this.profile.setValue("saen_meter_audience", "twitter");
        //         } else if (referrer && referrer.toLowerCase().indexOf("reddit.com") > -1) {
        //             this.profile.setValue("saen_meter_audience", "reddit");
        //         }

        // }

        // Domain mysanantonio.com
        // regexp = new RegExp("\\.mysanantonio\\.com$", "i");

        // if (regexp.test(hostname)) {
        //     this.isPremiumSite = false;
        //      this._setStatusAndEntitlementBasedOnTreg("SAEN","saen_logged_in_status");
        //     //this._setStatusBasedOnTreg("saen_logged_in_status", "mysanantonio.com", this._processSAENLoggedInStatus);

        //     // set EDB e-mail address according to https://blueconic.zendesk.com/agent/tickets/7817
        //     this._setEdbEmailAddress();
        // }

        if (window.HDN && window.HDN.dataLayer && window.HDN.dataLayer.paywall && window.HDN.dataLayer.paywall.premiumStatus) {
            this.profile.setValue("current_article_premium_status", window.HDN.dataLayer.paywall.premiumStatus);
        } else {
            this.profile.setValue("current_article_premium_status", "");
        }
    },


    /**
     * On load function
     * Triggered when BlueConic is ready to create events for dialogues to show.
     */
    onLoad: function() {
      var referrer = document.referrer;
      var hostname = window.location.hostname;

        
        if(this.blueConicClient.profile.getProfile().getValue('hou_starbucks_entitlement_status') === "true") {
            this.blueConicClient.profile.getProfile().setValue("hou_entitlement_status", "true");
            this.blueConicClient.profile.getProfile().setValue("hou_tsn_entitlement_status", "true");
        }
        
        this.blueConicClient.profile.updateProfile(this, function() {});
    },
    /**
     * Set a profile property based on the provided cookie domain and the window.treg object
     *
     * @param propertyName {String} The name of the profile property to set
     * @param cookieDomain {String} The name of the cookie domain to verify
     * @param callbackFn {Function} Callback function to call when the status is set
     */
    _setStatusBasedOnTreg: function(propertyName, cookieDomain, callbackFn) {

        var me = this;
        window.treg = window.treg || {};
        window.treg.cmd = window.treg.cmd || [];

        console.log("setting treg status...")
        treg.cmd.push(function(){
            var treg = window.treg;
            
            treg.realm.events.register("treg.onSessionFound", function() {
                console.log('treg session found... ');
                me._setPropertyValueAndDoCallback(propertyName, true, callbackFn, cookieDomain);
            });

            treg.realm.events.registerReplayLast("realm.Oidc.refreshLogicComplete", function () {
                console.log('realm refresh start -BC');
                me.realmRefreshHappened = true;
                if(me.realmRefreshHappened && me.entitlementSet) {
                    me._triggerEntitlementEvent(cookieDomain);
                }
                console.log('realm refresh complete, event created - BC');
            });

            treg.realm.events.register("treg.onSessionNotFound", function() {
                console.log('treg session not found... ');
                me._setPropertyValueAndDoCallback(propertyName, false, callbackFn, cookieDomain);
            });

            treg.realm.events.register("treg.onSessionEnd", function() {
                console.log('treg session not ending... ');
                me._setPropertyValueAndDoCallback(propertyName, false, callbackFn, cookieDomain);
            });
        });
        
    },
    /**
     * Set a profile property based on the provided cookie domain and the window.treg object
     *
     * @param propertyName {String} The name of the profile property to set
     * @param cookieDomain {String} The name of the cookie domain to verify
     * @param callbackFn {Function} Callback function to call when the status is set
     */
    _setStatusBasedOnTregCT: function(propertyName, cookieDomain, callbackFn) {
        var me = this;

        // hasActiveSession() will return "false" if called too early, depend on events instead.
        window.treg = window.treg || {};
        window.treg.cmd = window.treg.cmd || [];

        console.log('Setting Status CT...');
        console.log(window.treg);
        treg.cmd.push(function (){
            var treg = window.treg;
            treg.realm.events.register("treg.onSessionFound", function() {
                console.log('treg session found!')
                me._setPropertyValueAndDoCallback(propertyName, true, callbackFn, cookieDomain);
            });
            
            treg.realm.events.registerReplayLast("realm.Oidc.refreshLogicComplete", function () {
                console.log('realm refresh start -BC');
                me.realmRefreshHappened = true;
                if(me.realmRefreshHappened && me.entitlementSet) {
                    me._triggerEntitlementEvent(cookieDomain);
                }
                console.log('realm refresh complete, event created - BC');
            });

            treg.realm.events.registerReplayLast("treg.onSessionNotFound", function() {
                me._setPropertyValueAndDoCallback(propertyName, false, callbackFn, cookieDomain);
                if(localStorage.getItem('bc_cti_refresh')){
                    console.log('bc_cti_refresh found, deleting and reloading...')
                    window.location.reload();
                    localStorage.removeItem('bc_cti_refresh'); 
                }
            });

            treg.realm.events.registerReplayLast("treg.onSessionEnd", function() {
                me._setPropertyValueAndDoCallback(propertyName, false, callbackFn, cookieDomain);
                console.log('CTI Logging out...');
                if(localStorage.getItem('bc_cti_refresh')){
                    window.location.reload();
                    localStorage.removeItem('bc_cti_refresh'); 
                }
            });
            console.log('treg functions pushed');
        });
    },

    /**
     * Set a profile property based on the provided cookie domain and the window.treg object
     *
     * @param propertyName {String} The name of the profile property to set
     * @param cookieDomain {String} The name of the cookie domain to verify
     * @param callbackFn {Function} Callback function to call when the status is set
     */
    _setStatusBasedOnTregTU: function(propertyName, cookieDomain, callbackFn) {
        var me = this;

        // hasActiveSession() will return "false" if called too early, depend on events instead.
        window.treg = window.treg || {};
        window.treg.cmd = window.treg.cmd || [];

        console.log('Setting Status TU...');
        console.log(window.treg);
        treg.cmd.push(function (){
            var treg = window.treg;
            treg.realm.events.register("treg.onSessionFound", function() {
                if(document.URL.indexOf('cmf.qa') >= 0 ){
                    me._setPropertyValueAndDoCallback(propertyName, true, callbackFn, cookieDomain)
                }
                else{
                    me.profile.setValue("alby_logged_in_status", "true");
                    if (me.blueConicClient.util.cookie.getCookie("hrstctok")) {
                        // if we have a hrstctok cookie, call setTUEntitlement status immediately no need to call api
                        me._setTUEntitlementStatus("true");
                        me.entitlementSet = true;
                        me.profile.setValue("alby_logged_in_status", "true");
                        me.profile.setValue('edb_email', me._getEdbEmailAddress());
                        me.profile.setValue('edb_id', me._getEdbId());
                        if(me.realmRefreshHappened && me.entitlementSet) {
                            console.log('entitlment set: ', me.entitlementSet);
                            me.blueConicClient.createEvent("tu_entitlement_status_set");       
                            console.log('Entitlement event fired...');             
                        }
                    } else {
                        //set the hrstptok cookie if the ID is valid
                        var edbid = window.treg.identity.entitlementId;
                        var edbURL;
                        if(document.URL.indexOf("cmf.qa") > 0){
                            edbURL = "https://web.archive.org/web/20211007044655/https://casper-services-dev2-dot-eco-cyclist-168716.appspot.com/getEdbpToken";
                        }
                        else edbURL = "https://web.archive.org/web/20211007044655/https://casper-services-prod-dot-eco-cyclist-168716.appspot.com/getEdbpToken";
                        var entitlementStatus = "false";
                        window.$.ajax({
                            type: "POST",
                            url: edbURL,
                            dataType: "json",
                            contentType: "application/json",
                            crossDomain: true,
                            data: JSON.stringify({
                                edbId: window.treg.identity.entitlementId,
                                edbpMarket: 'ALBY',
                                sourceSystem: 'SITE'
                            }),
                            success: function(res) {
                                // The parsing has changed between ticket #9140 and #10071
                                if (res && res.meta && res.meta.code === 200 && res.data && res.data.Success == "true"){
                                    try {
                                        var hrstptok = res.data.ProductToken;
                                        res = JSON.parse(res.data.ContentToken);
                                        var hrstctok = res.contentToken.cookies ? res.contentToken.cookies.hrstctok : undefined;
                                        me._setCookie("hrstctok", hrstctok, 1, "timesunion.com");
                                        me._setCookie("hrstptok", hrstptok, 1, "timesunion.com");
                                        //set edb email and id
                                        me.profile.setValue('edb_email', me._getEdbEmailAddress());
                                        me.profile.setValue('edb_id', me._getEdbId());
                                    } catch (e) {
                                        // failed parsing, skipping
                                    }
                
                                    if (me.blueConicClient.util.cookie.getCookie("hrstctok")) {
                                        // 'hrstctok' cookie is now set, (re)set entitlement status
                                        entitlementStatus = "true";
                                    }
                                    me._setTUEntitlementStatus(entitlementStatus);
                                }
                            },
                            error: function(error) {
                                me._setTUEntitlementStatus("false");
                            }
                
                        });
                        //Set the logged in status
                        me._setTUStatus();
                        //refresh the page
                        if(!localStorage.getItem('bc_tu_refresh')){
                            localStorage.setItem('bc_tu_refresh','true');
                            window.location.reload();
                        }
                    }
                    this.blueConicClient.profile.updateProfile();
                }
            });
            treg.realm.events.registerReplayLast("realm.Oidc.refreshLogicComplete", function () {
                console.log('realm refresh start -BC');
                me.realmRefreshHappened = true;

                if(me.realmRefreshHappened && me.entitlementSet) {
                    me._triggerEntitlementEvent('timesunion.com');
                }
                console.log('realm refresh complete, event created - BC');
            });

            treg.realm.events.registerReplayLast("treg.onSessionNotFound", function() {
                let hrstctok = me.blueConicClient.util.cookie.getCookie("hrstctok");
                let hrstptok = me.blueConicClient.util.cookie.getCookie("hrstptok");
                me._setCookie("hrstctok", hrstctok, -1, "timesunion.com");
                me._setCookie("hrstptok", hrstptok, -1, "timesunion.com");
                me._setTUStatus();

            });

            treg.realm.events.registerReplayLast("treg.onSessionEnd", function() {
                //Invalidate the cookies
                let hrstctok = me.blueConicClient.util.cookie.getCookie("hrstctok");
                let hrstptok = me.blueConicClient.util.cookie.getCookie("hrstptok");
                me._setCookie("hrstctok", hrstctok, -1, "timesunion.com");
                me._setCookie("hrstptok", hrstptok, -1, "timesunion.com");
                me._setTUStatus();
                if(localStorage.getItem('bc_tu_refresh')){
                    window.location.reload();
                    localStorage.removeItem('bc_tu_refresh'); 
                }
            });
        });
    },

    _setPropertyValueAndDoCallback: function(propertyName, value, callbackFn, cookieDomain) {
        this.profile.setValue(propertyName, value);
        if(this.blueConicClient.profile.getProfile().getValue('hou_starbucks_entitlement_status') === "true") {
            console.log('inside starbucks entitlement status');
            this.blueConicClient.profile.getProfile().setValue("hou_entitlement_status", "true");
            this.blueConicClient.profile.getProfile().setValue("hou_tsn_entitlement_status", "true");
        }
        console.log(this.blueConicClient.profile.getProfile().getValue("hou_entitlement_status"));
        if (callbackFn && typeof callbackFn === "function") {
            // callback will trigger the profile update
            callbackFn.call(this, cookieDomain);
        }
		
        // Update Profile
        this.blueConicClient.profile.updateProfile();
    },

    // See https://blueconic.zendesk.com/agent/tickets/9140
    _setTUStatus: function() {
        var hrstptokCookie = this._readCookie("hrstptok");


        var hrstctokCookie = this.blueConicClient.util.cookie.getCookie("hrstctok");

        if (hrstctokCookie) {
            // if we have a hrstctok cookie, call setTUEntitlement status immediately
            this._setTUEntitlementStatus("true");
            this.entitlementSet = true;
            this.blueConicClient.profile.getProfile().addValue("entitlement_sources", "paid");
            if(this.realmRefreshHappened && this.entitlementSet) {
                console.log('entitlment set: ', this.entitlementSet);
                this.blueConicClient.createEvent("tu_entitlement_status_set");       
                console.log('Entitlement event fired...');             
            }
        } else if (hrstptokCookie && window.$) {
            // if we don't have a hrstctok cookie, but do have hrstptokCookie and jQuery, call the contentservice
            // call the content service
            // this._checkContentServiceForCookies(hrstptokCookie);
        } else {
            // if we don't have a hrstctok and also no hrstptok, set entitlementstatus to false;
            this._setTUEntitlementStatus("false");
            this.entitlementSet = true;
            if(this.entitlementSet) {
                console.log('entitlment set: ', this.entitlementSet);
                this.blueConicClient.createEvent("tu_entitlement_status_set");       
                console.log('Entitlement event fired...');             
            }
        }
    },

    _setTUEntitlementStatus: function(status) {
        this.profile.setValue("alby_entitlement_status", status);
        this.blueConicClient.profile.updateProfile(this, function() {
            // publish event to that will trigger content metering
            // this will allow the content meter to wait for the entitlement status to get set
            // before evaluating the profile
            window.setTimeout(function() {
                this.blueConicClient.createEvent("cm_start_metering");
            }, 2000);
        });
    },

    // See https://blueconic.zendesk.com/agent/tickets/9140 and https://blueconic.zendesk.com/agent/tickets/10071
    _checkContentServiceForCookies: function(hrstptokCookie) {
        var me = this;
        var entitlementStatus = "false";
        window.$.ajax({
            url: this.timesunionContentServiceUrl, // https://edbp.timesunion.com/contentservice.svc/gettokensbyid
            type: "post",
            contentType: "application/json",
            dataType: "json",
            data: JSON.stringify({
                "EdbProductToken": hrstptokCookie,
                "SourceSystem": "SITE"
            }),
            success: function(res) {
                // The parsing has changed between ticket #9140 and #10071
                if (res && res.Success && res.ContentToken) {
                    try {
                        res = JSON.parse(res.ContentToken);
                        var hrstctok = res.contentToken.cookies ? res.contentToken.cookies.hrstctok : undefined;
                        me._setCookie("hrstctok", hrstctok, 1, "timesunion.com");
                    } catch (e) {
                        // failed parsing, skipping
                    }

                    if (me.blueConicClient.util.cookie.getCookie("hrstctok")) {
                        // 'hrstctok' cookie is now set, (re)set entitlement status
                        entitlementStatus = "true";
                    }
                    me._setTUEntitlementStatus(entitlementStatus);
                }
            },
            error: function() {
                me._setTUEntitlementStatus(entitlementStatus);
            }

        });
    },

    // See https://blueconic.zendesk.com/agent/tickets/7817
    _setEdbEmailAddress: function() {
        var email = this._getEdbEmailAddress();
        if (email) {
            this.profile.setValue("edb_email", email);
        }
    },
    // See https://blueconic.zendesk.com/agent/tickets/8348
    _processTULoggedInStatus: function(cookieDomain) {
        var hrstctokCookie = this.blueConicClient.util.cookie.getCookie("hrstctok");
        var tuLoggedInStatus = this.profile.getValue("alby_logged_in_status");
        if ((tuLoggedInStatus && tuLoggedInStatus === true)) {
            this._setTregEmailAdress();
            if (window.treg && window.treg.identity && window.treg.identity.edbId && !hrstctokCookie && window.treg.identity.id && window.$) {
                // 'hrstctok' cookie not present, check identity service
                //This conditional can be taken out and soley use the _checkISCookiesForTUCookies method later.
                if(document.URL.indexOf('cmf.qa') >= 0){
                    this._checkIdentityServiceForCookiesTU();
                }
                else{

                    this._checkIdentityServiceForCookiesTU();

                }
            } else if (hrstctokCookie) {
                // 'hrstctok' cookie already present, set entitlement status
                this._setTUEntitlementStatus("true");
                this.entitlementSet = true;
                if(this.realmRefreshHappened && this.entitlementSet) {
                    this.blueConicClient.createEvent("alby_entitlement_status_set");                   
                }
            } else {
                this._setTUEntitlementStatus("false");
                this.entitlementSet = true;
                if(this.realmRefreshHappened && this.entitlementSet) {
                    this.blueConicClient.createEvent("alby_entitlement_status_set");                   
                }
            }
        } else {
            // not logged in, invalidate 'hrstctok' cookie
            if (hrstctokCookie) {
                // invalidate 'hrstctok' cookie
                this._setCookie("hrstctok", "", -1, cookieDomain);
                this._setCookie("hrstptok", "", -1, cookieDomain);
            }
            this.blueConicClient.profile.updateProfile();
            // reset entitlement status
            this._setTUEntitlementStatus("false");
            this.entitlementSet = true;
            if(this.realmRefreshHappened && this.entitlementSet) {
                this.blueConicClient.createEvent("alby_entitlement_status_set");                      
            }
        }
    },        
    // See https://blueconic.zendesk.com/agent/tickets/8348
    _processHOULoggedInStatus: function(cookieDomain) {
        var hrstctokCookie = this.blueConicClient.util.cookie.getCookie("hrstctok");
        var houLoggedInStatus = this.profile.getValue("hou_logged_in_status");
        var houStarbucksEntitlementStatus = this.profile.getValue("hou_starbucks_entitlement_status");
        if ((houLoggedInStatus && houLoggedInStatus === true)) {
            this._setTregEmailAdress();
            if (window.treg && window.treg.identity && window.treg.identity.edbId && !hrstctokCookie && window.treg.identity.id && window.$) {
                // 'hrstctok' cookie not present, check identity service
                //This conditional can be taken out and soley use the _checkISCookiesForHOUCookies method later.
                if(document.URL.indexOf('cmf.qa') >= 0){
                    this._checkISCookiesForHOUCookies(cookieDomain, this._setHCEntitlementStatus);
                }
                else{

                    this._checkISCookiesForHOUCookies(cookieDomain, this._setHCEntitlementStatus);

                }
            } else if (hrstctokCookie || this.blueConicClient.util.cookie.getCookie("hrstvdtok")) {
                // 'hrstctok' cookie already present, set entitlement status
                this._setHCEntitlementStatus("true");
                this.entitlementSet = true;
                if(this.realmRefreshHappened && this.entitlementSet) {
                    this.blueConicClient.createEvent("hou_entitlement_status_set");       
                    console.log('hou entitlement event fired...');               
                }
            } else {
                this._setHCEntitlementStatus("false");
                this.entitlementSet = true;
                if(this.realmRefreshHappened && this.entitlementSet) {
                    this.blueConicClient.createEvent("hou_entitlement_status_set");       
                    console.log('hou entitlement event fired...');               
                }
            }
        } else {
            //if they have starbucks entitlements, don't clear entitlements
            if(this._checkandUpdateStarbucksEntitlements('hou_starbucks_entitlement_status')){
                this._setHCEntitlementStatus("true");
                this.entitlementSet = true;
                if(this.realmRefreshHappened && this.entitlementSet) {
                    this.blueConicClient.createEvent("hou_entitlement_status_set");       
                    console.log('hou entitlement event fired...');               
                }
            }
            else{
                // not logged in, invalidate 'hrstctok' cookie
                if (hrstctokCookie) {
                    // invalidate 'hrstctok' cookie
                    this._setCookie("hrstctok", "", -1, cookieDomain);
                }
                this.profile.setValue('hou_starbucks_entitlement_status', "false");
                this.blueConicClient.profile.updateProfile();
                // reset entitlement status
                this._setHCEntitlementStatus("false");
                this.entitlementSet = true;
                if(this.realmRefreshHappened && this.entitlementSet) {
                    this.blueConicClient.createEvent("hou_entitlement_status_set");       
                    console.log('hou entitlement event fired...');               
                }
            }
        }
    },    
    
    // See https://blueconic.zendesk.com/agent/tickets/8348
    _processSAENLoggedInStatus: function(cookieDomain) {
        var hrstctokCookie = this.blueConicClient.util.cookie.getCookie("hrstctok");
        var saenLoggedInStatus = this.profile.getValue("saen_logged_in_status");
        console.log(window.treg.identity);
        if (saenLoggedInStatus && saenLoggedInStatus === true) {
            this._setTregEmailAdress();
            if (window.treg && window.treg.identity && window.treg.identity.entitlementId && !hrstctokCookie && window.treg.identity.id && window.$) {
                // 'hrstctok' cookie not present, check identity service
                this._checkISCookiesForSAEN(cookieDomain, this._setENEntitlementStatus); //ENABLE LATER
            } 
            else if (hrstctokCookie) {
                // 'hrstctok' cookie already present, set entitlement status
                this._setENEntitlementStatus("true");
                this.entitlementSet = true;
                if(this.realmRefreshHappened && this.entitlementSet) {
                    me.blueConicClient.createEvent("sean_entitlement_status_set");       
                    console.log('sean entitlement event fired...');               
                }
            } else {
                this._setENEntitlementStatus("false");
                this.entitlementSet = true;
                if(this.realmRefreshHappened && this.entitlementSet) {
                    me.blueConicClient.createEvent("sean_entitlement_status_set");       
                    console.log('sean entitlement event fired...');               
                }
            }
        } else {
            // not logged in, invalidate 'hrstctok' cookie
            if (hrstctokCookie) {
                // invalidate 'hrstctok' cookie
                this._setCookie("hrstctok", "", -1, cookieDomain);
            }
            // reset entitlement status
            this._setENEntitlementStatus("false");
            this.entitlementSet = true
            if(this.realmRefreshHappened && this.entitlementSet) {
                me.blueConicClient.createEvent("sean_entitlement_status_set");       
                console.log('sean entitlement event fired...');               
            }
        }
    },

    // See https://blueconic.zendesk.com/agent/tickets/8348
    _processSFLoggedInStatus: function(cookieDomain) {
        var hrstctokCookie = this.blueConicClient.util.cookie.getCookie("hrstctok");
        var sfcLoggedInStatus = this.profile.getValue("sfc_logged_in_status");
        if ((sfcLoggedInStatus && sfcLoggedInStatus === true)) {
            this._setTregEmailAdress();
            if(document.URL.indexOf('cmf.qa') > -1){
                if (window.treg && window.treg.identity && !hrstctokCookie && window.treg.identity.id && window.$) {
                    // 'hrstctok' cookie not present, check identity service
                    this._checkIdentityServiceForCookies(cookieDomain); //ENABLE LATER
                }                
            }
            else if (window.treg && window.treg.identity && window.treg.identity.edbId && !hrstctokCookie && window.treg.identity.id && window.$) {
                // 'hrstctok' cookie not present, check identity service
                this._checkIdentityServiceForCookies(cookieDomain); //ENABLE LATER
            } else if (hrstctokCookie) {
                // 'hrstctok' cookie already present, set entitlement status
                this._setSFEntitlementStatus("true");
                this.blueConicClient.profile.getProfile().addValue("entitlement_sources", "paid");
                this.entitlementSet = true;
                if(this.realmRefreshHappened && this.entitlementSet) {
                    this.blueConicClient.createEvent("sfc_entitlement_status_set");       
                    console.log('sfc entitlement event fired...');               
                }
            } else {

                this._setSFEntitlementStatus("false");
                this.profile.setValue('sfc_starbucks_entitlement_status', "false");
                this.blueConicClient.profile.updateProfile();
                this.entitlementSet = true;
                if(this.realmRefreshHappened && this.entitlementSet) {
                    this.blueConicClient.createEvent("sfc_entitlement_status_set");       
                    console.log('sfc entitlement event fired...');               
                }
            }
        } else {
            //check vendor token
            if(this._checkandUpdateStarbucksEntitlements('sfc_starbucks_entitlement_status')){
                //give entitlements
                this._setSFEntitlementStatus("true");
                this.entitlementSet = true;
                if(this.realmRefreshHappened && this.entitlementSet) {
                    this.blueConicClient.createEvent("sfc_entitlement_status_set");       
                    console.log('sfc entitlement event fired...');               
                }
            }
            else {
                // not logged in, invalidate 'hrstctok' cookie
                if (hrstctokCookie) {
                    // invalidate 'hrstctok' cookie
                    this._setCookie("hrstctok", "", -1, cookieDomain);
                }
                // reset entitlement status
                this._setSFEntitlementStatus("false");
                this.entitlementSet = true;
                if(this.realmRefreshHappened && this.entitlementSet) {
                    this.blueConicClient.createEvent("sfc_entitlement_status_set");       
                    console.log('sfc entitlement event fired...');               
                }
            }
        }
    },

    //CT Insider
    _processCTILoggedInStatus: function(cookieDomain) {
        var hrstctokCookie = this.blueConicClient.util.cookie.getCookie("hrstctok");
        var ctiLoggedInStatus = this.profile.getValue("cti_logged_in_status");

        if (ctiLoggedInStatus && ctiLoggedInStatus === true) {
            this._setTregEmailAdress();
            if (window.treg && window.treg.identity && !hrstctokCookie && window.treg.identity.id && window.$) {
                // 'hrstctok' cookie not present, check identity service with the CT market value
                this._checkIdentityServiceForCookiesCTI(cookieDomain);  //ENABLE LATER

            } else if (hrstctokCookie) {
                // 'hrstctok' cookie already present, set entitlement status
                this._setCTIEntitlementStatus("true");
                this.entitlementSet = true;
                if(this.realmRefreshHappened && this.entitlementSet) {
                    this.blueConicClient.createEvent("cti_entitlement_status_set");       
                    console.log('Entitlement event fired after cookie was found...');               
                }
                console.log('CTI Entitlment Set...');
            } else {
                this._setCTIEntitlementStatus("false");
                this.entitlementSet = true;
                if(this.realmRefreshHappened && this.entitlementSet) {
                    this.blueConicClient.createEvent("cti_entitlement_status_set");  
                         
                    console.log('Entitlement event fired after no cookie was found...');    
                }
                console.log('CTI Entitlment Set...');
            }
        } else {
            // not logged in, invalidate 'hrstctok' cookie
            if (hrstctokCookie) {
                // invalidate 'hrstctok' cookie
                this._setCookie("hrstctok", "", -1, cookieDomain);
            }
            // reset entitlement status
            this._setCTIEntitlementStatus("false");
            this.entitlementSet = true;
            if(this.realmRefreshHappened && this.entitlementSet) {
                this.blueConicClient.createEvent("cti_entitlement_status_set");       
                console.log('Entitlement event fired...');    
            }
            console.log('CTI Entitlment Set...');
        }
    },

    _checkIdentityServiceForCookies: function(cookieDomain) {
        var me = this;
        var entitlementStatus = "false";
        var subscriberId = window.treg.identity.id;
        var url = "https://web.archive.org/web/20211007044655/https://casper-services-prod-dot-eco-cyclist-168716.appspot.com/";
        if (window.location.hostname.indexOf("qa") !== -1) {
            // call the QA service instead
            url = "https://web.archive.org/web/20211007044655/https://casper-services-qa-dot-eco-cyclist-168716.appspot.com/";
        }
        window.$.ajax({
            type: "POST",
            url: url + "userManager/getEntitlementStatusForBC",
            dataType: "json",
            contentType: "application/json",
            crossDomain: true,
            data: JSON.stringify({
                realmID: subscriberId,
                market: 'SF'
            }),
            success: function(res) {
                console.log('success:', res);
                if (res && res.meta && res.meta.code == "200" && res.data && res.data.status == "1" && res.data.cookies && res.data.cookies.length > 0) {
                    // set cookies from response
                    console.log('setting cookies: ', res.data.cookies);
                    res.data.cookies.forEach(function(cookie) {
                        var cookieValue = [];
                        for (var attr in cookie) {
                            if (attr !== "name") {
                                cookieValue.push(attr + "=" + (cookie[attr] || ""));
                            }
                        }
                        me._setCookie(cookie.name, cookieValue.join(","), 1, cookieDomain);
                    });
                    
                     if (me.blueConicClient.util.cookie.getCookie("hrstctok")) {
                        // 'hrstctok' cookie is now set, (re)set entitlement status
                        entitlementStatus = "true";
                    }
                    me._setSFEntitlementStatus(entitlementStatus);
                    
                    if(document.URL.indexOf("#")==-1){ //Check if the current URL contains '#'
                        var localURL = document.URL+"#"; // use "#". Add hash to URL
                        location = "#";
                        location.reload(true); //Reload the page
                     }
                }
            },
            error: function() {
                console.log('error');
                me._setSFEntitlementStatus(entitlementStatus);
            }
        });
    },
    
    //Check Cookies for HOU
    _checkISCookiesForHOUCookies: function(cookieDomain, callbackfn) {
        var me = this;
        var url = "https://web.archive.org/web/20211007044655/https://casper-services-prod-dot-eco-cyclist-168716.appspot.com/";
        if (window.location.hostname.indexOf("cmf.qa") !== -1) {
            // call the QA service instead
            url = "https://web.archive.org/web/20211007044655/https://casper-services-dev2-dot-eco-cyclist-168716.ue.r.appspot.com/";
        }
        window.$.ajax({
            type: "POST",
            url: url + "userManager/getEntitlementStatusForBC",
            dataType: "json",
            contentType: "application/json",
            crossDomain: true,
            data: JSON.stringify({
                realmID: window.treg.identity.id,
                market: 'HC'
            }),
            success: function(res) {
                console.log('success:', res);
                if (res && res.meta && res.meta.code === 200 && res.data && res.data.status == "1") {
                    // set cookies from response
                    var hrstctok = res.data.cookies[0].ch + ',pal=' + res.data.activePublication[0]; // cookie value
                    me._setCookie("hrstctok", hrstctok, 1, cookieDomain);
                    
                    if(document.URL.indexOf("#")==-1 && !(document.URL.search('subscription')> -1)){ //Check if the current URL contains '#' or if it's on the subscription domain
                        var localURL = document.URL+"#"; // use "#". Add hash to URL
                        location = "#";
                        location.reload(true); //Reload the page
                    }
                    callbackfn.call(me);
                }
            },
            error: function() {
                console.log('error');
                callbackfn.call(me);
            }
        });
    },
    _checkISCookiesForSAEN: function(cookieDomain, callbackfn) {
        var me = this;
        var url = "https://web.archive.org/web/20211007044655/https://casper-services-prod-dot-eco-cyclist-168716.appspot.com/";
        if (window.location.hostname.indexOf("cmf.qa") !== -1) {
            // call the QA service instead
            url = "https://web.archive.org/web/20211007044655/https://casper-services-qa2-dot-eco-cyclist-168716.ue.r.appspot.com/";
        }
        window.$.ajax({
            type: "POST",
            url: url + "userManager/getEntitlementStatusForBC",
            dataType: "json",
            contentType: "application/json",
            crossDomain: true,
            data: JSON.stringify({
                realmID: window.treg.identity.id,
                market: 'SA'
            }),
            success: function(res) {
                console.log('success:', res);
                if (res && res.meta && res.meta.code === 200 && res.data && res.data.status == "1") {
                    // set cookies from response
                    var hrstctok = res.data.cookies[0].ch;
                    me._setCookie("hrstctok", hrstctok, 1, cookieDomain);
                    
                    if(document.URL.indexOf("#")==-1 && !(document.URL.search('subscription')> -1)){ //Check if the current URL contains '#' or if it's on the subscription domain
                        var localURL = document.URL+"#"; // use "#". Add hash to URL
                        location = "#";
                        location.reload(true); //Reload the page
                    }
                    callbackfn.call(me);
                }
            },
            error: function() {
                console.log('error');
                callbackfn.call(me);
            }
        });
    },
    //Check Cookies for HOUSAEN
    _checkISCookiesForHOUSAEN: function(cookieDomain, callbackfn) {
        var me = this;
        var entitlementStatus = "false";
        var entitlementID = window.treg.identity.entitlementId;
        window.$.ajax({
            type: "POST",
            url: this.contentServiceURL,
            dataType: "json",
            contentType: "application/json",
            crossDomain: true,
            data: JSON.stringify({
                edbId: window.treg.identity.entitlementId,
                edbpMarket: this.marketValue,
                sourceSystem: 'SITE'
            }),
            success: function(res) {
                console.log('success:', res);
                if (res && res.meta && res.meta.code === 200 && res.data && res.data.Success == "true") {
                    // set cookies from response
                    console.log('setting cookies: ', res.data.ContentToken);
                    var contentTokenData = JSON.parse(res.data.ContentToken);
                    
                    var hrstctok = contentTokenData.contentToken.cookies ? contentTokenData.contentToken.cookies.hrstctok : undefined;
                    me._setCookie("hrstctok", hrstctok, 1, cookieDomain);
                    
                     if(document.URL.indexOf("#")==-1 || !(document.URL.search('subscription')> -1)){ //Check if the current URL contains '#' or if it's on the subscription domain
                        var localURL = document.URL+"#"; // use "#". Add hash to URL
                        location = "#";
                        location.reload(true); //Reload the page
                     }
                    callbackfn.call(me);
                }
            },
            error: function() {
                console.log('error');
                callbackfn.call(me);
            }
        });
    },

    //Check Cookies for TU
    _checkIdentityServiceForCookiesTU: function() {
        var me = this;
        var edbURL;
        if(document.URL.indexOf("cmf.qa") > 0){
            edbURL = "https://web.archive.org/web/20211007044655/https://casper-services-dev2-dot-eco-cyclist-168716.appspot.com/getEdbpToken";
        }
        else edbURL = "https://web.archive.org/web/20211007044655/https://casper-services-prod-dot-eco-cyclist-168716.appspot.com/getEdbpToken";
        var entitlementStatus = "false";
        window.$.ajax({
            type: "POST",
            url: edbURL,
            dataType: "json",
            contentType: "application/json",
            crossDomain: true,
            data: JSON.stringify({
                edbId: window.treg.identity.entitlementId,
                edbpMarket: 'ALBY',
                sourceSystem: 'SITE'
            }),
            success: function(res) {
                // The parsing has changed between ticket #9140 and #10071
                if (res && res.meta && res.meta.code === 200 && res.data && res.data.Success == "true"){
                    try {
                        var hrstptok = res.data.ProductToken;
                        res = JSON.parse(res.data.ContentToken);
                        var hrstctok = res.contentToken.cookies ? res.contentToken.cookies.hrstctok : undefined;
                        me._setCookie("hrstctok", hrstctok, 1, "timesunion.com");
                        me._setCookie("hrstptok", hrstptok, 1, "timesunion.com");
                    } catch (e) {
                        // failed parsing, skipping
                    }

                    if (me.blueConicClient.util.cookie.getCookie("hrstctok")) {
                        // 'hrstctok' cookie is now set, (re)set entitlement status
                        entitlementStatus = "true";
                    }
                    me._setTUEntitlementStatus(entitlementStatus);
                }
            },
            error: function(error) {
                me._setTUEntitlementStatus("false");
            }
        });
    },

    //Check Cookies for CTI
    _checkIdentityServiceForCookiesCTI: function(cookieDomain) {
        var me = this;
        var entitlementStatus = "false";
        var subscriberId = window.treg.identity.id;
        var url = "https://web.archive.org/web/20211007044655/https://casper-services-prod-dot-eco-cyclist-168716.appspot.com/";
        if (window.location.hostname.indexOf("cmf.qa") !== -1) {
            // call the QA service instead
            url = "https://web.archive.org/web/20211007044655/https://casper-services-qa2-dot-eco-cyclist-168716.appspot.com/";
        }
        window.$.ajax({
            type: "POST",
            url: url + "userManager/getEntitlementStatusForBC",
            dataType: "json",
            contentType: "application/json",
            crossDomain: true,
            data: JSON.stringify({
                realmID: subscriberId,
                market: 'CT'
            }),
            success: function(res) {
                console.log('success:', res);
                if (res && res.meta && res.meta.code == "200" && res.data && res.data.status == "1" && res.data.cookies && res.data.cookies.length > 0) {
                    // set cookies from response
                    console.log('setting cookies: ', res.data.cookies);
                    res.data.cookies.forEach(function(cookie) {
                        var cookieValue = [];
                        for (var attr in cookie) {
                            if (attr !== "name") {
                                cookieValue.push(attr + "=" + (cookie[attr] || ""));
                            }
                        }
                        me._setCookie(cookie.name, cookieValue.join(","), 1, cookieDomain);
                    });
                    
                    if (me.blueConicClient.util.cookie.getCookie("hrstctok")) {
                        // 'hrstctok' cookie is now set, (re)set entitlement status
                        entitlementStatus = "true";
                        me.blueConicClient.profile.getProfile().addValue("entitlement_sources", "paid");
                    }
                    me._setCTIEntitlementStatus(entitlementStatus);
                   // me.entitlementSet = true;
                    console.log('CTI Entitlment Set...');
                    console.log('cookie found for cti')
                    
                    //reload the page after entitlement is set
                    if(!localStorage.getItem('bc_cti_refresh')){
                        localStorage.setItem('bc_cti_refresh','true');
                        window.location.reload();
                        console.log('ctidomain refresh after setting cookie...');
                    }
                }
            },
            error: function() {
                console.log('error');
                me._setCTIEntitlementStatus(entitlementStatus);
                me.entitlementSet = true;
                if(me.realmRefreshHappened && me.entitlementSet) {
                    me.blueConicClient.createEvent("cti_entitlement_status_set");         
                    console.log('Entitlement event fired...');           
                }
                console.log('CTI Entitlment Set...');
            }
        });
    },

    _setSFEntitlementStatus: function(status) {
        //if true, check and set in grace entitlement status
        if(status === "true" ){
            //check the date
            var graceDateChecked = JSON.parse(localStorage.getItem('in_grace_date_set_sfc'));
            var graceDateDifference;
            var graceDateInterval;
            if(graceDateChecked){
                if(document.URL.indexOf('cmf.qa') > -1){
                    //compare the date for 2 minutes
                    // graceDateDifference = (Date.now() - graceDateChecked)/ (1000 * 60);
                    // graceDateInterval = 2; // 2 minutes
                    this._checkInGraceStatus(window.treg.identity.id, 'SF', 'SFC', 'in_grace_date_set_sfc', 'in_grace_status_sfc','in_grace_status_set_date_sfc');
                }
                else {
                    //compare the date for 24 hours
                    graceDateDifference = (Date.now() - graceDateChecked)/ (1000 * 60 * 60);  
                    graceDateInterval = 24; // 24 hours
                }
                if(graceDateDifference > graceDateInterval){
                    this._checkInGraceStatus(window.treg.identity.id, 'SF', 'SFC', 'in_grace_date_set_sfc', 'in_grace_status_sfc','in_grace_status_set_date_sfc');
                }
            }
            else{
                this._checkInGraceStatus(window.treg.identity.id, 'SF', 'SFC', 'in_grace_date_set_sfc', 'in_grace_status_sfc','in_grace_status_set_date_sfc');
            }
        }
        this.profile.setValue("sfc_entitlement_status", status);
        if(window.treg.identity.email){
            if(window.treg.identity.email.indexOf("@49ers.com") > -1 || window.treg.identity.email.indexOf("@49ers-smc.com") > -1){
                this.profile.setValue("sfc_entitlement_status", "true");
                this.profile.addValue("entitlement_sources", "49ers");
                if(!localStorage.getItem('sfc_refresh')){
                    localStorage.setItem('sfc_refresh', "true");
                    window.location.reload();
                }
            }
        }
        else {
            if(localStorage.getItem('sfc_refresh')){
                localStorage.removeItem('sfc_refresh');
            }
        }
        this.blueConicClient.profile.updateProfile(this, function() {
            // publish event to that will trigger content metering
            // this will allow the content meter to wait for the entitlement status to get set
            // before evaluating the profile
            // this.blueConicClient.createEvent("cm_start_metering");
            window.setTimeout(function() {
                this.blueConicClient.createEvent("cm_start_metering");
            }, 3000);
        });
    },

    _setCTIEntitlementStatus: function(status) {
        this.profile.setValue("cti_entitlement_status", status);
        this.blueConicClient.profile.updateProfile(this, function() {
            // publish event to that will trigger content metering
            // this will allow the content meter to wait for the entitlement status to get set
            // before evaluating the profile
            window.setTimeout(function() {
                this.blueConicClient.createEvent("cm_start_metering");
            }, 2000);
            
        });
    },

    _setCookie: function(name, value, exdays, domain) {
        var exdate = new Date();
        exdate.setDate(exdate.getDate() + exdays);
        var cookieValue = encodeURIComponent(value) + ";expires=" + exdate.toUTCString() + ";domain=." + domain + ";path=/";
        document.cookie = name + "=" + cookieValue;
    },
    _setStarbucksCookie: function(name, value, exhours, domain) {
        var exdate = new Date();
        value = 'st=' + exdate;
        console.log('inside set starbucks cookie');
        if (window.location.hostname.indexOf("qa") !== -1) {
            exdate.setMinutes(exdate.getMinutes() + 5);    
        } else {
            exdate.setHours(exdate.getHours() + exhours);
        }
        value = value + ',et=' + exdate + ",expires=" + exdate.toUTCString() + ",domain=." + domain + ",pal=hc_hc,path=/";
        var starbucksCookieValue = encodeURIComponent(value) + ",expires=" + exdate.toUTCString() + ",domain=." + domain + ",vendor=starbucks;path=/";
        var cookieValue = encodeURIComponent(value) ;
        var vendorCookieName = " hrstvdtok";
        document.cookie = name + "=" + cookieValue;
        document.cookie = vendorCookieName + "=" + starbucksCookieValue;
        console.log('Starbucks Cookie set...');
        console.log(cookieValue);
    },
    // getEdbId from cookie
    _getEdbId: function() {
        var edbId;
        
        if(window.treg && window.treg.identity && window.treg.identity.entitlementId) {
            edbid = window.treg.identity.entitlementId;    
        }
        
        return edbId;
    },

    // get EDB e-mail address from cookie
    _getEdbEmailAddress: function() {
        var edbEmailAddress;
        edbEmailAddress = window.treg.identity.email;
        return edbEmailAddress;
    },

    // https://jira.blueconic.com/jira/browse/BC-9233
    _readCookie: function(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(";");
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) === " ") {
                c = c.substring(1, c.length);
            }
            if (c.indexOf(nameEQ) === 0) {
                return c.substring(nameEQ.length, c.length);
            }
        }
        return null;
    },

    _setHCCookiesFromCMF: function() {
        var me = this;
        var url = "https://web.archive.org/web/20211007044655/https://www.houstonchronicle.com/validateAndSetHrstctok.php";
        var hrstctok = this.blueConicClient.util.cookie.getCookie("hrstctok");
        var hrstptok = this.blueConicClient.util.cookie.getCookie("hrstptok");
        if (window.location.hostname.indexOf("qa") !== -1) {
            url = "https://web.archive.org/web/20211007044655/https://cmf.qa1.houstonchronicle.com/validateAndSetHrstctok.php";
        }
        
        if (hrstptok && !hrstctok) {
            fetch(url).then(function(response) {
                if (response.ok) {
                    me._setHCEntitlementStatus();
                } else {
                    me._setHCEntitlementStatus();
                }
            });
        } else {
            this._setHCEntitlementStatus();
        }
    },
    
    _setCookiesFromCMF: function(url, callbackfn) {
        var me = this;
        var hrstctok = this.blueConicClient.util.cookie.getCookie("hrstctok");
        var hrstptok = this.blueConicClient.util.cookie.getCookie("hrstptok");
        var page = "";
        if (window.HDN && window.HDN.dataLayer && window.HDN.dataLayer.content && window.HDN.dataLayer.content.objectType) {
            page = window.HDN.dataLayer.content.objectType;
        }
        console.log('evaluate page status and cookies before: EVENT');
        if (hrstptok && !hrstctok) {
            fetch(url).then(function(response) {
                if (response.ok) {
                    console.log('response OK : EVENT');
                    callbackfn.call(me);
                } else {
                    callbackfn.call(me);
                }
            });
        } else {
            console.log('no calling the endpoint; calling hc entitlement status: before call : EVENT');
            callbackfn.call(me);
        }
    },

    // See https://blueconic.zendesk.com/agent/tickets/8486
    _setHCEntitlementStatus: function() {
        var me = this;
        console.log('inside entitlement status: EVENT');
        var hrstctok = this.blueConicClient.util.cookie.getCookie("hrstctok");
        var palVal = null;
        if (hrstctok) {
            var pal = hrstctok.split(",").filter(function(entry) {
                return entry.indexOf("pal=") === 0;
            });
            if (pal.length > 0) {
                palVal = pal[0].split("=")[1].toLowerCase();
            }
        }
        var houEntitlement = palVal !== null && (palVal.indexOf("hc_hc") !== -1 || palVal.indexOf("HC_HC") !== -1 || palVal.indexOf("HC_KR") !== -1 || palVal.indexOf("HC_WV") !== -1
            || palVal.indexOf("hc_kr") !== -1 || palVal.indexOf("hc_wv") !== -1);
        me.profile.setValue("hou_entitlement_status", houEntitlement);
        me.profile.setValue("hou_tsn_entitlement_status", palVal !== null && (palVal.indexOf("hc_tsn") !== -1 || palVal.indexOf("hc_hc") !== -1 || palVal.indexOf("HC_HC") !== -1 ||  palVal.indexOf("HC_TSN") !== -1));
        me.blueConicClient.profile.getProfile().addValue("entitlement_sources", houEntitlement ? "paid" : "");
        console.log('BEFORE - Calling the event - CMF QA1 HC ENT DETECTION COMPLETE : EVENT');
        window.detection = window.detection || {};
        window.detection.hc_ent_detection_complete = true;
        console.log('Calling onLoad: EVENT');
        //this.onLoad();
        console.log('after Calling onLoad: EVENT');
        this.blueConicClient.profile.updateProfile(this, function(){
            let regexp = new RegExp("cmf\\.qa\\d\\.houstonchronicle\\.com$", "i");
            if(!regexp.test(me.hostname)) {
                window.setTimeout(function() {
                    this.blueConicClient.createEvent("cm_start_metering");
                }, 2000);
            }    
        });
    },
    
    _setENEntitlementStatus: function() {
        var me = this;
        var status = me.blueConicClient.util.cookie.getCookie("hrstctok") ? "true" : "false";
        me.profile.setValue("saen_entitlement_status", status);
        me.blueConicClient.profile.getProfile().addValue("entitlement_sources", status=="true" ? "paid" : "");
        // set EDB e-mail address according to https://blueconic.zendesk.com/agent/tickets/7817
        me._setEdbEmailAddress();
        window.detection = window.detection || {};
        window.detection.hc_ent_detection_complete = true;
        if(document.URL.indexOf('cmf.qa') > -1){
            //if true, check and set in grace entitlement status
            if(status === "true" ){
                //check the date
                var graceDateChecked = JSON.parse(localStorage.getItem('in_grace_date_set_saen'));
                var graceDateDifference;
                var graceDateInterval;
                if(graceDateChecked){
                    if(document.URL.indexOf('cmf.qa') > -1){
                        //compare the date for 2 minutes
                        graceDateDifference = (Date.now() - graceDateChecked)/ (1000 * 60);
                        graceDateInterval = 2; // 2 minutes
                    }
                    else {
                        //compare the date for 24 hours
                        graceDateDifference = (Date.now() - graceDateChecked)/ (1000 * 60 * 60);  
                        graceDateInterval = 24; // 24 hours
                    }
                    if(graceDateDifference > graceDateInterval){
                        this._checkInGraceStatus(window.treg.identity.id, 'SA', 'SA_SAEN', 'in_grace_date_set_saen', 'in_grace_status_saen','in_grace_status_set_date_saen');
                    }
                }
                else{
                    this._checkInGraceStatus(window.treg.identity.id, 'SA', 'SA_SAEN', 'in_grace_date_set_saen', 'in_grace_status_saen','in_grace_status_set_date_saen');
                }
            }
        }
        this.blueConicClient.profile.updateProfile(this, function() {
            // publish event to that will trigger content metering
            // this will allow the content meter to wait for the entitlement status to get set
            // before evaluating the profile
            window.setTimeout(function() {
                this.blueConicClient.createEvent("cm_start_metering");
            }, 2000);
        });
    },

    /* code supplied by hearst, see https://blueconic.zendesk.com/agent/tickets/6316 */
    // code supplied by Hearst for Interstitial
    
    _triggerEntitlementEvent: function (cookieDomain) {
        if(cookieDomain === 'houstonchronicle.com' || cookieDomain === 'chron.com') {
            this.blueConicClient.createEvent('hou_entitlement_status_set');
            console.log('Hou entitlment event fired...')
        }
        else if(cookieDomain === 'expressnews.com' || cookieDomain === 'mysanantonio.com') {
            this.blueConicClient.createEvent('sean_entitlement_status_set');
            console.log('sean entitlment event fired...')
        }
        else if(cookieDomain === 'sfchronicle.com' || cookieDomain === 'sfgate.com') {
            this.blueConicClient.createEvent('sfc_entitlement_status_set');
            console.log('sfc entitlment event fired...')
        }
        else if(cookieDomain === 'ctinsider.com') {
            this.blueConicClient.createEvent('cti_entitlement_status_set');
            console.log('cti entitlment event fired from trigger method...')
        }
    },
    _setTregEmailAdress: function() {
        if(window.treg.identity.email) {
            var emailDomain = window.treg.identity.email.split("@")[1];
            this.profile.setValue("email_domain", emailDomain);
            this.profile.setValue("realm_id", window.treg.identity.id);
            this.profile.setValue("realm_id", window.treg.identity.id);
            this.profile.setValue("edb_email", window.treg.identity.email);
            this.profile.setValue("email", window.treg.identity.email);
            this.blueConicClient.profile.updateProfile();

            //check realm id from localstorage, if none found set it 
            if(window.localStorage.getItem('bc.realm.id')){
                //check if they are the same
                if(!(window.localStorage.getItem('bc.realm.id') === window.treg.identity.id)){
                    //set it to the new one
                    window.localStorage.setItem('bc.realm.id', window.treg.identity.id);
                }
            }
            else{
                window.localStorage.setItem('bc.realm.id', window.treg.identity.id);
            }
        }
        console.log('updated email from TREG');
    },
    _setStarbucksEntitlements: function () {
        //give valid entitlments and set cookie
        let hrstctok = '';
        let cookieDomain = 'sfchronicle.com';
        this._setStarbucksCookie("hrstctok", hrstctok, 4, cookieDomain);
        this.blueConicClient.profile.getProfile().setValue("sfc_entitlement_status", "true");
        this.blueConicClient.profile.getProfile().setValue("sfc_starbucks_entitlement_status", "true");
        console.log('this.referrer: '+this.referrer);
         if (this.referrer && this.referrer.toLowerCase().indexOf("/starbucks") > -1) {
            this.profile.setValue("starbucks_referrer", "true");
         } else {
             this.profile.setValue("starbucks_referrer", "false");
         }
        this.blueConicClient.profile.updateProfile();
        console.log(this.profile.getValue('sfc_starbucks_entitlement_status'));
    },
    _checkandUpdateStarbucksEntitlements: function(marketStarbucksProperty){
        //search for vendor cookie
        var hrstvdtok = this.blueConicClient.util.cookie.getCookie("hrstvdtok");
        if(hrstvdtok) {
            //set starbucks entitlements
            console.log('Vendor token found!');
            this.blueConicClient.profile.getProfile().setValue(marketStarbucksProperty, "true");
            return true;
        }
        else{
            console.log('no vendor token or expired');
            this.blueConicClient.profile.getProfile().setValue(marketStarbucksProperty, "false");
            return false;
        }
    },

    //Check the vendor cookies and add valid entitlements to the sources
    _checkVendorCookies: function(){
        var hrstvdok = this.blueConicClient.util.cookie.getCookie("hrstvdtok");
        var vendorVal = null;
        if (hrstvdok) {
            var vendor = hrstvdok.split(",").filter(function(entry) {
                return entry.indexOf("vendor=") === 0;
            });
            if (vendor.length > 0) {
                vendorVal = vendor[0].split("=")[1].toLowerCase();
            }
            this.blueConicClient.profile.getProfile().setValue("entitlement_sources", vendorVal);
            this.blueConicClient.profile.updateProfile();
        }
    },

    _checkInGraceStatus: function(realmId, market, publicationCode, localStorageItem, gracestatusPP, gracestatusDatePP) {
        var graceLocalItem = JSON.parse(localStorage.getItem(localStorageItem));
        var graceDateChecked;
        var graceDateDifference;
        var graceDateInterval;
        //check for the item in local storage and the email
        if(graceLocalItem){
            if((graceLocalItem.email === window.treg.identity.email)) {
                graceDateChecked = JSON.parse(localStorage.getItem(localStorageItem)).date
                if(document.URL.indexOf('cmf.qa') > -1){
                    //compare the date for 2 minutes
                    graceDateDifference = (Date.now() - graceDateChecked)/ (1000 * 60);
                    graceDateInterval = 2; // 2 minutes
                }
                else {
                    //compare the date for 24 hours
                    graceDateDifference = (Date.now() - graceDateChecked)/ (1000 * 60 * 60);  
                    graceDateInterval = 24; // 24 hours
                }
            }
        }
        if((graceDateDifference > graceDateInterval) || !graceLocalItem) {
            var me = this;
            var hasSubInGrace = false;
            var hasActiveRenewal = false; 
            var url = "https://web.archive.org/web/20211007044655/https://casper-services-prod-dot-eco-cyclist-168716.appspot.com/getSubscriptionDetailsByUserid"
            if(document.URL.indexOf("cmf.qa") > -1){
                url = "https://web.archive.org/web/20211007044655/https://casper-services-qa2-dot-eco-cyclist-168716.appspot.com/getSubscriptionDetailsByUserid"
            }
            window.$.ajax({
                type: "POST",
                url: url,
                dataType: "json",
                contentType: "application/json",
                crossDomain: true,
                data: JSON.stringify({
                    realmID: realmId,
                    market: market,
                    origin: "",
                    publicationCode: publicationCode
                }),
                success: function(res) {
                    //check the status
                    if(res.data.subscriptions){
                        // res.data.subscriptions.forEach(function(subscription){
                        //     if(subscription.subscription.active === "In Grace Period"){
                        //         hasSubInGrace = true;
                        //         console.log("BC PRELISTENER - In Grace True");
                        //     }
                        //     if(subscription.subscription.automaticRenewal === "yes"){
                        //         hasActiveRenewal = true;
                        //     }
                        //     else{
                        //         console.log("BC PRELISTENER - In Grace False");

                        //     }
                        // });

                        for(var index in res.data.subscriptions) {
                            if(res.data.subscriptions[index].subscription.active === "In Grace Period" && res.data.subscriptions[index].subscription.automaticRenewal === "no"){
                                //set the rate code
                                me.blueConicClient.profile.getProfile().setValue("rate_code", res.data.subscriptions[index].subscription.rateCode);
                                hasSubInGrace = true;
                                break;
                            }
                        }
                        //for HC reset the grace pp 
                        if(document.URL.indexOf('houstonchronicle.com') > -1){
                            //check the pub codes
                            if(res.data.subscriptions[index].subscription.pubCode === 'HC_TSN') {
                                //set the fields to TSN 
                                gracestatusPP = 'in_grace_status_tsn';
                                gracestatusDatePP = 'in_grace_status_set_date_tsn';
                            }
                            //
                        }
                        //set the status
                        if(hasSubInGrace){
                            me.blueConicClient.profile.getProfile().setValue(gracestatusPP, "true");
                        }
                        else {
                            me.blueConicClient.profile.getProfile().setValue(gracestatusPP, "false");
                        }
                        //set the date
                        var graceSetDate = Date.now();
                        var newGraceItem;
                        if(document.URL.indexOf('ctinsider.com') > -1){
                            newGraceItem = {
                                email: window.treg.identity.email,
                                date:  graceSetDate,
                                pubCode: res.data.subscriptions[index].subscription.pubCode
                            };
                        }
                        else {
                            newGraceItem = {
                                email: window.treg.identity.email,
                                date:  graceSetDate
                            };
                        }
                        localStorage.setItem(localStorageItem, JSON.stringify(newGraceItem));
                        me.blueConicClient.profile.getProfile().setValue(gracestatusDatePP, graceSetDate);
                        me.blueConicClient.profile.updateProfile(this, function() {
                            // publish event to that will trigger content metering
                            // this will allow the content meter to wait for the entitlement status to get set
                            // before evaluating the profile
                            // this.blueConicClient.createEvent("cm_start_metering");
                        });
                    }
                },
                error: function() {
                    console.log('BC PRELISTENER ERROR - In Grace status not able to be set');
                }
            });
        }
    },

    _checkInGraceAndCCDStatus: function(realmId, market, publicationCode, localStorageItem, gracestatusPP, gracestatusDatePP) {
        var graceLocalItem = JSON.parse(localStorage.getItem(localStorageItem));
        var graceDateChecked;
        var graceDateDifference;
        var graceDateInterval;
        //check for the item in local storage and the email
        if(graceLocalItem){
            if((graceLocalItem.email === window.treg.identity.email)) {
                graceDateChecked = JSON.parse(localStorage.getItem(localStorageItem)).date
                if(document.URL.indexOf('cmf.qa') > -1){
                    //compare the date for 2 minutes
                    graceDateDifference = (Date.now() - graceDateChecked)/ (1000 * 60);
                    graceDateInterval = 2; // 2 minutes
                }
                else {
                    //compare the date for 24 hours
                    graceDateDifference = (Date.now() - graceDateChecked)/ (1000 * 60 * 60);  
                    graceDateInterval = 24; // 24 hours
                }
            }
        }
        if((graceDateDifference > graceDateInterval) || !graceLocalItem) {
            var me = this;
            var hasSubInGrace = false;
            var hasActiveRenewal = false; 
            var ccdstatus = "none";
            var url = "https://web.archive.org/web/20211007044655/https://casper-services-prod-dot-eco-cyclist-168716.appspot.com/getSubscriptionDetailsByUserid"
            if(document.URL.indexOf("cmf.qa") > -1){
                url = "https://web.archive.org/web/20211007044655/https://casper-services-qa2-dot-eco-cyclist-168716.appspot.com/getSubscriptionDetailsByUserid"
            }
            window.$.ajax({
                type: "POST",
                url: url,
                dataType: "json",
                contentType: "application/json",
                crossDomain: true,
                data: JSON.stringify({
                    realmID: realmId,
                    market: market,
                    origin: "",
                    publicationCode: publicationCode
                }),
                success: function(res) {
                    //check the status
                    if(res.data.subscriptions){
                        // res.data.subscriptions.forEach(function(subscription){
                        //     if(subscription.subscription.active === "In Grace Period"){
                        //         hasSubInGrace = true;
                        //         console.log("BC PRELISTENER - In Grace True");
                        //     }
                        //     if(subscription.subscription.automaticRenewal === "yes"){
                        //         hasActiveRenewal = true;
                        //     }
                        //     else{
                        //         console.log("BC PRELISTENER - In Grace False");

                        //     }
                        // });

                        for(var index in res.data.subscriptions) {
                            if(res.data.subscriptions[index].subscription.active !== "Perm Stopped"){
                                if(res.data.subscriptions[index].subscription.active === "In Grace Period" && res.data.subscriptions[index].subscription.automaticRenewal === "no"){
                                    //set the rate code
                                    me.blueConicClient.profile.getProfile().setValue("rate_code", res.data.subscriptions[index].subscription.rateCode);
                                    hasSubInGrace = true;
                                }
                                if(res.data.subscriptions[index].subscription.ccDecline  && res.data.subscriptions[index].subscription.automaticRenewal === "yes") {
                                    //set to ccd1
                                    ccdstatus = "ccd1";
                                    if(res.data.subscriptions[index].subscription.pubCode === 'HC_TSN'){
                                        me.blueConicClient.profile.getProfile().setValue("ccdecline_status", "HC_TSN" + "_CCD1");
                                    }
                                    else me.blueConicClient.profile.getProfile().setValue("ccdecline_status", market + "_CCD1");
                                }
                                if(res.data.subscriptions[index].subscription.ccDecline  && res.data.subscriptions[index].subscription.automaticRenewal === "no" && ccdstatus !== "ccd1") {
                                    //set to ccd2
                                    ccdstatus = "ccd2";
                                    if(res.data.subscriptions[index].subscription.pubCode === 'HC_TSN'){
                                        me.blueConicClient.profile.getProfile().setValue("ccdecline_status", "HC_TSN" + "_CCD2");
                                    }
                                    else me.blueConicClient.profile.getProfile().setValue("ccdecline_status", market + "_CCD2");
                                }
                            }
                        }
                        //for HC reset the grace pp 
                        if(document.URL.indexOf('houstonchronicle.com') > -1){
                            //check the pub codes
                            if(res.data.subscriptions[index].subscription.pubCode === 'HC_TSN') {
                                //set the fields to TSN 
                                gracestatusPP = 'in_grace_status_tsn';
                                gracestatusDatePP = 'in_grace_status_set_date_tsn';
                            }
                            //
                        }
                        //set the in grace status
                        if(hasSubInGrace){
                            me.blueConicClient.profile.getProfile().setValue(gracestatusPP, "true");
                        }
                        else {
                            me.blueConicClient.profile.getProfile().setValue(gracestatusPP, "false");
                        }

                        //if ccd is none
                        if(ccdstatus === "none"){
                            me.blueConicClient.profile.getProfile().setValue("ccdecline_status", "");
                        }

                        //set the date
                        var graceSetDate = Date.now();
                        var newGraceItem;
                        if(document.URL.indexOf('ctinsider.com') > -1){
                            newGraceItem = {
                                email: window.treg.identity.email,
                                date:  graceSetDate,
                                pubCode: res.data.subscriptions[index].subscription.pubCode
                            };
                        }
                        else {
                            newGraceItem = {
                                email: window.treg.identity.email,
                                date:  graceSetDate
                            };
                        }
                        localStorage.setItem(localStorageItem, JSON.stringify(newGraceItem));
                        me.blueConicClient.profile.getProfile().setValue(gracestatusDatePP, graceSetDate);
                        me.blueConicClient.profile.updateProfile(this, function() {
                            // publish event to that will trigger content metering
                            // this will allow the content meter to wait for the entitlement status to get set
                            // before evaluating the profile
                            // this.blueConicClient.createEvent("cm_start_metering");
                        });
                    }
                },
                error: function() {
                    console.log('BC PRELISTENER ERROR - In Grace status not able to be set');
                }
            });
        }
    },
    //Set entitlements from realm 
    _setStatusAndEntitlementBasedOnTreg: function(marketValue, loggedInProperty) {

        var me = this;
        window.treg = window.treg || {};
        window.treg.cmd = window.treg.cmd || [];

        console.log("setting treg status...")
        treg.cmd.push(function(){
            var treg = window.treg;
            
            treg.realm.events.registerReplayLast("treg.onSessionFound", function() {
                me.blueConicClient.profile.getProfile().setValue(loggedInProperty, "true");
                me._setTregEmailAdress();
                me.blueConicClient.profile.updateProfile();
                me._setEntitlmentsFromRealm(marketValue);
                //refresh if first login
                me._callBcRefresh();
            });

            treg.realm.events.registerReplayLast("realm.Oidc.refreshLogicComplete", function () {
                console.log('realm refresh start -BC');
                me.realmRefreshHappened = true;
                if(me.realmRefreshHappened && me.entitlementSet) {
                    me._triggerEntitlementEvent(cookieDomain);
                }
                console.log('realm refresh complete, event created - BC');
            });

            treg.realm.events.registerReplayLast("treg.onSessionNotFound", function() {
                console.log('treg session not found... ');
                me.blueConicClient.profile.getProfile().setValue(loggedInProperty, "false");
                me.blueConicClient.profile.updateProfile();
                me._setEntitlmentsFromRealm(marketValue);
                if(localStorage.getItem('sfc_refresh')){
                    localStorage.removeItem('sfc_refresh', "true");
                }
                else if(localStorage.getItem('bc_refresh')){
                    localStorage.removeItem('bc_refresh', "true");
                }
            });

            treg.realm.events.registerReplayLast("treg.realm.tenantDataMonitor", function() {
                console.log("BC - TREG event fired: tenantDataMonitoring");
            });

            treg.realm.events.registerReplayLast("treg.onSessionEnd", function() {
                me.blueConicClient.profile.getProfile().setValue(loggedInProperty, "false");
                me.blueConicClient.profile.updateProfile();
                me._setEntitlmentsFromRealm(marketValue);
                if(localStorage.getItem('sfc_refresh')){
                    localStorage.removeItem('sfc_refresh', "true");
                    //window.location.reload();
                }
                else if(localStorage.getItem('bc_refresh')){
                    localStorage.removeItem('bc_refresh', "true");
                    //window.location.reload();
                }
            });
        });
        
    },

    _setHCEntitlementsFromRealm: function() {
        var me = this;

        if(window.treg.identity.isEntitled){
            //check in grace status
            // me._checkInGraceStatus(window.treg.identity.id, 'HC', 'HC_HC', 'in_grace_check_item_hc', 'in_grace_status_hc','in_grace_status_set_date_hc');
            me._checkInGraceAndCCDStatus(window.treg.identity.id, "HC", "HC_HC", 'in_grace_check_item_hc', 'in_grace_status_hc', 'in_grace_status_set_date_hc');
            //check if they are only TSN entitled
            if(window.treg.identity.productAccessList.length === 1) {
                if(window.treg.identity.productAccessList[0] === "HC_TSN"){
                    //set tsn entitlement
                    me.blueConicClient.profile.getProfile().setValue("hou_entitlement_status", "false");
                    me.blueConicClient.profile.getProfile().setValue("hou_tsn_entitlement_status", "true");
                    me.blueConicClient.profile.updateProfile();
                    return true;
                }
                else{
                    //set HC entitlement
                    me.blueConicClient.profile.getProfile().setValue("hou_entitlement_status", "true");
                    me.blueConicClient.profile.updateProfile();
                    return true;
                }
            }
            else {
                //set HC entitlement
                me.blueConicClient.profile.getProfile().setValue("hou_entitlement_status", "true");
                me.blueConicClient.profile.updateProfile();
                return true;
            }
        }
        else {
            me.blueConicClient.profile.getProfile().setValue("hou_entitlement_status", "false");
            me.blueConicClient.profile.getProfile().setValue("hou_tsn_entitlement_status", "false");
            me.blueConicClient.profile.updateProfile();
            return false;
        }
    },

    _callBcRefresh: function(){
        var me = this;
        if(!localStorage.getItem('bc_refresh') && me.isPremiumSite){
            localStorage.setItem('bc_refresh', "true");
            window.location.reload();
        }
    },

    _setMarketEntitlementsFromRealm: function(entitlementProperty, marketValue, pubCode, graceMarket, graceFlag) {
        var me = this;
        var corpSub;
        //check for corporate subscription
        if(window.treg.identity.productAccessList.includes('CORP')){
            this.profile.setValue("entitlement_source_most_recent_", "CORP");
            corpSub = true;
        }
        if(window.treg.identity.isEntitled) {
            if(!corpSub) this.profile.setValue("entitlement_source_most_recent_", "PAID");
            me.blueConicClient.profile.getProfile().setValue(entitlementProperty, "true");
            //check for in grace period
            if(graceFlag){
                // if(document.URL.indexOf("cmf.qa") > -1){
                //     me._checkInGraceAndCCDStatus(window.treg.identity.id, marketValue, pubCode, 'in_grace_check_item_' + graceMarket, 'in_grace_status_'+ graceMarket);
                // }
                me._checkInGraceAndCCDStatus(window.treg.identity.id, marketValue, pubCode, 'in_grace_check_item_' + graceMarket, 'in_grace_status_'+ graceMarket, 'in_grace_status_set_date_'  + graceMarket);
                // else me._checkInGraceStatus(window.treg.identity.id, marketValue, pubCode, 'in_grace_check_item_' + graceMarket, 'in_grace_status_'+ graceMarket,'in_grace_status_set_date_'  + graceMarket);
            }
            //
            me.blueConicClient.profile.updateProfile();
            return true;
        }
        else {
            me.blueConicClient.profile.getProfile().setValue(entitlementProperty, "false");
            me.blueConicClient.profile.updateProfile();
            return false;
        }
    },

    _whiteListEmailDomain: function(entitlementProperty, entitlementSource) {
        this.profile.setValue(entitlementProperty, "true");
        this.profile.addValue("entitlement_sources", entitlementSource);
        me.blueConicClient.profile.updateProfile();
    },

    _setEntitlmentsFromRealm: function (marketValue) {
        var me = this;

        if(marketValue === "SFC"){
            var isEntitled = false;
            //check realm for entitlements
            if(!me._setMarketEntitlementsFromRealm("sfc_entitlement_status", "SF", "SFC", "sfc", true)) {
                // check whitelisted emails
                if(window.treg.identity.email && document.URL.indexOf("cmf.qa") === -1){
                    if(window.treg.identity.email.indexOf("@49ers.com") > -1 || window.treg.identity.email.indexOf("@49ers-smc.com") > -1){
                        me._whiteListEmailDomain('sfc_entitlement_status', '49ers');
                        isEntitled = true;
                    }
                    else if(window.treg.identity.email.indexOf("@alamedahealthsystem.org") > -1) {
                        me._whiteListEmailDomain('sfc_entitlement_status', 'alameda_health');
                        isEntitled = true;
                    }
                    else if(window.treg.identity.email.indexOf("@thelibrafoundation.org") > -1 || window.treg.identity.email.indexOf("@taorising.com") > -1) {
                        me._whiteListEmailDomain('sfc_entitlement_status', 'corp_sub');
                        isEntitled = true;
                    }
                    else if(window.treg.identity.email.indexOf("@parsintl.com") > -1) {
                        me._whiteListEmailDomain('sfc_entitlement_status', 'corp_sub');
                        isEntitled = true;
                    }
                }
                // if user is not entitled check for the starbucks cookie
                if(!isEntitled){
                    if(me._checkandUpdateStarbucksEntitlements("sfc_starbucks_entitlement_status")) {
                        me.blueConicClient.profile.getProfile().setValue("sfc_entitlement_status", "true");
                    }
                }
            }
        }

        if(marketValue === "SAEN"){
            if(document.URL.indexOf("cmf.qa") > -1){
                me._setMarketEntitlementsFromRealm("saen_entitlement_status", "SA", "SA_SAEN", "saen", true);
            }
            else{
                me._setMarketEntitlementsFromRealm("saen_entitlement_status", "SA", "SA_SAEN", "saen", true);
            }
         }
        
        if(marketValue === "BE_BMT"){
            if(document.URL.indexOf("cmf.qa") > -1){
                me._setMarketEntitlementsFromRealm("be_be_entitlement_status", "SA", "BE_BE", "saen", false);
            }
            else{
                me._setMarketEntitlementsFromRealm("be_be_entitlement_status", "SA", "BE_BE", "saen", false);
            }
         }
        
        if(marketValue === "MP_MRT"){
            if(document.URL.indexOf("cmf.qa") > -1){
                me._setMarketEntitlementsFromRealm("mp_mrt_entitlement_status", "SA", "MP_MRT", "saen", false);
            }
            else{
                me._setMarketEntitlementsFromRealm("mp_mrt_entitlement_status", "SA", "MP_MRT", "saen", false);
            }
         }
        
        if(marketValue === "SA_LMT"){
            if(document.URL.indexOf("cmf.qa") > -1){
                me._setMarketEntitlementsFromRealm("sa_lmt_entitlement_status", "SA", "SA_LMT", "saen", false);
            }
            else{
                me._setMarketEntitlementsFromRealm("sa_lmt_entitlement_status", "SA", "SA_LMT", "saen", false);
            }
         }
        
        
        if(marketValue === "TU"){
            if(document.URL.indexOf("cmf.qa") > -1){
                me._setMarketEntitlementsFromRealm("alby_entitlement_status", "NY_ATU", "NY_ATU", "alby", true);
            }
           else me._setMarketEntitlementsFromRealm("alby_entitlement_status", "NY_ATU", "NY_ATU", "alby", true);
         }
         if(marketValue === "CTI"){
            if(document.URL.indexOf("cmf.qa") > -1){
                me._setMarketEntitlementsFromRealm("cti_entitlement_status", "CT", "CT_PO", "cti", true);
            }
            else me._setMarketEntitlementsFromRealm("cti_entitlement_status", "CT", "CT_PO", "cti", true);
         }
         if(marketValue === "HC") {
            if(!me._setHCEntitlementsFromRealm()) {
                if(me._checkandUpdateStarbucksEntitlements("hou_starbucks_entitlement_status")) {
                    me.blueConicClient.profile.getProfile().setValue("hou_entitlement_status", "true");
                }
            }
         }
         //update the profile
         
         this.blueConicClient.profile.updateProfile(this, function() {
            // publish event to that will trigger content metering
            // this will allow the content meter to wait for the entitlement status to get set
            // before evaluating the profile
            console.log('BC - start metering before');
            window.setTimeout(function() {
            	this.blueConicClient.createEvent('cm_start_metering');
            }, 2000);
            console.log('BC - after metering before');

        });
    },
    
});window.blueConicPreListeners.push({id: 'hearstprelistener', interactionType: InteractionTypeImpl });})();(function(){var InteractionTypeImpl=InteractionType.extend({blueConicClient:null,context:null,_profile:null,_userLanguage:null,_systemLanguage:null,_language:null,_referrer:null,_hostName:null,_currentUrl:null,_domain:null,ORIGIN_TYPES:{WEB:"web",MOBILE_WEB:"mobile_web",CONNECTION:"connection",MOBILE:"mobile_app"},CONSTANTS:{THIRTY_MINUTES_IN_MS:18e5,UNKNOWN:""},PROFILE_PROPERTIES:{CLICKCOUNT:"clickcount",VISITS:"visits",VISITCLICKS:"visitclicks",LASTVISITDATE:"lastvisitdate",VISITEDSITES:"visitedsites",VISITEDDOMAIN:"visiteddomain",ENTRYPAGE:"entrypage",REFERRERHOST:"referrerhost",REFERRERHOSTS:"referrerhosts",HOSTENTRYPAGE:"hostentrypage",HOSTAVERAGETIME:"hostaveragetime",LASTREFERRERAVERAGE:"lastreferreraverage",AVERAGETIME:"averagetime",TOTALVISITTIME:"totalvisittime",RESOLUTION:"resolution",CURRENTRESOLUTION:"currentresolution",CURRENTSCREENWIDTH:"currentscreenwidth",CURRENTSCREENHEIGHT:"currentscreenheight",ORIGIN_TYPE:"origin_type",ORIGIN_SOURCE:"origin_source",ORIGIN_DETAIL:"origin_detail",DEVICETYPE:"devicetype",RECEIVED_FROM_SYSTEM:"received_from_system",RECEIVED_FROM_CONNECTION:"received_from_connection",MOBILE_APP_ID:"mobile_app_id",MOBILE_APP_NAMEVERSION:"mobile_app_nameversion",LANGUAGE:"language",KEYWORDS:"keywords",CURRENTKEYWORDS:"currentkeywords",CURRENT_UTM_SOURCE:"current_utm_source",CURRENT_UTM_MEDIUM:"current_utm_medium",CURRENT_UTM_TERM:"current_utm_term",CURRENT_UTM_CONTENT:"current_utm_content",CURRENT_UTM_CAMPAIGN:"current_utm_campaign",UTM_SOURCE:"utm_source",UTM_MEDIUM:"utm_medium",UTM_TERM:"utm_term",UTM_CONTENT:"utm_content",UTM_CAMPAIGN:"utm_campaign"},PROFILE_PROPERTIES_FOR_CHANNEL:{},init:function(e,t){this.blueConicClient=e,this.context=t,this._profile=e.profile.getProfile(),this._channelId=e.getChannelId(),this._referrer=document.referrer,this._hostName=window.location.hostname,this._currentUrl=window.location.href,this._domain=document.domain,this._userLanguage=window.navigator.userLanguage,this._systemLanguage=navigator.systemLanguage,this._language=window.navigator.language,this.PROFILE_PROPERTIES_FOR_CHANNEL={CLICKCOUNT:this.PROFILE_PROPERTIES.CLICKCOUNT+"_"+this._channelId,VISITS:this.PROFILE_PROPERTIES.VISITS+"_"+this._channelId,VISITCLICKS:this.PROFILE_PROPERTIES.VISITCLICKS+"_"+this._channelId,LASTVISITDATE:this.PROFILE_PROPERTIES.LASTVISITDATE+"_"+this._channelId}},onPrepare:function(){this._profile&&(this._setLanguageProperties(),this._setResolutionProperties(),this._setReferrerProperties(),this._setCampaignProperties())},onLoad:function(){this._profile&&(this._setReferrerHostOnLoad(),this._setVisitProperties(),this._setOriginProperties(),this.blueConicClient.profile.updateProfile())},getPreloadProperties:function(){return[this.PROFILE_PROPERTIES.CLICKCOUNT,this.PROFILE_PROPERTIES.VISITS,this.PROFILE_PROPERTIES.VISITCLICKS,this.PROFILE_PROPERTIES.LASTVISITDATE,this.PROFILE_PROPERTIES.VISITEDSITES,this.PROFILE_PROPERTIES.ENTRYPAGE,this.PROFILE_PROPERTIES.HOSTENTRYPAGE,this.PROFILE_PROPERTIES.HOSTAVERAGETIME,this.PROFILE_PROPERTIES.LASTREFERRERAVERAGE,this.PROFILE_PROPERTIES.AVERAGETIME,this.PROFILE_PROPERTIES.TOTALVISITTIME,this.PROFILE_PROPERTIES.RESOLUTION,this.PROFILE_PROPERTIES.DEVICETYPE,this.PROFILE_PROPERTIES.ORIGIN_TYPE,this.PROFILE_PROPERTIES.ORIGIN_SOURCE,this.PROFILE_PROPERTIES.ORIGIN_DETAIL,this.PROFILE_PROPERTIES.RECEIVED_FROM_SYSTEM,this.PROFILE_PROPERTIES.RECEIVED_FROM_CONNECTION,this.PROFILE_PROPERTIES.VISITEDDOMAIN,this.PROFILE_PROPERTIES.MOBILE_APP_ID,this.PROFILE_PROPERTIES.MOBILE_APP_NAMEVERSION,this.PROFILE_PROPERTIES_FOR_CHANNEL.CLICKCOUNT,this.PROFILE_PROPERTIES_FOR_CHANNEL.VISITS,this.PROFILE_PROPERTIES_FOR_CHANNEL.VISITCLICKS,this.PROFILE_PROPERTIES_FOR_CHANNEL.LASTVISITDATE]},_setLanguageProperties:function(){var e=this._userLanguage||this._systemLanguage||this._language,t=this._normalizeLocale(e).split("-")[0];t&&this._profile.setValue(this.PROFILE_PROPERTIES.LANGUAGE,t)},_normalizeLocale:function(e){return e&&e.replace("_","-").toLowerCase()},_setResolutionProperties:function(){var e=screen.width,t=screen.height;this._profile.setValue(this.PROFILE_PROPERTIES.CURRENTSCREENWIDTH,e),this._profile.setValue(this.PROFILE_PROPERTIES.CURRENTSCREENHEIGHT,t);var i=e+"x"+t;this._profile.setValue(this.PROFILE_PROPERTIES.CURRENTRESOLUTION,i),this._profile.addValue(this.PROFILE_PROPERTIES.RESOLUTION,i)},_setReferrerProperties:function(){this._setReferrerKeywords(),this._setReferrerHost()},_setReferrerKeywords:function(){var e=this.HELPER.decodeReferrer(this._referrer)||[];e.length>0&&(this._addProfileValues(this.PROFILE_PROPERTIES.KEYWORDS,e),this._profile.setValues(this.PROFILE_PROPERTIES.CURRENTKEYWORDS,e))},_addProfileValues:function(e,t){(Array.isArray(t)?t:[t]).forEach(function(t){this._profile.addValue(e,t)},this)},_setReferrerHost:function(){var e=this._getReferrerHost();e!==this._hostName&&(this._profile.setValue(this.PROFILE_PROPERTIES.ENTRYPAGE,this._currentUrl),e&&(this._profile.setValue(this.PROFILE_PROPERTIES.REFERRERHOST,e),this._profile.addValue(this.PROFILE_PROPERTIES.REFERRERHOSTS,e)))},_setReferrerHostOnLoad:function(){var e=this._getReferrerHost();e!==this._hostName&&this._setHostEntryPageProperty(),this._setHostTotalAndAverageTimeProperty(this._hostName,e)},_getReferrerHost:function(){return this._referrer.replace(/http[s]?:\/\/(.*?)(:|\?|\/|$).*/,"$1")},_setCampaignProperties:function(){[this.PROFILE_PROPERTIES.UTM_SOURCE,this.PROFILE_PROPERTIES.UTM_MEDIUM,this.PROFILE_PROPERTIES.UTM_TERM,this.PROFILE_PROPERTIES.UTM_CONTENT,this.PROFILE_PROPERTIES.UTM_CAMPAIGN].forEach(function(e){var t=this._removeHashPart(this.HELPER._getParameterByName(this._currentUrl,e));t&&(this._profile.setValue("current_"+e,t),this._profile.addValue(e,t))},this)},_setHostEntryPageProperty:function(){this._profile.setValue(this.PROFILE_PROPERTIES.ENTRYPAGE,this._currentUrl);var e=this._getHostEntryPageMapping();e[this._hostName]={entrypage:this._currentUrl},this._profile.setValue(this.PROFILE_PROPERTIES.HOSTENTRYPAGE,JSON.stringify(e))},_getHostEntryPageMapping:function(){return this._safeJSONParse(this._profile.getValue(this.PROFILE_PROPERTIES.HOSTENTRYPAGE))},_safeJSONParse:function(e){try{var t=e.replace(/'/g,'"');return JSON.parse(t)||{}}catch(e){return{}}},_setHostTotalAndAverageTimeProperty:function(e,t){var i=this._safeJSONParse(this._profile.getValue(this.PROFILE_PROPERTIES.HOSTAVERAGETIME));i[e]||(i[e]=this._createNewVisitData());var s=this.blueConicClient.getCurrentDate().getTime(),E=this._profile.getValue(this.PROFILE_PROPERTIES.LASTREFERRERAVERAGE),r=0,R=0,I=0;Object.keys(i).map(function(e){return e.toString()}).forEach(function(_){var n=i[_];this._isSessionExpired(n.enddate)?this._addVisit(n,n.enddate-n.startdate):_===e?n.enddate=s:_===t&&E!==t&&(n.enddate=s,this._profile.setValue(this.PROFILE_PROPERTIES.LASTREFERRERAVERAGE,t)),0!==n.averageTime&&(R++,r+=n.averageTime,I+=n.averageTime*n.visits)},this),this._profile.setValue(this.PROFILE_PROPERTIES.HOSTAVERAGETIME,JSON.stringify(i)),this._profile.setValue(this.PROFILE_PROPERTIES.TOTALVISITTIME,I);var _=R>0?Math.round(r/R):0;this._profile.setValue(this.PROFILE_PROPERTIES.AVERAGETIME,_)},_addVisit:function(e,t){if(t>0){var i=e.averageTime*e.visits+t/1e3;e.visits++,e.averageTime=Math.round(i/e.visits)}var s=this.blueConicClient.getCurrentDate().getTime();e.startdate=s,e.enddate=s},_createNewVisitData:function(){var e=this.blueConicClient.getCurrentDate().getTime();return{startdate:e,enddate:e,averageTime:0,visits:0}},_setPropertyIfEmpty:function(e,t,i){void 0===e[t]&&(e[t]=i)},_setVisitProperties:function(){this._addVisitedDomain(this._domain),this._increaseClickCount(),this._increaseVisits(this.PROFILE_PROPERTIES.VISITS,this.PROFILE_PROPERTIES.VISITCLICKS,this.PROFILE_PROPERTIES.LASTVISITDATE),this._channelId&&this._increaseVisits(this.PROFILE_PROPERTIES_FOR_CHANNEL.VISITS,this.PROFILE_PROPERTIES_FOR_CHANNEL.VISITCLICKS,this.PROFILE_PROPERTIES_FOR_CHANNEL.LASTVISITDATE)},_increaseVisits:function(e,t,i){e=e||this.PROFILE_PROPERTIES.VISITS,t=t||this.PROFILE_PROPERTIES.VISITCLICKS,i=i||this.PROFILE_PROPERTIES.LASTVISITDATE,this._isNewSession(e,i)?(this._resetPageViewsCurrentSession(t),this._increaseSessionCount(e)):this._increasePageViewsCurrentSession(t),this._setLastVisitDate(i,this.blueConicClient.getCurrentDate().getTime())},_setLastVisitDate:function(e,t){e=e||this.PROFILE_PROPERTIES.LASTVISITDATE,this._profile.setValue(e,t)},_addVisitedDomain:function(e){this._hasVisitedDomain(e)||this._profile.addValue(this.PROFILE_PROPERTIES.VISITEDSITES,e)},_hasVisitedDomain:function(e){var t=this._profile.getValues(this.PROFILE_PROPERTIES.VISITEDSITES)||[];return t.length>0&&-1!==t.indexOf(e)},_increaseClickCount:function(){var e=this._getNumberProperty(this.PROFILE_PROPERTIES.CLICKCOUNT);if(this._profile.setValue(this.PROFILE_PROPERTIES.CLICKCOUNT,e+1),this._channelId){var t=this._getNumberProperty(this.PROFILE_PROPERTIES_FOR_CHANNEL.CLICKCOUNT);this._profile.setValue(this.PROFILE_PROPERTIES_FOR_CHANNEL.CLICKCOUNT,t+1)}},_isNewSession:function(e,t){e=e||this.PROFILE_PROPERTIES.VISITS,t=t||this.PROFILE_PROPERTIES.LASTVISITDATE;var i=this._getNumberProperty(e),s=this._getNumberProperty(t)||0;return 0===i||this._isSessionExpired(s)},_isSessionExpired:function(e){return this.blueConicClient.getCurrentDate().getTime()>e+this.CONSTANTS.THIRTY_MINUTES_IN_MS},_resetPageViewsCurrentSession:function(e){e=e||this.PROFILE_PROPERTIES.VISITCLICKS,this._profile.setValue(e,1)},_increasePageViewsCurrentSession:function(e){e=e||this.PROFILE_PROPERTIES.VISITCLICKS;var t=this._getNumberProperty(e);this._profile.setValue(e,t+1)},_increaseSessionCount:function(e){e=e||this.PROFILE_PROPERTIES.VISITS;var t=this._getNumberProperty(e);this._profile.setValue(e,t+1)},_setOriginProperties:function(){var e=this._getOriginCount();e>1?this._mergeOriginProperties():0===e&&this._resolveOriginProperties()},_getOriginCount:function(){var e=this._profile.getValues(this.PROFILE_PROPERTIES.ORIGIN_TYPE)||[],t=this._profile.getValues(this.PROFILE_PROPERTIES.ORIGIN_SOURCE)||[],i=this._profile.getValues(this.PROFILE_PROPERTIES.ORIGIN_DETAIL)||[];return Math.max(e.length,t.length,i.length)},_mergeOriginProperties:function(){this._mergePropertyToUnknown(this.PROFILE_PROPERTIES.ORIGIN_TYPE),this._mergePropertyToUnknown(this.PROFILE_PROPERTIES.ORIGIN_SOURCE),this._mergePropertyToUnknown(this.PROFILE_PROPERTIES.ORIGIN_DETAIL)},_mergePropertyToUnknown:function(e){var t=this._profile.getValues(e)||[];this._profile.setValue(e,1===t.length?t[0]:this.CONSTANTS.UNKNOWN)},_resolveOriginProperties:function(){this._isVisitorOriginFromWeb()?this._resolveOriginForWebVisitor():this._isVisitorOriginFromConnection()?this._resolveOriginForProfileComingFromConnection():this._isVisitorOriginFromMobileApp()&&this._resolveOriginForMobileAppVisitor()},_isVisitorOriginFromWeb:function(){var e=this._profile.getValues(this.PROFILE_PROPERTIES.RECEIVED_FROM_SYSTEM)||[],t=this._profile.getValues(this.PROFILE_PROPERTIES.MOBILE_APP_ID)||[];return 0===e.length&&0===t.length},_isVisitorOriginFromMobileApp:function(){var e=this._profile.getValues(this.PROFILE_PROPERTIES.RECEIVED_FROM_SYSTEM)||[],t=this._profile.getValues(this.PROFILE_PROPERTIES.MOBILE_APP_ID)||[],i=this._getNumberProperty(this.PROFILE_PROPERTIES.VISITS);return t.length>0&&0===e.length&&0===i},_isVisitorOriginFromConnection:function(){var e=this._profile.getValues(this.PROFILE_PROPERTIES.RECEIVED_FROM_SYSTEM),t=this._profile.getValues(this.PROFILE_PROPERTIES.MOBILE_APP_ID),i=this._getNumberProperty(this.PROFILE_PROPERTIES.VISITS);return e&&e.length>0&&t&&0===t.length&&i<=0},_resolveOriginForWebVisitor:function(){var e="",t=this._profile.getValues(this.PROFILE_PROPERTIES.VISITEDSITES)||[],i=this._profile.getValue(this.PROFILE_PROPERTIES.DEVICETYPE)||"",s=this._profile.getValues(this.PROFILE_PROPERTIES.ENTRYPAGE)||[];i&&(e="PC"===i?this.ORIGIN_TYPES.WEB:this.ORIGIN_TYPES.MOBILE_WEB);var E=1===t.length?t[0]:this.CONSTANTS.UNKNOWN,r=1===s.length?s[0]:this.CONSTANTS.UNKNOWN;this._setOriginProfileProperties(e,E,r)},_resolveOriginForProfileComingFromConnection:function(){var e=this._profile.getValues(this.PROFILE_PROPERTIES.RECEIVED_FROM_SYSTEM)||[],t=this._profile.getValues(this.PROFILE_PROPERTIES.RECEIVED_FROM_CONNECTION)||[],i=1===e.length?e[0]:this.CONSTANTS.UNKNOWN,s=1===t.length?t[0]:this.CONSTANTS.UNKNOWN;this._setOriginProfileProperties(this.ORIGIN_TYPES.CONNECTION,i,s)},_resolveOriginForMobileAppVisitor:function(){var e=this._profile.getValues(this.PROFILE_PROPERTIES.MOBILE_APP_ID)||[],t=this._profile.getValues(this.PROFILE_PROPERTIES.MOBILE_APP_NAMEVERSION)||[],i=1===e.length?e[0]:this.CONSTANTS.UNKNOWN,s=1===t.length?t[0]:this.CONSTANTS.UNKNOWN;this._setOriginProfileProperties(this.ORIGIN_TYPES.MOBILE,i,s)},_setOriginProfileProperties:function(e,t,i){this._profile.setValue(this.PROFILE_PROPERTIES.ORIGIN_TYPE,e),this._profile.setValue(this.PROFILE_PROPERTIES.ORIGIN_SOURCE,t),this._profile.setValue(this.PROFILE_PROPERTIES.ORIGIN_DETAIL,i)},_removeHashPart:function(e){if(e){var t=e.indexOf("#");if(-1!==t)return e.substring(0,t)}return e},HELPER:{search_engines:[["google\\.","q"],["bing\\.","q"],["search\\.yahoo\\.","p"],["search\\.aol\\.","q"],["duckduckgo\\.","q"],["baidu\\.","wd"],["ask\\.com","q"],["search\\.lycos\\.","q"],["dogpile\\.com","q"]],substringToHash:function(e){if(e){var t=e.indexOf("#");if(-1!==t)return e.substring(0,t)}return e},decodeReferrer:function(e){for(var t=new RegExp(""),i=0;i<this.search_engines.length;i++){var s=this.search_engines[i];t.compile("^http(s?)://(www\\.)?"+s[0],"i");var E=e.match(t);if(E){var r;if(r=isNaN(s[1])?this._getParameterByName(e,s[1]):E[s[1]+1])return r=decodeURIComponent(r),s.length>2&&s[2]&&(r=decodeURIComponent(r)),r=(r=(r=r.replace(/'|"/g,"")).split(/[\s,+.]+/)).filter(function(e){return e});break}}return null},_getParameterByName:function(e,t){if(!t)return"";t=t.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&#]"+t+"=([^&#]*)").exec(e);return null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))}},_getNumberProperty:function(e){var t=this._profile.getValue(e);if(!t)return 0;try{t=parseInt(t),isNaN(t)&&(t=0)}catch(e){t=0}return t}});window.blueConicPreListeners.push({id: 'listenerinteractiontype', interactionType: InteractionTypeImpl });})();(function(){
var InteractionTypeImpl=InteractionType.extend({TEST_GROUP_PROFILE_PROPERTY:"testgroup",TEST_GROUP_COOKIE_NAME:"bc_tstgrp",init:function(a,b){this.blueConicClient=a;this.context=b?b:null;this.profile=a.profile.getProfile()},onPrepare:function(){var a=this._getParameterByName("testGroup");a||(a=this.blueConicClient.util.cookie.getCookie(this.TEST_GROUP_COOKIE_NAME))||(a=Math.floor(10*Math.random())+1);this._createCookie(this.TEST_GROUP_COOKIE_NAME,a,365);this.profile.setValue(this.TEST_GROUP_PROFILE_PROPERTY,
a)},_createCookie:function(a,b,c){var d="";c&&(d=new Date,d.setTime(d.getTime()+864E5*c),d="; expires="+d.toGMTString());document.cookie=a+"="+b+d+";domain=."+this._extractRootDomain()+";path=/"},_getParameterByName:function(a){if(!a)return"";a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=(new RegExp("[\\?&]"+a+"=([^&#]*)")).exec(location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))},_extractRootDomain:function(){var a=document.location.hostname,b=a.split("."),c=b.length;
2<c&&(a=b[c-2]+"."+b[c-1]);return a}});
window.blueConicPreListeners.push({id: 'testgroup_prelistener', interactionType: InteractionTypeImpl });})();})();
(function(p,fb,ta,O,U,Q,oa,R,gb,E){function ua(){var a=c.hash(p.location.hostname).toString();return p.location.hostname&&a in BC_HOSTNAME_MAP?"https://"+BC_HOSTNAME_MAP[a]:null}function V(){return ua()||BC_URL}function Cb(a,b){this._id=a;this._parameters=b;this.getId=function(){return this._id};this.getParameters=function(){var a=null,b=null;for(a in this._parameters)if(b=a,W&&a&&0===a.indexOf(W))return k&&c.logInfo("Use locale ["+a+"] for connection ["+this.getId()+"]."),this._parameters[a];return null!==
b?(k&&c.logInfo("Use locale ["+b+"] for connection ["+this.getId()+"]."),this._parameters[b]):null}}function Db(a,b){this._id=a.id;this._dialogueId=a.dialogueId;this._name=a.name;this._position=a.position;this._parameters=b;this._defaultLocale=a.defaultLocale;this._interactionTypeId=a.interactionType.myId?a.interactionType.myId.toLowerCase():null;this._type=a.interactionType.myType?a.interactionType.myType.toUpperCase():null;this._positionType=a.interactionType.myPositionType?a.interactionType.myPositionType:
null;this._usedLocale=null;this._isOnLoadExecuted=this._isGetContentExecuted=this._isPositionFound=!1;this._isLocalEditMode=!0===a.isLocalEditMode;this._bcClient=null;this.getInteractionId=function(){return this._id};this.getDialogueId=function(){return this._dialogueId};this.getName=function(){return this._name};this.getType=function(){return this._type};this.getPosition=function(){return this._position};this.getDOMElement=function(){var a=c.getDOMElement(this._position);a&&!this._isPositionFound&&
(this._isPositionFound=!0);return a};this.isPositionFound=function(){return this._isPositionFound};this.isGetContentExecuted=function(){return this._isGetContentExecuted};this.setGetContentExecuted=function(a){this._isGetContentExecuted=a};this.isOnLoadExecuted=function(){return this._isOnLoadExecuted};this.setOnLoadExecuted=function(a){this._isOnLoadExecuted=a};this.setParameters=function(a,b){this._parameters[a]=b};this.getParameters=function(){var a,b=this.getName()?this.getName():this.getInteractionId();
for(a in this._parameters)if(W&&a&&0===a.indexOf(W))return this._usedLocale=a,k&&c.logInfo("use locale ["+a+"] for interaction ["+b+"]."),this._parameters[a];k&&c.logInfo("no parameters found for locale ["+W+"] with interaction ["+b+"].\x3cbr\x3eUsing the default locale ["+this._defaultLocale+"] instead.");this._usedLocale=this._defaultLocale;return this._parameters[this._defaultLocale]};this.getDefaultLocale=function(){return this._defaultLocale};this.getLocale=function(){return W};this.getUrlPrefix=
function(){c.logDeprecated("context.getUrlPrefix","profile.getBaseURL");return c.getBaseURL(this._interactionTypeId)};this.getBaseURL=function(){return c.getBaseURL(this._interactionTypeId)};this.getInteractionTypeId=function(){return this._interactionTypeId};this.isPositionTypePlugin=function(){return"position"===this._positionType};this.getProfile=function(){return this._bcClient.profile.getProfile()};this.isLocalEditMode=function(){return this._isLocalEditMode};this.getBlueConicClient=function(){this._bcClient||
(this._bcClient=A.getBlueConicClient(this));return this._bcClient};this.getConnection=function(a){if(!a||!X||!c.isArray(X)||0===X.length)return null;for(var b=0,d=X.length;b<d;b++){var g=X[b];if(g&&g.id&&g.parameters&&g.id===a)return b=c.getInteractionParameters(g),new Cb(a,b)}return null};this.getGoals=function(){return fa?fa[this._id]:null}}function pa(a){function b(a){a=c.ensureArray(a).join(",");J?a?localStorage.setItem("BCRefusedObjectives",a):localStorage.removeItem("BCRefusedObjectives"):c.setCookie("BCRefusedObjectives",
a,31536E6)}this._id=a;this._properties={};this.getId=function(){return this._id};this.getPropertyNames=function(){var a=[],b;for(b in this._properties)y.call(a,b);return a};this.getValue=function(a){if(!va.call(this._properties,a))return E;a=this._properties[a];return c.isArray(a)?a[0]:a};this.getValues=function(a){return va.call(this._properties,a)?c.ensureArray(this._properties[a]):[]};this.setValue=function(a,b,f){"consented_objectives"===a?(b=c.isArray(b)?0<b.length?[b[0]]:[]:[b],this.setConsentedObjectives(b,
f)):"refused_objectives"===a?(b=c.isArray(b)?0<b.length?[b[0]]:[]:[b],this.setRefusedObjectives(b,f)):this._setValue(a,b,f)};this._setValue=function(a,b,f){var d=this.profileIsPrivacyAware();a?null===b||b===E?k&&c.logInfo("value cannot be undefined or null"):(x.unsavedLog(a,null),c.isArray(b)?b=0<b.length?b[0]:null:c.isDate(b)&&(b=b.getTime()),x.unsavedLog(a,b,!1,d,f),this._properties[a]=c.ensureArray(b)):k&&c.logInfo("could not set value for undefined property")};this.setValues=function(a,b,c){"consented_objectives"===
a?this.setConsentedObjectives(b,c):"refused_objectives"===a?this.setRefusedObjectives(b,c):this._setValues(a,b,c)};this._setValues=function(a,b,f){var d=this.profileIsPrivacyAware();if(a)if(c.isArray(a))k&&c.logInfo("property cannot be an array");else{x.unsavedLog(a,null);b=c.ensureArray(b);for(var e=0;e<b.length;e++)c.isDate(b[e])&&(b[e]=b[e].getTime());c.removeItemFromArray(b,null);c.removeItemFromArray(b,E);this._properties[a]=b;x.unsavedLog(a,b,!1,d,f)}else k&&c.logInfo("could not set values for undefined property")};
this.addValue=function(a,b,c){"consented_objectives"===a?this.addConsentedObjective(b,c):"refused_objectives"===a?this.addRefusedObjective(b,c):this._addValue(a,b,c)};this._addValue=function(a,b,f){var d=this.profileIsPrivacyAware();if(a)if(c.isArray(a))k&&c.logInfo("property cannot be an array");else if(null===b||b===E)k&&c.logInfo("value cannot be undefined or null");else{c.isDate(b)&&(b=b.getTime());this._properties[a]||(this._properties[a]=[]);var e=this._properties[a];-1===c.indexOfArray(e,b)&&
(y.call(e,b),x.unsavedLog(a,b,!0,d,f));this._properties[a]=e}else k&&c.logInfo("could not add value for undefined property")};this.getPrivacyLegislation=function(){return this.getValue("privacy_legislation")};this.getConsentedObjectives=function(){return this.getValues("consented_objectives")};this.getRefusedObjectives=function(){return this._privacyAwareAndDoNotTrack()?this.getDntRefusedObjectives():this.getValues("refused_objectives")};this.setPrivacyLegislation=function(a,b){this.setValue("privacy_legislation",
a,b)};this.addConsentedObjective=function(a,b){var d=this.getConsentedObjectives();-1===c.indexOfArray(d,a)&&this._addValue("consented_objectives",a,b);var d=this.getRefusedObjectives(),e=d.length;c.removeItemFromArray(d,a);Ta&&e!==d.length&&this._setValues("refused_objectives",d,b);this._privacyAwareAndDoNotTrack()&&(this._setValues("refused_objectives",d,b),this.deleteDntRefusedObjectives(),k&&c.logInfo("Set permission level because of added consented objective: "+a),n.setLevel(n.PERSONAL,"Added consented objective: "+
a))};this.addRefusedObjective=function(a,e){if(this._privacyAwareAndDoNotTrack())e=this.getDntRefusedObjectives(),-1===c.indexOfArray(e,a)&&y.call(e,a),b(e);else{var d=this.getRefusedObjectives();-1===c.indexOfArray(d,a)&&this._addValue("refused_objectives",a,e);var d=this.getConsentedObjectives(),g=d.length;c.removeItemFromArray(d,a);Ta&&g!==d.length&&this._setValues("consented_objectives",d,e)}};this.setConsentedObjectives=function(a,b){this._setValues("consented_objectives",a,b);if(0!==a.length){for(var d=
this.getRefusedObjectives(),e=d.length,l=0;l<a.length;l++)c.removeItemFromArray(d,a[l]);e!==d.length&&this._setValues("refused_objectives",d,b);this._privacyAwareAndDoNotTrack()&&(this._setValues("refused_objectives",d,b),this.deleteDntRefusedObjectives(),k&&c.logInfo("Set permission level because of consented objectives: "+a),n.setLevel(n.PERSONAL,"Set consented objectives: "+a))}};this.setRefusedObjectives=function(a,e){if(this._privacyAwareAndDoNotTrack())b(a);else{this._setValues("refused_objectives",
a,e);for(var d=this.getConsentedObjectives(),g=d.length,l=0;l<a.length;l++)c.removeItemFromArray(d,a[l]);g!==d.length&&this._setValues("consented_objectives",d,e)}};this.loadValues=function(a,b,f){a=c.ensureArray(a);x.getProperties(a,this,function(){c.doCallback(b,f)});h.submitBatch()};this.addProperty=function(a,b){c.logDeprecated("profile.addProperty(property, value)","profile.addValue(property, value)");this.addValue(a,b)};this.getDntRefusedObjectives=function(){var a;return(a=J?localStorage.getItem("BCRefusedObjectives"):
c.getCookie("BCRefusedObjectives"))?c.ensureArray(a.split(",")):[]};this.deleteDntRefusedObjectives=function(){J?localStorage.removeItem("BCRefusedObjectives"):c.setCookie("BCRefusedObjectives",null)};this._privacyAwareAndDoNotTrack=function(){return this.hasSupportedLegislation()&&n.getLevel()===n.DO_NOT_TRACK};this.hasSupportedLegislation=function(){var a=this.getPrivacyLegislation();return 0<=c.indexOfArray(hb,a)};this.profileIsPrivacyAware=function(){return!this.getPrivacyLegislation()||this.hasSupportedLegislation()}}
function S(a){this.getId=function(){return q.getId()};this.getPropertyNames=function(){return q.getPropertyNames()};this.getValue=function(a){return q.getValue(a)};this.getValues=function(a){return q.getValues(a)};this.setValue=function(b,d){q.setValue(b,d,a)};this.setValues=function(b,d){q.setValues(b,d,a)};this.addValue=function(b,d){q.addValue(b,d,a)};this.getPrivacyLegislation=function(){return q.getPrivacyLegislation()};this.getConsentedObjectives=function(){return q.getConsentedObjectives()};
this.getRefusedObjectives=function(){return q.getRefusedObjectives()};this.setPrivacyLegislation=function(a,d){q.setPrivacyLegislation(a,d)};this.addConsentedObjective=function(b){q.addConsentedObjective(b,a)};this.addRefusedObjective=function(b){q.addRefusedObjective(b,a)};this.setConsentedObjectives=function(b){q.setConsentedObjectives(b,a)};this.setRefusedObjectives=function(b){q.setRefusedObjectives(b,a)};this.loadValues=function(a,d,c){q.loadValues(a,d,c)};this.addProperty=function(a,d){q.addProperty(a,
d)};this.isNew=function(){return Ua};this.getLifecycleStages=function(){return T}}function Eb(a){this._apiVersion=a&&a.recommendationBlock?2:1;if(1===this._apiVersion)this._id=a&&0<a.length?a[0].recommendationId[0]:null,this._items=a?a:[];else{this._id=a.recommendationId;this._setsOrder=[];this._groupedItems={};for(var b=v.util.array.ensureArray(a.recommendationBlock),d=0;d<b.length;d++)for(var c=v.util.array.ensureArray(b[d].recommendations),f=0;f<c.length;f++){var g=b[d].id;c[f].recommendationId=
this._id;c[f].setId=g;this._groupedItems[g]||(this._groupedItems[g]=[],this._setsOrder.push(g));this._groupedItems[g].push(c[f])}this._trackingPixel=a.trackingPixel}this.getId=function(){return this._id};this.getAPIVersion=function(){return this._apiVersion};this.getItems=function(){if(1===this.getAPIVersion())return this._items;for(var a=[],b=0;b<this._setsOrder.length;b++)a=a.concat(this._groupedItems[this._setsOrder[b]]);return a};this.getSetsOrder=function(){return this._setsOrder};this.getGroupedItems=
function(){return this._groupedItems};this.getTrackingPixelUrl=function(){return this._trackingPixel}}function Fb(a,b,d,c,f){this._id=a;this._html=b;this._css=d;this._javascript=c;this._precompiledTemplate=f;this.getId=function(){return this._id};this.getHtml=function(){return this._html};this.getCss=function(){return this._css};this.getJavaScript=function(){return this._javascript};this.getPrecompiled=function(){return this._precompiledTemplate}}function Gb(a,b,c){this._id=a;this._title=b;this._description=
c;this.getId=function(){return this._id};this.getTitle=function(){return this._title};this.getDescription=function(){return this._description}}function Hb(a){this._id=a;this.getId=function(){return this._id}}function Ib(a,b){this._id=a;this._name=b;this.getId=function(){return this._id};this.getName=function(){return this._name}}function Jb(a,b){this._id=a;this._name=b;this.getId=function(){return this._id};this.getName=function(){return this._name}}function Kb(a,b){this._lifecycle=a;this._stage=
b;this.getLifecycle=function(){return this._lifecycle};this.getStage=function(){return this._stage}}function Lb(){k&&c.logInfo("The browser has no JSON support; the json2 [http://www.JSON.org/js.html] is used for handling JSON");wa={};(function(a){function b(a){return 10>a?"0"+a:a}function c(a){g.lastIndex=0;return g.test(a)?'"'+a.replace(g,function(a){var b=m[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function e(a,b){var d,f,g=l,m,h=b[a];
h&&"object"===typeof h&&"function"===typeof h.bcToJSON&&(h=h.bcToJSON(a));"function"===typeof B&&(h=B.call(b,a,h));switch(typeof h){case "string":return c(h);case "number":return isFinite(h)?String(h):"null";case "boolean":case "null":return String(h);case "object":if(!h)return"null";l+=r;m=[];if("[object Array]"===Object.prototype.toString.apply(h)){f=h.length;for(a=0;a<f;a+=1)m[a]=e(a,h)||"null";b=0===m.length?"[]":l?"[\n"+l+m.join(",\n"+l)+"\n"+g+"]":"["+m.join(",")+"]";l=g;return b}if(B&&"object"===
typeof B)for(f=B.length,a=0;a<f;a+=1)"string"===typeof B[a]&&(d=B[a],(b=e(d,h))&&m.push(c(d)+(l?": ":":")+b));else for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&(b=e(d,h))&&m.push(c(d)+(l?": ":":")+b);b=0===m.length?"{}":l?"{\n"+l+m.join(",\n"+l)+"\n"+g+"}":"{"+m.join(",")+"}";l=g;return b}}"function"!==typeof Date.prototype.bcToJSON&&(Date.prototype.bcToJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+
":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null},String.prototype.bcToJSON=Number.prototype.bcToJSON=Boolean.prototype.bcToJSON=function(a){return this.valueOf()});var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,l,r,m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},
B;"function"!==typeof a.stringify&&(a.stringify=function(a,b,c){var d;r=l="";if("number"===typeof c)for(d=0;d<c;d+=1)r+=" ";else"string"===typeof c&&(r=c);if((B=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return e("",{"":a})});"function"!==typeof a.parse&&(a.parse=function(a,b){function c(a,d){var e,f,g=a[d];if(g&&"object"===typeof g)for(e in g)Object.prototype.hasOwnProperty.call(g,e)&&(f=c(g,e),f!==E?g[e]=f:delete g[e]);return b.call(a,
d,g)}a=String(a);f.lastIndex=0;f.test(a)&&(a=a.replace(f,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return a=eval("("+a+")"),"function"===typeof b?c({"":a},""):a;throw new SyntaxError("JSON.parse");})})(wa)}var Nb=O?O:"FORCE_POST";var BC_URL='https://web.archive.org/web/20211007044655/https://hearst.blueconic.net';var BC_HOSTNAME_MAP = {"1317436032":"l936.expressnews.com","512123520":"t810.ctpost.com","1988578944":"s232.theintelligencer.com","1267265408":"q777.sfchronicle.com","97355200":"f857.hearstmediatx.com","-2123396768":"u927.sfgate.com","-51189536":"y900.greenwichtime.com","-445508256":"z680.beaumontenterprise.com","-67879968":"t810.ctpost.com","408330304":"t810.ctpost.com","993794848":"u566.chron.com","-1778440736":"t810.ctpost.com","1361236224":"d810.mysanantonio.com","174296640":"z590.fairfieldcitizenonline.com","-282815744":"l936.expressnews.com","1183155872":"w740.newstimes.com","-1911783904":"y900.greenwichtime.com","-1257378528":"p593.seattlepi.com","338607104":"y820.darientimes.com","405745664":"z211.yourconroenews.com","-1905182144":"p593.seattlepi.com","26363296":"u566.chron.com","368354752":"r541.houstonchronicle.com","678807616":"u566.chron.com","1113332320":"f164.sheltonherald.com","1553772704":"j158.hearstmediact.com","-2005023680":"u927.sfgate.com","1902039392":"n730.timesunion.com","1111549440":"u566.chron.com","989910848":"z492.ctinsider.com","887243936":"q777.sfchronicle.com","-1977373088":"u927.sfgate.com","-182230688":"z680.beaumontenterprise.com","-456857472":"c993.westport-news.com","-1413091456":"w740.newstimes.com","-945351712":"n730.timesunion.com","-940894304":"o398.trumbulltimes.com","-80394400":"l936.expressnews.com","-1053375136":"w740.newstimes.com","51849024":"d810.mysanantonio.com","-937985984":"t810.ctpost.com","-1944517568":"d810.mysanantonio.com","463133632":"j198.registercitizen.com","-1956955392":"z680.beaumontenterprise.com","1918686720":"p593.seattlepi.com","-1583596096":"y900.greenwichtime.com","2122138144":"j198.registercitizen.com","-232821184":"y752.milfordmirror.com","-1314787904":"t810.ctpost.com","755194208":"r541.houstonchronicle.com","1665464096":"h559.stamfordadvocate.com","-1060829024":"j198.registercitizen.com","917271232":"w982.middletownpress.com","-1660041888":"u566.chron.com","1794228864":"h559.stamfordadvocate.com","1303574976":"r541.houstonchronicle.com","1569898976":"u927.sfgate.com","982784736":"l936.expressnews.com","1914008160":"x822.mrt.com","-1019920576":"w982.middletownpress.com","1106633088":"w740.newstimes.com","1580646976":"z590.fairfieldcitizenonline.com","741807168":"y820.darientimes.com","-409151520":"d810.mysanantonio.com","-1340098464":"n730.timesunion.com","-1920897792":"h559.stamfordadvocate.com","-1199074304":"x822.mrt.com","-295196960":"n730.timesunion.com","-1918359264":"z492.ctinsider.com","-2014824608":"w740.newstimes.com","-754338944":"w740.newstimes.com","1355432000":"u927.sfgate.com","-403863712":"n730.timesunion.com","684613696":"w020.newmilfordspectrum.com","103733920":"q777.sfchronicle.com","1009783968":"h559.stamfordadvocate.com","1676686176":"j158.hearstmediact.com","961723840":"n730.timesunion.com","-221101504":"t570.wiltonbulletin.com","-606908608":"z680.beaumontenterprise.com","1603507968":"f775.thehour.com","1439974720":"p593.seattlepi.com","395869952":"p593.seattlepi.com","-241569536":"r541.houstonchronicle.com","-1306773888":"n730.timesunion.com","1493374368":"d810.mysanantonio.com","2145729344":"q777.sfchronicle.com","623362432":"y738.nhregister.com","1644699296":"y820.darientimes.com","2018223328":"q777.sfchronicle.com","-2102571520":"u652.myplainview.com","-445802048":"q777.sfchronicle.com","1886537920":"u927.sfgate.com","1005840192":"l936.expressnews.com","643054304":"r541.houstonchronicle.com","611861696":"u927.sfgate.com","769303904":"z680.beaumontenterprise.com","-1176760992":"n730.timesunion.com","1656747520":"h559.stamfordadvocate.com","-1379839744":"w740.newstimes.com","597907296":"z680.beaumontenterprise.com","1772560736":"w740.newstimes.com","623482336":"t570.wiltonbulletin.com","1483332768":"r541.houstonchronicle.com","-1396008960":"z929.fuelfix.com","-1567874496":"z492.ctinsider.com","692879744":"j198.registercitizen.com","1730984928":"r541.houstonchronicle.com","529295168":"f164.sheltonherald.com","890068416":"j158.hearstmediact.com","-13827104":"p593.seattlepi.com","-2119269024":"n730.timesunion.com","397336416":"q777.sfchronicle.com","-1324426816":"n730.timesunion.com","-1898894848":"y738.nhregister.com","-692879776":"l936.expressnews.com","303413952":"y653.theridgefieldpress.com","-115949120":"o398.trumbulltimes.com","1064755104":"u927.sfgate.com","3650784":"o398.trumbulltimes.com","1507448064":"n730.timesunion.com","-365282592":"y900.greenwichtime.com","1742529280":"q777.sfchronicle.com","-2059556384":"y653.theridgefieldpress.com","1178575584":"j198.registercitizen.com","-320925696":"r541.houstonchronicle.com","-494984544":"n730.timesunion.com","-1574985024":"u566.chron.com","570500832":"j158.hearstmediact.com","-8038560":"d276.ourmidland.com","-802773824":"n730.timesunion.com","803778304":"j198.registercitizen.com","-309681824":"y752.milfordmirror.com","759888288":"w740.newstimes.com","494026112":"t810.ctpost.com","204846272":"d276.ourmidland.com","-1743355680":"y900.greenwichtime.com","-1917018816":"r541.houstonchronicle.com","1144876224":"d276.ourmidland.com","-639793888":"r541.houstonchronicle.com","-1887561856":"y752.milfordmirror.com","-1841184960":"l936.expressnews.com","-1062874720":"l936.expressnews.com","1938112128":"l936.expressnews.com","506053408":"l997.lmtonline.com","-1108632352":"t570.wiltonbulletin.com","-1766955104":"l936.expressnews.com","-506345280":"w982.middletownpress.com","-1483599232":"n730.timesunion.com","1339329216":"q777.sfchronicle.com","-1292598304":"z680.beaumontenterprise.com","-1229252704":"r541.houstonchronicle.com","6019392":"w020.newmilfordspectrum.com","1979505888":"d276.ourmidland.com","-1694728224":"u566.chron.com","-606242112":"q777.sfchronicle.com","629033056":"r541.houstonchronicle.com","1923229568":"z492.ctinsider.com","614631808":"q777.sfchronicle.com","843427680":"d810.mysanantonio.com","130526944":"u566.chron.com","-185941568":"z211.yourconroenews.com","976142080":"f164.sheltonherald.com","2018413920":"p593.seattlepi.com","1219484032":"w982.middletownpress.com","-1731170848":"w740.newstimes.com","51766816":"n730.timesunion.com","-1799967360":"p593.seattlepi.com","-2043161856":"l936.expressnews.com","-940021056":"z590.fairfieldcitizenonline.com","-606554400":"q777.sfchronicle.com","2031745056":"y653.theridgefieldpress.com","-44432288":"t810.ctpost.com","679415104":"f775.thehour.com","-1899967616":"u566.chron.com","-706582368":"l936.expressnews.com","-1448902432":"t810.ctpost.com","293821632":"h559.stamfordadvocate.com","1770550464":"l936.expressnews.com","-385276864":"q777.sfchronicle.com","-1846991712":"y820.darientimes.com","1716554496":"u927.sfgate.com","976605024":"j158.hearstmediact.com","676734208":"n730.timesunion.com","1087950208":"f775.thehour.com","1396345440":"n730.timesunion.com","-1801739840":"r541.houstonchronicle.com","-281235872":"z492.ctinsider.com","1537115840":"w740.newstimes.com","454985280":"u566.chron.com","1350739424":"w982.middletownpress.com","1870890720":"q777.sfchronicle.com","82084224":"u927.sfgate.com","-2082015616":"h353.ncadvertiser.com","1093511232":"x822.mrt.com","-407919936":"o398.trumbulltimes.com","-1389320128":"j158.hearstmediact.com","-122285632":"y738.nhregister.com","-172491584":"y752.milfordmirror.com","-1577541504":"q777.sfchronicle.com","-1063330336":"n730.timesunion.com","-404793696":"t810.ctpost.com","-1396767296":"p593.seattlepi.com","1971612672":"y900.greenwichtime.com","-1104685152":"l936.expressnews.com","-1383467008":"w740.newstimes.com","-133539456":"o398.trumbulltimes.com","2141993504":"n730.timesunion.com","-512989984":"f775.thehour.com","1043350432":"z211.yourconroenews.com","1781642144":"u927.sfgate.com","850531104":"w740.newstimes.com","1700033728":"n730.timesunion.com","701761600":"f164.sheltonherald.com","-910706656":"t810.ctpost.com","-1684575744":"f775.thehour.com","-669538944":"u566.chron.com","704059488":"l997.lmtonline.com","-426264832":"r541.houstonchronicle.com","-1785119744":"u927.sfgate.com","-157673728":"s232.theintelligencer.com","-960755936":"d810.mysanantonio.com","-1195466464":"x822.mrt.com","1096748224":"z211.yourconroenews.com","1027706080":"y653.theridgefieldpress.com","-297623584":"f775.thehour.com","-943319456":"o398.trumbulltimes.com","665327104":"x822.mrt.com","-1471596064":"d810.mysanantonio.com","-1498552576":"w740.newstimes.com","1089643840":"c993.westport-news.com","18176160":"l936.expressnews.com","-222914816":"w740.newstimes.com","47635296":"z590.fairfieldcitizenonline.com","1555538176":"n730.timesunion.com","-719858528":"y752.milfordmirror.com","981099456":"t810.ctpost.com","1144686976":"u927.sfgate.com","-46381952":"u927.sfgate.com","1734105824":"f775.thehour.com","220094624":"q777.sfchronicle.com","73367008":"p593.seattlepi.com","306255744":"d810.mysanantonio.com","52574944":"u566.chron.com","-1868260000":"w740.newstimes.com","769941536":"w982.middletownpress.com","998630976":"r541.houstonchronicle.com","1086731520":"t810.ctpost.com","-1404585600":"t810.ctpost.com","1915209696":"z680.beaumontenterprise.com","-28674176":"d810.mysanantonio.com","-1517567936":"y820.darientimes.com","2064624320":"n730.timesunion.com","-82783552":"d810.mysanantonio.com","-89054368":"p593.seattlepi.com","-697158752":"y738.nhregister.com","-1433243840":"j158.hearstmediact.com","-67825120":"n730.timesunion.com","-1927707456":"l936.expressnews.com","-1455777568":"j198.registercitizen.com","-298075168":"f164.sheltonherald.com","-1153757472":"u566.chron.com","-2143469088":"r541.houstonchronicle.com","-589445888":"n730.timesunion.com","-1905152":"u927.sfgate.com","-1304132704":"h353.ncadvertiser.com","-1964687616":"t570.wiltonbulletin.com","-1387911008":"h353.ncadvertiser.com","1686783328":"l936.expressnews.com","-274007488":"w740.newstimes.com","-1055972128":"u566.chron.com","1198668416":"n730.timesunion.com","716379968":"n730.timesunion.com","1960106272":"w982.middletownpress.com","1735827072":"y738.nhregister.com","2067199680":"d810.mysanantonio.com","-1611187712":"r541.houstonchronicle.com","-1955062144":"u927.sfgate.com","-501499936":"u927.sfgate.com","421376224":"l936.expressnews.com","-364991552":"n730.timesunion.com","1983839168":"u927.sfgate.com","1637991328":"q777.sfchronicle.com","-903570400":"q777.sfchronicle.com","-1853206656":"y752.milfordmirror.com","883575456":"s232.theintelligencer.com","1181601888":"z680.beaumontenterprise.com","-225525632":"q777.sfchronicle.com","-516945120":"t570.wiltonbulletin.com","1920065632":"l997.lmtonline.com","-983973056":"u927.sfgate.com","-937709056":"y653.theridgefieldpress.com","-1841261472":"d810.mysanantonio.com","-394143072":"n730.timesunion.com","-1646121024":"y738.nhregister.com","-178054336":"c993.westport-news.com","2116395008":"u566.chron.com","-498668448":"y820.darientimes.com","-2079852000":"x822.mrt.com","-2102894464":"u566.chron.com","-1624553216":"l936.expressnews.com","-2102614912":"u566.chron.com","126845344":"d276.ourmidland.com","590400768":"w020.newmilfordspectrum.com","1471347072":"q777.sfchronicle.com","-1101867936":"z680.beaumontenterprise.com","970185696":"n730.timesunion.com","-1971990464":"y820.darientimes.com","-665417120":"u927.sfgate.com","255461632":"d810.mysanantonio.com","138024448":"r541.houstonchronicle.com","1295762176":"n730.timesunion.com","1178466304":"t570.wiltonbulletin.com","-887210720":"f164.sheltonherald.com","-1646369824":"y738.nhregister.com","-1637767136":"w982.middletownpress.com","201560640":"f164.sheltonherald.com","-1584982080":"z680.beaumontenterprise.com","-1910010784":"n730.timesunion.com","-1737768416":"u927.sfgate.com","-756115296":"d810.mysanantonio.com","326234400":"t810.ctpost.com","1148339744":"u927.sfgate.com","447954144":"x822.mrt.com","-409654848":"u927.sfgate.com","-1267200480":"u566.chron.com","1069144544":"f775.thehour.com","-184702304":"u927.sfgate.com","429857728":"w740.newstimes.com","-199283136":"u566.chron.com","-1203774880":"u566.chron.com","501284736":"y900.greenwichtime.com","-1738399232":"z492.ctinsider.com","732153280":"u927.sfgate.com","-96149472":"p593.seattlepi.com","-209414688":"u566.chron.com","1789217984":"d810.mysanantonio.com","273014304":"x822.mrt.com","1422286496":"y738.nhregister.com","-410508832":"f775.thehour.com","1449838592":"f775.thehour.com","1827322496":"f775.thehour.com","109902048":"z211.yourconroenews.com","-643008576":"u566.chron.com","-315744448":"j198.registercitizen.com","542053920":"l997.lmtonline.com","1890885312":"z680.beaumontenterprise.com","-1537996256":"q777.sfchronicle.com","-822684544":"h559.stamfordadvocate.com","-858205536":"u566.chron.com","1484497408":"u927.sfgate.com","865941984":"c993.westport-news.com","-142504704":"l936.expressnews.com","1394866592":"u652.myplainview.com","1696907168":"o398.trumbulltimes.com","1363483584":"u566.chron.com","-1519990816":"p593.seattlepi.com","1093090208":"w740.newstimes.com","-580203552":"u566.chron.com","1846159488":"p593.seattlepi.com","-758432704":"u566.chron.com","703588192":"l997.lmtonline.com","-1083124256":"z590.fairfieldcitizenonline.com","-625885152":"u927.sfgate.com","2048373888":"h559.stamfordadvocate.com","-143071776":"u566.chron.com","-1761994656":"t810.ctpost.com","1975512864":"n730.timesunion.com","-392049152":"n730.timesunion.com","-228479808":"o398.trumbulltimes.com","-1377657024":"c993.westport-news.com","1525019712":"u927.sfgate.com","-1819938528":"l936.expressnews.com","-2040076096":"x822.mrt.com","900192000":"r541.houstonchronicle.com","-722980288":"t810.ctpost.com","1145736928":"l997.lmtonline.com","1165149120":"u927.sfgate.com","30815072":"t810.ctpost.com","-874976928":"q777.sfchronicle.com","-1952815840":"f164.sheltonherald.com","-417690208":"u927.sfgate.com","356363136":"r541.houstonchronicle.com","-656389600":"f775.thehour.com","742535808":"y738.nhregister.com","918905856":"y900.greenwichtime.com","31889184":"d810.mysanantonio.com","-383324192":"u566.chron.com","-1010348800":"d276.ourmidland.com","-1712766176":"u652.myplainview.com","-1028869024":"r541.houstonchronicle.com","-1364426656":"c993.westport-news.com","-435351360":"l997.lmtonline.com","-1569813344":"d276.ourmidland.com","-1248918720":"h559.stamfordadvocate.com","709868672":"p593.seattlepi.com","720431136":"u927.sfgate.com","594549152":"y752.milfordmirror.com","1664207328":"u652.myplainview.com","-1190056000":"t810.ctpost.com","2044117760":"z680.beaumontenterprise.com","-705050848":"z211.yourconroenews.com","-623091712":"r541.houstonchronicle.com","1188935680":"t810.ctpost.com","2082351808":"f775.thehour.com","362820416":"h559.stamfordadvocate.com","1640045344":"h559.stamfordadvocate.com","-859662816":"f857.hearstmediatx.com","-1767692224":"d810.mysanantonio.com","233117440":"u652.myplainview.com","1294390208":"n730.timesunion.com","791114176":"f775.thehour.com","2026505760":"z680.beaumontenterprise.com","-1270055264":"r541.houstonchronicle.com","59666784":"d810.mysanantonio.com","-634433344":"u566.chron.com","-284143136":"h559.stamfordadvocate.com","1580425408":"p593.seattlepi.com","1014326912":"r541.houstonchronicle.com","1947712224":"u652.myplainview.com","693639072":"t810.ctpost.com","-795194784":"h559.stamfordadvocate.com","-1728418304":"t810.ctpost.com","-2093110848":"f775.thehour.com","280848960":"l936.expressnews.com","-2115966240":"u652.myplainview.com","-1738300576":"r541.houstonchronicle.com","-1427901984":"z680.beaumontenterprise.com","-1488596928":"n730.timesunion.com","2126893504":"w020.newmilfordspectrum.com","201665280":"d810.mysanantonio.com","1265133664":"t810.ctpost.com","-1708517088":"z590.fairfieldcitizenonline.com","-896542336":"j198.registercitizen.com","16359392":"c993.westport-news.com","-493170304":"z211.yourconroenews.com","2090666880":"z680.beaumontenterprise.com","-2048974144":"y900.greenwichtime.com","-520046048":"q777.sfchronicle.com","518121920":"u566.chron.com","-1864218688":"l936.expressnews.com","-1394436160":"f775.thehour.com","985968096":"t810.ctpost.com","1053238752":"n730.timesunion.com","1569223328":"h559.stamfordadvocate.com","1001168000":"n730.timesunion.com","-521329728":"r541.houstonchronicle.com","1018328960":"p593.seattlepi.com","1991396736":"y900.greenwichtime.com","-378314176":"n730.timesunion.com","-889747008":"q777.sfchronicle.com","123262048":"p593.seattlepi.com","1539099776":"u566.chron.com","1704994528":"n730.timesunion.com","643929376":"p593.seattlepi.com","520285248":"t810.ctpost.com","-689721952":"h559.stamfordadvocate.com","-1245279616":"f775.thehour.com","-867669248":"n730.timesunion.com","-827837984":"z680.beaumontenterprise.com","-85339744":"n730.timesunion.com","-1549163296":"r541.houstonchronicle.com","-326442048":"u566.chron.com","411759552":"u566.chron.com","791422048":"r541.houstonchronicle.com","883902432":"h353.ncadvertiser.com","2115353920":"l936.expressnews.com","-1661550688":"d810.mysanantonio.com","2128134528":"l936.expressnews.com","-1675972800":"n730.timesunion.com","-990087264":"l936.expressnews.com","-1606630560":"q777.sfchronicle.com","-484630464":"h353.ncadvertiser.com","-1358963296":"n730.timesunion.com","1048535328":"s232.theintelligencer.com","2061548928":"u566.chron.com","958481984":"t570.wiltonbulletin.com","-819879872":"u927.sfgate.com","316838272":"l936.expressnews.com","-943479648":"t810.ctpost.com","1392845920":"t810.ctpost.com","-882294784":"j158.hearstmediact.com","-557172320":"l997.lmtonline.com","2110513824":"n730.timesunion.com","193741024":"t810.ctpost.com","458128416":"t810.ctpost.com","-1903245856":"z492.ctinsider.com","1508843136":"r541.houstonchronicle.com","-2066492512":"q777.sfchronicle.com","2016728896":"r541.houstonchronicle.com","708211008":"y900.greenwichtime.com","-1271480512":"s232.theintelligencer.com","1224158080":"q777.sfchronicle.com","354078304":"q777.sfchronicle.com","-639841632":"z211.yourconroenews.com","1434191360":"r541.houstonchronicle.com","-1547849536":"u652.myplainview.com","-469776256":"l936.expressnews.com","-276597760":"z680.beaumontenterprise.com","533220416":"y653.theridgefieldpress.com","1315604960":"u566.chron.com","1391123808":"u927.sfgate.com","-2077504608":"q777.sfchronicle.com","133016672":"q777.sfchronicle.com","1622002464":"l936.expressnews.com","483203904":"u652.myplainview.com","-584062304":"y752.milfordmirror.com","1936911584":"y900.greenwichtime.com","-1829503648":"z680.beaumontenterprise.com","1112981952":"n730.timesunion.com","-1147639808":"f775.thehour.com","502828640":"h559.stamfordadvocate.com","-1407488128":"w982.middletownpress.com","1652373984":"y738.nhregister.com","-1530956000":"f857.hearstmediatx.com","1889493760":"n730.timesunion.com","-1400872160":"t810.ctpost.com","-1335784512":"t810.ctpost.com","2122520864":"f775.thehour.com","899991040":"l997.lmtonline.com","1778836896":"l936.expressnews.com","2085061600":"d810.mysanantonio.com","-1953928160":"u927.sfgate.com","898283040":"h353.ncadvertiser.com","9085728":"r541.houstonchronicle.com","648978688":"x822.mrt.com","-298836608":"u927.sfgate.com","-1664001184":"z590.fairfieldcitizenonline.com","301066816":"f857.hearstmediatx.com","-1024083648":"z680.beaumontenterprise.com","1538656256":"t810.ctpost.com","-2053624288":"t810.ctpost.com","1100617248":"y653.theridgefieldpress.com","-1027963648":"z492.ctinsider.com","1570685472":"r541.houstonchronicle.com","570455488":"q777.sfchronicle.com","-446485856":"y900.greenwichtime.com","1487245152":"d810.mysanantonio.com","-1574571552":"q777.sfchronicle.com","1499967136":"w740.newstimes.com","1172888096":"u927.sfgate.com","-381051264":"p593.seattlepi.com","-632733312":"d276.ourmidland.com","-2010476576":"y820.darientimes.com","-1060344064":"n730.timesunion.com","225249952":"q777.sfchronicle.com","2083333088":"d810.mysanantonio.com","-359682752":"p593.seattlepi.com","-122679456":"f775.thehour.com","-1638861440":"l936.expressnews.com","2081625024":"r541.houstonchronicle.com","492304000":"u927.sfgate.com","-2003301568":"t810.ctpost.com","999920704":"f775.thehour.com","1618594720":"n730.timesunion.com","266027008":"n730.timesunion.com","-1942139936":"r541.houstonchronicle.com","547321664":"h353.ncadvertiser.com","1713317312":"y653.theridgefieldpress.com","-127674496":"h353.ncadvertiser.com","1594125536":"z492.ctinsider.com","1355237152":"u566.chron.com","-196441184":"u927.sfgate.com","1410165728":"d810.mysanantonio.com","-1156516640":"u927.sfgate.com","-1701755552":"d810.mysanantonio.com","-1298993824":"t570.wiltonbulletin.com","2000013504":"q777.sfchronicle.com","718604576":"z680.beaumontenterprise.com","-541520832":"w740.newstimes.com","1356532512":"l936.expressnews.com"};
var xa=document.createElement("a");xa.href=BC_URL;Q=-1===xa.href.substring(xa.protocol.length).indexOf(":")?xa.hostname:xa.host;var I=!1;if(p.name&&0==p.name.indexOf("bc_")||top.window!=p||document.cookie&&-1!=document.cookie.indexOf("BC_e\x3dtrue"))if(p.top!=p||p.opener){I=!0;try{top.location.host!=document.location.host||p.opener||(I=!1)}catch(a){I=!0}}if(!p.blueConicClient||-1==BC_URL.indexOf(Q)){var ib=function(){if(I)return BC_URL;var a="undefined"!=typeof Q?"https://"+Q:null;a&&-1!=BC_URL.indexOf(Q.split(":")[0].replace("http://",
""))||(a=BC_URL);if(!a)a:{var b;b=document.getElementsByTagName("script");for(var c=0,e=b.length;c<e;c++)if(a=b[c],(a=a.getAttribute("src"))&&-1!==a.indexOf("/blueconic/blueconic")){b=document.createElement("a");b.href=a;a="https://"+b.host;break a}a=void 0}return a},jb=ib(),M="undefined"!=typeof ta&&ta?ta:null,kb=function(){var a=p.navigator.userLanguage||navigator.systemLanguage||p.navigator.language;if(!a)return null;var b=-1!==a.indexOf("-")?a.indexOf("-"):a.indexOf("_");-1!=b&&(a=a.substring(0,
b));return a=a.toLowerCase()},W=kb.call(this),Ob=(new Date).getTime(),k="undefined"!=typeof fb&&fb,ga="undefined"!=typeof console&&console&&console.log,ha=!1,lb=!1,Va=!1,ca=[],Pb=["LISTENER","TOOLBAR"],ya=!1,za=!1,Aa=!1,Wa=null,hb=[],Xa=null,Ba;Ba=p.navigator&&p.navigator.userAgent?navigator.userAgent.toLowerCase():"unknown";var Qb=function(){try{var a;document.createEvent?(a=document.createEvent("Event"),a.initEvent("onBlueConicEventCheck",!0,!0),p.dispatchEvent(a)):(a=document.createEventObject(),
p.fireEvent("onBlueConicEventCheck",a));return!0}catch(b){return!1}}(),Rb=function(){if("undefined"!=typeof XMLHttpRequest&&XMLHttpRequest){if("withCredentials"in new XMLHttpRequest)return k&&ga&&console.log("CORS is fully supported. Chrome/Firefox/Opera/Safari/IE10+"),!0;if("undefined"!=typeof XDomainRequest)return k&&ga&&console.log("CORS is not fully supported in IE8/9, fallback to old GET mechanism."),!1}k&&ga&&console.log("CORS is not supported.");return!1}(),J;try{localStorage.setItem("bc_local_storage_check",
"bc_local_storage_check"),localStorage.removeItem("bc_local_storage_check"),J=!0}catch(a){J=!1}var Ca=!0,Ya=null,K=!0,mb=!1,ia=function(){if(p.navigator&&p.navigator.vendor&&-1!==p.navigator.vendor.toLowerCase().indexOf("apple")||-1!==Ba.indexOf("safari/"))K=!1;return-1!==Ba.indexOf("firefox")?(-1!==Ba.indexOf("gecko/")&&(K=!1),7168):-1!==Ba.indexOf("chrome")?(K=!0,7168):3072}();U!==E&&(K=K?U:!1,k&&ga&&console.log("Cookie sync is toggled by configuration: "+K));var wa=null,nb=Object.prototype.toString,
va=Object.prototype.hasOwnProperty,y=Array.prototype.push,Sb=Array.prototype.unshift,ob=Array.prototype.indexOf,Tb=Array.prototype.isArray,Ub=Array.prototype.filter,Vb=Array.prototype.map,Da=null,Ea=null,pb=!1,Ia;try{Da=document.cookie,Ia=!0}catch(a){Ia=!1}for(var qb=null,rb=null,Za=null,P=[],ja=[],T=[],fa=null,X=[],Y=null,q=null,Ua=!1,Ja=null,Ma=null,Na=null,da=[],$a={},ab={},Oa={},Fa={},sb={},bb="bc_pre_"+(new Date).getTime(),tb="bc_post_"+(new Date).getTime(),Pa="bc_async_"+(new Date).getTime(),
ka=gb?gb:[],Ta=!1,ub=["bc_simulator","bc_dialogues","bc_visualpicker"],vb="ArrayBuffer Attr Audio AudioProcessingEvent BCClass BeforeLoadEvent Blob CDATASection CSSCharsetRule CSSFontFaceRule CSSImportRule CSSMediaRule CSSPageRule CSSPrimitiveValue CSSRule CSSRuleList CSSStyleDeclaration CSSStyleRule CSSStyleSheet CSSValue CSSValueList CanvasGradient CanvasPattern CanvasRenderingContext2D CharacterData ClientRect ClientRectList Clipboard CloseEvent Comment CompositionEvent Counter CustomEvent DOMException DOMImplementation DOMParser DOMSettableTokenList DOMStringList DOMStringMap DOMTokenList DataView DeviceOrientationEvent Document DocumentFragment DocumentType Element Entity EntityReference ErrorEvent Event EventException EventSource File FileError FileList FileReader Float32Array Float64Array FormData HTMLAllCollection HTMLAnchorElement HTMLAppletElement HTMLAreaElement HTMLAudioElement HTMLBRElement HTMLBaseElement HTMLBaseFontElement HTMLBodyElement HTMLButtonElement HTMLCanvasElement HTMLCollection HTMLDListElement HTMLDirectoryElement HTMLDivElement HTMLDocument HTMLElement HTMLEmbedElement HTMLFieldSetElement HTMLFontElement HTMLFormElement HTMLFrameElement HTMLFrameSetElement HTMLHRElement HTMLHeadElement HTMLHeadingElement HTMLHtmlElement HTMLIFrameElement HTMLImageElement HTMLInputElement HTMLKeygenElement HTMLLIElement HTMLLabelElement HTMLLegendElement HTMLLinkElement HTMLMapElement HTMLMarqueeElement HTMLMediaElement HTMLMenuElement HTMLMetaElement HTMLMeterElement HTMLModElement HTMLOListElement HTMLObjectElement HTMLOptGroupElement HTMLOptionElement HTMLOutputElement HTMLParagraphElement HTMLParamElement HTMLPreElement HTMLProgressElement HTMLQuoteElement HTMLScriptElement HTMLSelectElement HTMLSourceElement HTMLSpanElement HTMLStyleElement HTMLTableCaptionElement HTMLTableCellElement HTMLTableColElement HTMLTableElement HTMLTableRowElement HTMLTableSectionElement HTMLTextAreaElement HTMLTitleElement HTMLUListElement HTMLUnknownElement HTMLVideoElement HashChangeEvent IceCandidate Image ImageData Int16Array Int32Array Int8Array KeyboardEvent MediaController MediaError MediaList MediaStreamEvent MessageChannel MessageEvent MessagePort MimeType MimeTypeArray MouseEvent MutationEvent NamedNodeMap Node NodeFilter NodeList Notation OfflineAudioCompletionEvent Option OverflowEvent PERSISTENT PageTransitionEvent Plugin PluginArray PopStateEvent ProcessingInstruction ProgressEvent RGBColor Range RangeException Rect SQLException SVGAElement SVGAltGlyphDefElement SVGAltGlyphElement SVGAltGlyphItemElement SVGAngle SVGAnimateColorElement SVGAnimateElement SVGAnimateMotionElement SVGAnimateTransformElement SVGAnimatedAngle SVGAnimatedBoolean SVGAnimatedEnumeration SVGAnimatedInteger SVGAnimatedLength SVGAnimatedLengthList SVGAnimatedNumber SVGAnimatedNumberList SVGAnimatedPreserveAspectRatio SVGAnimatedRect SVGAnimatedString SVGAnimatedTransformList SVGCircleElement SVGClipPathElement SVGColor SVGComponentTransferFunctionElement SVGCursorElement SVGDefsElement SVGDescElement SVGDocument SVGElement SVGElementInstance SVGElementInstanceList SVGEllipseElement SVGException SVGFEBlendElement SVGFEColorMatrixElement SVGFEComponentTransferElement SVGFECompositeElement SVGFEConvolveMatrixElement SVGFEDiffuseLightingElement SVGFEDisplacementMapElement SVGFEDistantLightElement SVGFEDropShadowElement SVGFEFloodElement SVGFEFuncAElement SVGFEFuncBElement SVGFEFuncGElement SVGFEFuncRElement SVGFEGaussianBlurElement SVGFEImageElement SVGFEMergeElement SVGFEMergeNodeElement SVGFEMorphologyElement SVGFEOffsetElement SVGFEPointLightElement SVGFESpecularLightingElement SVGFESpotLightElement SVGFETileElement SVGFETurbulenceElement SVGFilterElement SVGFontElement SVGFontFaceElement SVGFontFaceFormatElement SVGFontFaceNameElement SVGFontFaceSrcElement SVGFontFaceUriElement SVGForeignObjectElement SVGGElement SVGGlyphElement SVGGlyphRefElement SVGGradientElement SVGHKernElement SVGImageElement SVGLength SVGLengthList SVGLineElement SVGLinearGradientElement SVGMPathElement SVGMarkerElement SVGMaskElement SVGMatrix SVGMetadataElement SVGMissingGlyphElement SVGNumber SVGNumberList SVGPaint SVGPathElement SVGPathSeg SVGPathSegArcAbs SVGPathSegArcRel SVGPathSegClosePath SVGPathSegCurvetoCubicAbs SVGPathSegCurvetoCubicRel SVGPathSegCurvetoCubicSmoothAbs SVGPathSegCurvetoCubicSmoothRel SVGPathSegCurvetoQuadraticAbs SVGPathSegCurvetoQuadraticRel SVGPathSegCurvetoQuadraticSmoothAbs SVGPathSegCurvetoQuadraticSmoothRel SVGPathSegLinetoAbs SVGPathSegLinetoHorizontalAbs SVGPathSegLinetoHorizontalRel SVGPathSegLinetoRel SVGPathSegLinetoVerticalAbs SVGPathSegLinetoVerticalRel SVGPathSegList SVGPathSegMovetoAbs SVGPathSegMovetoRel SVGPatternElement SVGPoint SVGPointList SVGPolygonElement SVGPolylineElement SVGPreserveAspectRatio SVGRadialGradientElement SVGRect SVGRectElement SVGRenderingIntent SVGSVGElement SVGScriptElement SVGSetElement SVGStopElement SVGStringList SVGStyleElement SVGSwitchElement SVGSymbolElement SVGTRefElement SVGTSpanElement SVGTextContentElement SVGTextElement SVGTextPathElement SVGTextPositioningElement SVGTitleElement SVGTransform SVGTransformList SVGUnitTypes SVGUseElement SVGVKernElement SVGViewElement SVGZoomEvent Selection SessionDescription SharedWorker SpeechInputEvent Storage StorageEvent StyleSheet StyleSheetList TEMPORARY Text TextEvent TextMetrics TimeRanges TouchEvent UIEvent URL Uint16Array Uint32Array Uint8Array Uint8ClampedArray WebGLActiveInfo WebGLBuffer WebGLContextEvent WebGLFramebuffer WebGLProgram WebGLRenderbuffer WebGLRenderingContext WebGLShader WebGLTexture WebGLUniformLocation WebKitAnimationEvent WebKitBlobBuilder WebKitCSSFilterValue WebKitCSSKeyframeRule WebKitCSSKeyframesRule WebKitCSSMatrix WebKitCSSRegionRule WebKitCSSTransformValue WebKitIntent WebKitMutationObserver WebKitPoint WebKitTransitionEvent WebSocket WheelEvent Window Worker XMLDocument XMLHttpRequest XMLHttpRequestException XMLHttpRequestProgressEvent XMLHttpRequestUpload XMLSerializer XPathEvaluator XPathException XPathResult XSLTProcessor addEventListener alert applicationCache atob bcHostname bcVerbose blueConicClient blueConicPreListeners blur btoa caches cancelAnimationFrame cancelIdleCallback captureEvents chrome clearInterval clearTimeout clientInformation close closed confirm console content controllers createImageBitmap crypto customElements defaultStatus defaultstatus devicePixelRatio disableExternalCapture dispatchEvent document enableExternalCapture event external fetch find focus forward frameElement frames fullScreen getComputedStyle getMatchedCSSRules getSelection globalStorage history home indexedDB innerHeight innerWidth isSecureContext length localStorage location locationbar matchMedia menubar moveBy moveTo mozAnimationStartTime mozCancelAnimationFrame mozCancelRequestAnimationFrame mozIndexedDB mozInnerScreenX mozInnerScreenY mozPaintCount mozRequestAnimationFrame myVar name navigator offscreenBuffering onabort onafterprint onafterscriptexecute onanimationend onanimationiteration onanimationstart onappinstalled onauxclick onbeforeinstallprompt onbeforeprint onbeforescriptexecute onbeforeunload onblur oncancel oncanplay oncanplaythrough onchange onclick onclose oncontextmenu oncopy oncuechange oncut ondblclick ondevicemotion ondeviceorientation ondeviceorientationabsolute ondrag ondragend ondragenter ondragleave ondragover ondragstart ondrop ondurationchange onemptied onended onerror onfocus ongotpointercapture onhashchange oninput oninvalid onkeydown onkeypress onkeyup onlanguagechange onload onloadeddata onloadedmetadata onloadstart onlostpointercapture onmessage onmessageerror onmousedown onmouseenter onmouseleave onmousemove onmouseout onmouseover onmouseup onmousewheel onmozfullscreenchange onmozfullscreenerror onoffline ononline onpagehide onpageshow onpaste onpause onplay onplaying onpointercancel onpointerdown onpointerenter onpointerleave onpointermove onpointerout onpointerover onpointerup onpopstate onprogress onratechange onrejectionhandled onreset onresize onscroll onsearch onseeked onseeking onselect onshow onstalled onstorage onsubmit onsuspend ontimeupdate ontoggle ontouchcancel ontouchend ontouchmove ontouchstart ontransitionend onunhandledrejection onunload onvolumechange onwaiting onwebkitanimationend onwebkitanimationiteration onwebkitanimationstart onwebkittransitionend onwheel open openDatabase openDialog opener origin outerHeight outerWidth pageXOffset pageYOffset parent performance personalbar pkcs11 postMessage print prompt releaseEvents removeEventListener requestAnimationFrame requestIdleCallback resizeBy resizeTo routeEvent screen screenLeft screenTop screenX screenY scroll scrollBy scrollByLines scrollByPages scrollMaxX scrollMaxY scrollTo scrollX scrollY scrollbars self sessionStorage setInterval setResizable setTimeout showModalDialog sizeToContent speechSynthesis status statusbar stop styleMedia toolbar top updateCommands v8Locale visualViewport webkitAudioContext webkitAudioPannerNode webkitCancelAnimationFrame webkitCancelRequestAnimationFrame webkitConvertPointFromNodeToPage webkitConvertPointFromPageToNode webkitIDBCursor webkitIDBDatabase webkitIDBDatabaseError webkitIDBDatabaseException webkitIDBFactory webkitIDBIndex webkitIDBKeyRange webkitIDBObjectStore webkitIDBRequest webkitIDBTransaction webkitIndexedDB webkitNotifications webkitPostMessage webkitRequestAnimationFrame webkitRequestFileSystem webkitResolveLocalFileSystemURL webkitStorageInfo webkitURL window".split(" "),
qa={},cb=0;cb<vb.length;cb++)qa[vb[cb]]=null;var db=["$"],ra,t=function(){if(!jb)return k&&c.logInfo("blueconic stopped running because the hostname is not defined"),null};t.prototype.createEvent=function(a,b,d,e,f){var g=-1<c.indexOfArray(u.dynamicTypes,a),l=-1<c.indexOfArray(u.types,a),r=!0===b,m=null!==b&&"object"===typeof b;r&&(za=!0);if(l||g)if(l&&"PAGEVIEW"!=a&&!b)c.logWarning("An interaction is required for event type ["+a+"]");else{"PAGEVIEW"!==a||r||x.getProfile();"PAGEVIEW"!==a||ya&&!r||
(ka&&0<ka.length&&x.updateProfile(),r||h.handleRevisions());var l={type:a,referrer:document.referrer,profile:null!==q?q.getId():c.getBcSessionId()},B;for(B in f)f.hasOwnProperty(B)&&(l[B]=f[B]);m?(f=eb.getParams(a,{timestamp:new Date,data:b,profile:l.profile,referrer:l.referrer},d),l.timelineContext=f.data,l.timestamp=f.timestamp,l.eventSource=f.eventSource):l.interaction=b;u.create(l,this,function(f){"VIEW"===a&&f&&Qa(f,!1);g&&Qa(f,!1);c.doCallback(d,e,f);u.publish(a,b)});"VIEW"===a?h.submitBatchTimeout(200,
"VIEW"):g?h.submitBatchTimeout(0,"DYNAMIC"):h.submitBatch()}else u.publish(a,b)};t.prototype.setEditableNode=function(a,b){this.functions.setEditableNode(a,b)};t.prototype.getHostname=function(){return Q};t.prototype.getIPAddress=function(){return rb};t.prototype.getInteractions=function(){return P};t.prototype.getInteractionNamesById=function(a){var b=null;if(P&&0<P.length)for(var c=0;c<P.length;c++)P[c].id===a&&(b=P[c]);return b};t.prototype.getSegments=function(){return ja};t.prototype.getTemplate=
function(a,b){if(a){t.prototype._templateCallbacks||(t.prototype._templateCallbacks={});var d=(new Date).getTime()+Math.random();t.prototype._templateCallbacks[d]&&(d=(new Date).getTime()+Math.random());t.prototype._templateCallbacks[d]={onSuccess:b,templateId:a};var e=function(){for(var a=c.getPropertiesFromObject(t.prototype._templateCallbacks),b=0;b<a.length;b++){var d=t.prototype._templateCallbacks[a[b]];if(d){delete t.prototype._templateCallbacks[a[b]];var e=sb[d.templateId];if(!e){c.logWarning("Template with ID ["+
d.templateId+"] is not found.");break}c.doCallback(this,d.onSuccess,e)}}};t.prototype.isInEditMode()&&!t.prototype._isTemplateDownloading&&(Aa=!1,Na=null,k&&c.logInfo("download templates again for edit mode"));Aa||t.prototype._isTemplateDownloading?t.prototype._isTemplateDownloading||e():(t.prototype._isTemplateDownloading=!0,a=(I?BC_URL:V())+"/templates",c.loadScript(Na?a+"/"+Na:a,this,function(){delete t.prototype._isTemplateDownloading;k&&c.logInfo("finished template download");e()}))}else c.logWarning("A templateID is required for loading a template")};
t.prototype.getChannelId=function(){return qb};t.prototype.isInEditMode=function(){return p.name&&"bc_dialogues"===p.name.substring(0,12)||p.bcEditModeInstanceName&&-1<p.bcEditModeInstanceName.indexOf("bc_dialogues")?!0:!1};t.prototype.setHostname=function(a){c.logDeprecated("blueConicClient.setHostName","Use setChannelIdentifier instead.");M=a};t.prototype.setChannelIdentifier=function(a){M=a};t.prototype.getStaticUrlPrefix=function(a){c.logDeprecated("blueConicClient.getStaticUrlPrefix","Use getBaseURL instead");
return c.getBaseURL(a)};t.prototype.getBaseURL=function(a){return c.getBaseURL(a)};t.prototype.getRestEndpoint=function(a){var b=V()+"/rest/custom/frontend/",d=c.getZoneId();d&&(b+=d+"/");a&&(b+=a);return b};t.prototype.isInSimulatorMode=function(){return p.name&&-1<p.name.indexOf("bc_simulator")};t.prototype.getCurrentDate=function(){return t.prototype.isInSimulatorMode()&&Wa?Wa:new Date};t.prototype.doNotShowAgain=function(a,b,c){if(a&&!this.isInEditMode()){var d=this.profile.getProfile();d&&(d.addValue("dialogues_do_not_show_again",
a),this.profile.updateProfile(b,c))}};t.prototype.getProfileProperties=function(a,b){var d=(new Date).getTime()+ ++h.requestId;h.addBatchRequest(h.GET_PROFILE_PROPERTIES,null,d,this,function(d){var e={};if(d&&d.result){d=d.result;if(d.properties){var e=d.properties,g;for(g in e)e[g].permissionLevel&&(e[g].permissionLevel=n[e[g].permissionLevel])}c.doCallback(a,b,e)}});h.submitBatch()};t.prototype.handlePageView=function(a){Xa&&clearTimeout(Xa);Xa=setTimeout(function(){k&&c.logInfo("handling asynchronous navigation for new url ["+
document.location.href+"], creating new PAGEVIEW event to retrieve interactions for this url.");h.resetThrottlingCounter(!0);a&&!0===a.hidePositions&&A.hideAllPositions();var b=document.getElementById(Pa);b&&b.parentNode.removeChild(b);v._pendingInteractions=[];A.checkPreListeners();Ua=!1;v.createEvent("PAGEVIEW",!0,this,function(a){u.publish(u.ON_URL_CHANGE,{url:document.location.href});Qa(a,!1)})},10)};t.prototype.mail={sendEmail:function(a,b,d,e){var f=v._handledInteractions;if(f){for(var g=null,
l=0,r=f.length;l<r&&!g;l++)f[l]&&f[l].context&&f[l].context.getInteractionId()===a&&(g=f[l].context);g&&(locale=g._usedLocale,f=(new Date).getTime()+ ++h.requestId,a={interactionId:[a],onlyOnce:[b],langId:[locale]},x.updateProfile(),h.addBatchRequest(h.SEND_MAIL,a,f,this,function(a){a&&c.doCallback(d,e,a)}),h.submitBatch())}}};t.prototype.util={loadScript:function(a,b,d){c.loadScript(a,b,d)},loadJSON:function(a,b,d){h.JSONP.get(a,null,function(a){c.doCallback(b,d,a)})},loadCSS:function(a){c.loadCSS(a)},
load:function(a,b,d,e,f){c.logDeprecated("blueConicClient.util.load (libname, libversion, liboptions, caller, onSuccess)","blueConicClient.util.loadScript (url, caller, onSuccess)");"function"!=typeof f?c.logError('blueConicClient.util.load "onSuccess" is not a function'):c.loadScript(a,e,f)},loadLabels:function(a,b){c.logDeprecated("blueConicClient.util.loadLabels(caller, onSuccess)","blueConicClient.getProfileProperties(caller, onSuccess)");var d=(new Date).getTime()+ ++h.requestId;h.addBatchRequest(h.GET_PROPERTY_LABELS,
null,d,this,function(d){var e={};if(d&&d.result){d=d.result;if(d.properties)for(var g in d.properties){e[g]={};var l=d.properties[g],r;for(r in l)e[g][r]=l[r]}c.doCallback(a,b,e)}});h.submitBatch()},log:function(a){c.log(a)}};t.prototype.util.cookie={setCookie:function(a,b,d){return c.setCookie(a,b,d)},getCookie:function(a){return c.getCookie(a)}};t.prototype.util.array={ensureArray:function(a){return c.ensureArray(a)},isArray:function(a){return c.isArray(a)},diffArrays:function(a,b){return c.diffArrays(a,
b)},removeItemFromArray:function(a,b){c.removeItemFromArray(a,b)},indexOfArray:function(a,b){return c.indexOfArray(a,b)},mergeArrays:function(a,b){c.mergeArrays(a,b)}};var wb=function(a){return{updateProfile:function(a,d){var b=a,f=d;"function"==typeof a&&(c.logDeprecated("blueConicClient.profile.updateProfile (onSuccess, caller)","blueConicClient.profile.updateProfile (caller, onSuccess)"),f=a,b=d);x.updateProfile(b,f);h.submitBatch()},createProfile:function(a,c){x.createProfile(a,c);h.submitBatch()},
deleteProfile:function(a,d){var b=a,f=d;"function"==typeof a&&(c.logDeprecated("blueConicClient.profile.deleteProfile (onSuccess, caller)","blueConicClient.profile.deleteProfile (caller, onSuccess)"),f=a,b=d);x.deleteProfile(b,f);h.submitBatch()},getProfile:function(){return q?new S(a):null}}};t.prototype.functions={setLocaleFunction:function(a){a&&"function"==typeof a?(W=a.call(null),k&&c.logInfo("runned locale function, the locale is now ["+W+"]")):W=kb.call(this)},setEditableNode:function(a,b){if(v.fn.postMessage&&
v.fn.getSelectorForElement){var c=null;"string"==typeof a?c=a:null!=a&&(c=v.fn.getSelectorForElement(a));v.fn.postMessage("editableNodeUpdate",{selector:c,options:b})}},sendMessage:function(a){v.fn.postMessage&&v.fn.postMessage("onInteractionMessage",a)}};t.prototype.json={parse:function(a){try{return c.checkNativeJsonLib(),Ca?p.JSON.parse(a):wa.parse(a)}catch(b){return c.logError("Could not parse json ["+b.message+"]"),null}},stringify:function(a,b,d){try{c.checkNativeJsonLib();var e=!1,f=null;Array.prototype.toJSON&&
(e=!0,f=Array.prototype.toJSON,delete Array.prototype.toJSON);var g;if(Ca)return g=p.JSON.stringify(a,b,d),e&&(Array.prototype.toJSON=f),g;g=wa.stringify(a,b,d);e&&(Array.prototype.toJSON=f);return g}catch(l){return c.logError("Could not stringify object ["+l.message+"]"),null}}};t.prototype.fn={createInteraction:function(a){if(a){var b=c.getInteractionParameters(a);return new Db(a,b)}},postMessage:function(a,b){(p.opener&&p.opener!=p?p.opener:p.parent).postMessage({event:a,message:b,instanceName:p.bcEditModeInstanceName||
v.instanceName},"*")},stringify:function(a,b,d){return c.stringifyObject(a,b,d)},addGlobalVarToBlacklist:function(a){qa[a]=null},addImplicitGlobalList:function(a){y.call(db,a)},handlePreListeners:function(a){if(a)for(var b=0,d=a.length;b<d;b++){var e=a[b],f=e.getInteractionTypeId();k&&c.logInfo("start handling pre listener ["+f+"]");var g=$a[f];if(g&&"function"===typeof g){var l=e.getBlueConicClient(),e=g.call(this,l,e);if(e.onPrepare&&"function"===typeof e.onPrepare){k&&c.logInfo("call method [onPrepare] for listener ["+
f+"]");try{e.onPrepare()}catch(r){c.logError("an error occured in interactiontype: ["+f+"]\x3cbr\x3ecalled method: [onPrepare]\x3cbr\x3eerror: "+r.message),k&&console.error&&console.error(r)}}}}},updateParams:function(a,b,c){for(var d=v._handledInteractions,f=0,g=d.length;f<g;f++){var l=d[f];a&&null===l.id&&(l.id=a);if(l.id==a){l.context.setParameters(b,c);var r="function"==typeof l.interaction.onUpdate?l.interaction.onUpdate:null;r&&r.call(l.interaction)}}},handleInteractions:function(a,b){a=A.handleLocalEditModeInteractions(a);
var d=A.prepareInteractions(a,b);(a=document.getElementById(tb))&&a.parentNode.removeChild(a);a=[];for(var e=0,f=d.length;e<f;e++){var g=d[e];if(g.getPreloadProperties)try{var l=g.getPreloadProperties();c.mergeArrays(a,l)}catch(m){c.logError("an error occured in interactiontype: ["+g.ctx.getInteractionTypeId()+"]\x3cbr\x3ecalled method: [getPreloadProperties]\x3cbr\x3eerror: "+m.message),k&&console.error&&console.error(m)}}if(q&&0<a.length){k&&c.logInfo("start preloading "+a.length+" profile properties");
var r=0,l=function(){r++;2===r&&A.executeInteractionsOnDocReady(d,b)};A.downloadLibraries(l);q.loadValues(a,this,l)}else k&&c.logInfo("skip preloading "+a.length+" profile properties"),A.executeInteractionsOnDocReady(d,b)},getBCHostnameAwarePluginsRepositoryUrl:function(a,b){var c=ua();return c?c+b:a},getBCHostnameAwareLocalPluginsUrl:function(){return ua()||BC_URL},getBCUrl:function(){return BC_URL},registerInteractionType:function(a,b,d,e){var f=[];if(b){for(var g=0;d&&g<d.length;g++)y.call(f,d[g].url+
" - "+d[g].sharing);k&&c.logInfo("register plugin ["+a+"] with libraries \x3cbr\x3e"+f.join("\x3cbr\x3e"))}else return c.logInfo("did not register interactionype with id : ["+a+"]. InteractionTypeImpl is undefined."),null;var l;(function(){l=function(d,e){try{return new b(d,e)}catch(B){c.logError("an error occured in interactiontype: ["+a+"]\x3cbr\x3ecalled method: [init]\x3cbr\x3eerror: "+B.message),k&&console.error&&console.error(B)}}})();if(e)for(f=0;f<e.length;f++)(g=e[f])&&g.id&&g.baseUrl&&!da[g.id]&&
(da[g.id]=g.baseUrl);$a[a]=l;ab[a]=d},registerLibrary:function(a,b,d){k&&c.logInfo("register library ["+a+"]");Fa[a]={libraryFunction:b,libraryName:d}},registerTemplates:function(a){if(a&&!Aa){var b=c.getPropertiesFromObject(a);k&&c.logInfo("registering templates with the following IDs ["+b+"]");for(var d=0;d<b.length;d++){var e=a[b[d]];e.css!==E&&e.js!==E&&e.html!==E&&(sb[b[d]]=new Fb(b[d],e.html,e.css,e.js,e.precompiled?e.precompiled:null))}Aa=!0}},saveGlobalVariables:function(){var a={},b=[],d=
null;for(d in p)qa[d]===E&&(a[d]=p[d],y.call(b,d));for(var e=db.length,f=0;f<e;f++)d=db[f],-1===c.indexOfArray(b,d)&&p[d]&&(a[d]=p[d],y.call(b,d));return function(){for(var d=[],e=b.length,f=0;f<e;f++){var m=b[f];if(qa[m]===E&&p[m]!==a[m]){k&&c.logInfo(typeof p[m]+" ["+m+"] moved to private space");this[m]=p[m];y.call(d,m);try{p[m]=a[m]}catch(La){}}}var e=[],B;for(B in p)qa[B]===E&&e.push(B);B=c.diffArrays(e,b);e=0;for(f=B.length;e<f;e++){var m=B[e],h=typeof p[m];if(qa[m]===E&&(this[m]=p[m],y.call(d,
m),"jQuery"===m))try{p[m]=E,delete p[m]}catch(La){}k&&c.logInfo(h+" ["+m+"] added to private space")}return d}},importLibraries:function(a){a=c.ensureArray(a);var b=a.length;if(0!==b){for(var d=xb(),e=0;e<b;e++)yb.call(this,a[e]);d.call(this)}},importAndCacheLibraries:function(a){a=c.ensureArray(a);var b=a.length,d=this.ctx.getInteractionTypeId();if(0!==b)if(d)for(var e=0;e<b;e++){var f=a[e],g=Fa[f];if(g===E)k&&c.logError("unexisting library ["+f+"] for interactiontype ["+d+"]");else{var l=g.libraryName;
Oa[l]?(function(a){for(var b,d=0;d<a.length;d++)b=a[d],k&&c.logInfo("added ["+b.key+"] from cache to private space"),this[b.key]=b.object}.call(this,Oa[l]),k&&c.logInfo("retrieved library ["+f+"] from cache with key ["+l+"] for interactiontype ["+d+"]")):(Oa[l]=[],function(a,b){var e=xb();yb(a);for(var e=e.call(this),f=0;f<e.length;f++){var g={key:null,object:null};g.key=e[f];g.object=this[e[f]];y.call(b,g)}k&&c.logInfo("added library ["+a+"] to cache with key ["+l+"] for interactiontype ["+d+"]")}.call(this,
f,Oa[l]))}}else k&&c.logInfo("Could not determine the interactiontype during library import")},parseLibrary:function(a){if(Fa)if(Fa[a]){var b=Fa[a].libraryFunction;if(b&&"function"==typeof b){k&&c.logInfo("start import library ["+a+"]");var d=null,e=null;p.define&&(k&&c.logInfo('moving "window.define" out of the way, to make sure library ['+a+"] is parsed properly"),d=p.define,p.define=null);"object"===typeof module&&"object"===typeof module.exports&&(k&&c.logInfo('moving "module.exports" out of the way, to make sure library ['+
a+"] is parsed properly"),e=module.exports,module.exports=E);b.call(this);d&&(k&&c.logInfo("resetting window.define to original state."),p.define=d);e&&(k&&c.logInfo("resetting module.exports to original state."),module.exports=e)}else c.logError("library with url ["+a+"] not found")}else c.logError("the external library ["+a+"] is declared in the plugin XML but not present.");else c.logError("the external libraries are not loaded")},getDomainGroup:function(a){a=c.hash(a);for(var b in oa){var d=oa[b],
e;for(e in d)if(d[e]==a)return b}return"DEFAULT"},setRequestInfo:function(a){},getDOMElement:function(a){return c.getDOMElement(a)},version:"2.4.0"};var zb=t.prototype.fn.createInteraction,Qa=t.prototype.fn.handleInteractions,Wb=t.prototype.fn.registerInteractionType,Xb=t.prototype.fn.handlePreListeners,xb=t.prototype.fn.saveGlobalVariables,yb=t.prototype.fn.parseLibrary,A={getBlueConicClient:function(a){var b=v,c=a&&-1<a.getInteractionTypeId().indexOf("editmode_")&&("GLOBALLISTENER"===a.getType()||
"ACTION"===a.getType());a&&!c&&(a.getInteractionId()===a.getInteractionTypeId()&&"TOOLBAR"!==a.getType()||"GLOBALLISTENER"===a.getType())?(b=new t,b.profile=new wb(a.getInteractionTypeId())):b||(b=new t,b.profile=new wb);return b},publishPlainEventAndCallHook:function(a){if(Qb)try{var b;document.createEvent?(b=document.createEvent("Event"),b.initEvent(a,!0,!0),p.dispatchEvent(b)):(b=document.createEventObject(),p.fireEvent(a,b))}catch(d){}try{if(p[a]&&"function"===typeof p[a])p[a]()}catch(d){}},hideAllPositions:function(){var a=
M?M:document.location.hostname;k&&c.logInfo("start hide all positions for hostname ["+a+"]");var b=R[c.hash(a)];b&&0<b.length&&c.addCSSToDOM(b,bb,1250);k&&c.logInfo("finished hide all positions for hostname ["+a+"]")},checkPreListeners:function(){var a=[];if(ka.length&&0<ka.length){for(var b=0,c=ka.length;b<c;b++){var e=ka[b];Wb(e.id,e.interactionType);e=zb({id:e.id,name:e.id,interactionType:{myId:e.id}});y.call(a,e)}Xb(a)}Ta=!0},observeDOMChanges:function(){var a=v,b=document.getElementsByTagName("body")[0];
b&&!a._observer&&(p.MutationObserver||p.WebKitMutationObserver||p.MozMutationObserver?(a._observer=new MutationObserver(function(a,b){A.handleDOMMutation()}),a._observer.observe(b,{childList:!0,subtree:!0,characterData:!0})):p.addEventListener&&b.addEventListener("DOMNodeInserted",function(){A.handleDOMMutation()},!1))},handleDOMMutation:function(){v._handleMutationTO&&clearTimeout(v._handleMutationTO);v._handleMutationTO=setTimeout(function(){var a=v._pendingInteractions.length;v.isPaused!==E&&v.isPaused||
k&&c.logInfo("dom mutation detected, #pending interactions: ["+a+"]");0<a&&(a=A.handleOnLoad(v._pendingInteractions.slice(),!1),k&&c.logInfo("dom mutation detected, #handled: ["+a.length+"]"),0<a.length&&((a=document.getElementById(Pa))&&a.parentNode.removeChild(a),A.hidePendingPositions()));if((a=L.getSelectors().concat())&&0<a.length){k&&c.logInfo("listener subscribers found for the following selectors: ["+a+"]. Callbacks will be called now.");for(var b=0;b<a.length;b++){var d=a[b];try{d&&c.getDOMElement(d)&&
L.publish(d)}catch(e){k&&console.error(e)}}}delete v._handleMutationTO},100)},isNative:function(a,b){(a=/\{\s*\[native code\]\s*\}/.test(""+a))||c.logWarning("function: ["+b+"] is not native any more, the target website overruled it.");return a},handleLocalEditModeInteractions:function(a){if(!t.prototype.isInEditMode())return a;for(var b=[],d=[],e=0;e<a.length;e++){var f=a[e],g=f.getInteractionTypeId();y.call(b,g);f.isLocalEditMode()?k&&c.logInfo("skipping local edit mode interaction ["+g+"]"):y.call(d,
f)}for(a=0;a<ra.length;a++)e=ra[a],f=e.getInteractionTypeId(),e.isLocalEditMode()&&(g=f.substring(11),-1!==b.indexOf(g)&&(k&&c.logInfo("adding local edit mode interaction ["+f+"] for interaction type ["+g+"]"),Sb.call(d,e)));return d},shouldExecute:function(a,b){for(var d=0,e=v._handledInteractions.length;d<e;d++){var f=v._handledInteractions[d],f=-1<c.indexOfArray(Pb,b)&&a===f.id,g=!1;f||(g=a&&-1<a.indexOf("editmode_"));if(f||g)return!1}return!0},executeInteractionsOnDocReady:function(a,b){b?A.downloadLibraries(function(){A.injectLibraries(a);
ha?A.callInteractionMethods(a,b):c.bindDocumentReady(this,function(){A.callInteractionMethods(a,b)})}):(A.injectLibraries(a),ha?A.callInteractionMethods(a,b):c.bindDocumentReady(this,function(){A.callInteractionMethods(a,b)}))},downloadLibraries:function(a){lb?c.doCallback(this,a):Va?ca.push(a):(ca.push(a),Va=!0,k&&c.logInfo("start library download from url [/plugin/library] with version ["+Ma+"]"),a=I?BC_URL:V(),a=Ma?a+"/plugin/library/"+Ma:a+"/plugin/library",I&&(a+="_e"),c.loadScript(a,this,function(){lb=
!0;Va=!1;k&&c.logInfo("finished library download");if(ca&&0<ca.length){for(var a=0;a<ca.length;a++)ca[a]&&c.doCallback(this,ca[a]);ca=[]}}))},injectLibraries:function(a){for(var b=0,d=a.length;b<d;b++){var e=a[b].ctx.getInteractionTypeId(),f=a[b].ctx.getName()?a[b].ctx.getName():a[b].ctx.getInteractionId();k&&c.logInfo("start import libraries for interaction ["+f+"]");ab[e]&&a[b].importLibraries(ab[e]);k&&c.logInfo("finished import libraries for interaction ["+f+"]")}},prepareInteractions:function(a,
b){for(var d=[],e=0,f=a.length;e<f;e++){var g=a[e],l=g.getInteractionTypeId(),r=g.getName()?g.getName():g.getInteractionId();if(b||!v._handledInteractions||A.shouldExecute(g.getInteractionId(),g.getType())){k&&c.logInfo("start initializing interaction ["+r+"], interaction type ["+l+"]");var m=$a[l];if(m&&"function"===typeof m){var h=g.getBlueConicClient();if(m=m.call(this,h,g)){m.ctx=g;if(m.getContent&&"function"==typeof m.getContent&&"function"==typeof m.ctx.getPosition&&m.ctx.getPosition()){h=g=
null;try{g=m.getContent()}catch(Ka){c.logError("an error occured in interactiontype: ["+m.ctx.getInteractionTypeId()+"]\x3cbr\x3ecalled method: [getContent]\x3cbr\x3eerror: "+Ka.message),k&&console.error&&console.error(Ka)}h=m.ctx.getPosition();t.prototype.isInSimulatorMode()&&!g&&h&&m.ctx.getDOMElement();g&&h&&(k&&c.logInfo("start set content mechanism for interaction ["+r+"] with position ["+h+"]"),function(a,b,d){function e(){g++;(f=d.ctx.getDOMElement())?d.ctx.isOnLoadExecuted()?k&&c.logInfo('"onLoad" already executed for interaction ['+
r+'], skipping "getContent"'):(d.ctx.setGetContentExecuted(!0),c.setContent(f,a),k&&c.logInfo("[+] set content on position ["+b+"] was successful, recursion ["+g+"]")):50<=g?k&&c.logInfo("failed to set content on position ["+b+"] max recursion reached"):ya?k&&c.logInfo("failed to set content on position ["+b+"] onEvent started"):p.setTimeout(e,100)}var f=null,g=0;e.call(this)}(g,h,m))}y.call(d,m)}}else k&&c.logInfo("InteractionType with id ["+l+"] not found");k&&c.logInfo("finished initializing interaction ["+
r+"], interaction type ["+l+"]")}else k&&c.logInfo("skipping interaction, already executed ["+r+"], interaction type ["+l+"]")}return d},handleOnLoad:function(a,b){for(var d=[],e=0,f=a.length;e<f;e++){var g=a[e];if(g){var h="function"==typeof g.onLoad?g.onLoad:g.onEvent,r=g.ctx.getName()?g.ctx.getName():g.ctx.getInteractionId(),m=g.ctx;if(b||!v._handledInteractions||A.shouldExecute(m.getInteractionId(),m.getType()))if(m.getPosition()&&m.getDOMElement()||!m.getPosition()&&!m.isPositionTypePlugin()||
m.getPosition()&&m.isGetContentExecuted()){c.removeItemFromArray(v._pendingInteractions,g);k&&c.logInfo("[+] start onEvent for interaction ["+r+"]");d.push({id:m.getInteractionId(),name:m.getName(),position:m.getPosition(),type:m.getInteractionTypeId(),isPositionFound:m.isPositionFound()});v._handledInteractions.push({id:m.getInteractionId(),interaction:g,context:m});try{m.setOnLoadExecuted(!0);var B=m.getBlueConicClient(),Ka=I?BC_URL:V();h.call(g,B.profile.getProfile(),m.getParameters(),m.getPosition(),
B,m.getInteractionId(),Ka)}catch(La){c.logError("an error occured in interactiontype: ["+m.getInteractionTypeId()+"]\x3cbr\x3ecalled method: [onEvent]\x3cbr\x3eerror: "+La.message),k&&console.error&&console.error(La)}k&&c.logInfo("finished onEvent for interaction ["+r+"]")}else if(m.getPosition()){h=!0;for(r=0;r<blueConicClient._pendingInteractions.length;r++)h&&blueConicClient._pendingInteractions[r]&&blueConicClient._pendingInteractions[r].ctx.getInteractionId()===m.getInteractionId()&&(h=!1);h&&
v._pendingInteractions.push(g)}}}0<d.length&&!b&&u.publish("onHandledInteractions",{handledInteractions:d});return d},callInteractionMethods:function(a,b){ha?(za=ya=!0,v._pendingInteractions||(v._pendingInteractions=[]),v._handledInteractions||(v._handledInteractions=[]),k&&c.logInfo("start running interactions"),b&&u.publish(u.ON_BEFORE_INTERACTIONS),a=A.handleOnLoad(a,b),k&&c.logInfo("finished running interactions"),u.publish(u.ON_EVENT_READY,{blueConicClient:v,handledInteractions:a,isFirstLoad:b}),
b&&(0<v._pendingInteractions.length&&A.hidePendingPositions(),A.observeDOMChanges()),za=ya=!1,v.profile.updateProfile()):k&&c.logInfo("cannot run onLoad: document ready ["+ha+"]")},hidePendingPositions:function(){if(0<v._pendingInteractions.length){for(var a=R[c.hash(M?M:document.location.hostname)],b=[],d=0;d<v._pendingInteractions.length;d++){var e=v._pendingInteractions[d];-1<c.indexOfArray(a,e.ctx.getPosition())&&b.push(e.ctx.getPosition())}0<b.length&&(k&&c.logInfo("hiding interactions: ["+b+
"]"),(a=document.getElementById(Pa))&&a.parentNode.removeChild(a),c.addCSSToDOM(b,Pa))}}};S.prototype.permission={getLevel:function(){return n.getLevel()},setLevel:function(a,b){return n.setLevel(a,b)}};S.prototype.timeline={createEventById:function(a,b,d,e,f,g){if(a&&b){if(!d)d=new Date;else if(!(d instanceof Date)){k&&c.logInfo("Timestamp must be of type 'Date'.");return}a={profile:null!==q?q.getId():c.getBcSessionId(),data:e,timestamp:d,eventId:a};eb.createEvent(b,a,f,g)}else k&&c.logInfo("Timeline event must contain an ID and a type")},
createEvent:function(a,b,d,e,f){if(a){if(!b)b=new Date;else if(!(b instanceof Date)){k&&c.logInfo("Timestamp must be of type 'Date'.");return}b={profile:null!==q?q.getId():c.getBcSessionId(),data:d,timestamp:b};eb.createEvent(a,b,e,f)}else k&&c.logInfo("Timeline event must contain a type")}};S.prototype.permission.optin={};S.prototype.permission.optout={};var n={DO_NOT_TRACK:"DO_NOT_TRACK",ANONYMOUS:"ANONYMOUS",PERSONAL:"PERSONAL",propertyOptOutHandler:null,propertyOptInHandler:null,pluginOptInHandler:null,
pluginOptOutHandler:null,permissionLevel:null,previousPermissionLevel:null,isPermissionLevelChanged:!1,PermissionHandler:function(){this.itemList=[];this.removeList=[];this.addList=[];this.getAll=function(){return this.itemList};this.add=function(a){-1===c.indexOfArray(this.itemList,a)&&(y.call(this.itemList,a),y.call(this.addList,a),c.removeItemFromArray(this.removeList,a))};this.remove=function(a){c.removeItemFromArray(this.itemList,a);y.call(this.removeList,a);c.removeItemFromArray(this.addList,
a)};this.getRemoveList=function(){return this.removeList};this.getAddList=function(){return this.addList};this.set=function(a){this.itemList=a};this.clear=function(){this.addList=[];this.removeList=[]}},setLevel:function(a,b){if(a!==n.DO_NOT_TRACK&&a!==n.ANONYMOUS&&a!==n.PERSONAL)return c.logInfo("invalid permission level ["+a+"]. Use one of \x3cbr\x3eblueConicClient.permission.level.DO_NOT_TRACK\x3cbr\x3eblueConicClient.permission.level.ANONYMOUS\x3cbr\x3eblueConicClient.permission.level.PERSONAL"),
!1;n.previousPermissionLevel=n.permissionLevel;n.isPermissionLevelChanged=!0;n.message=b;n.permissionLevel=a;k&&c.logInfo("setPermissionLevel from ["+n.previousPermissionLevel+"] to ["+n.permissionLevel+"]");return!0},getLevel:function(){return n.permissionLevel},createAPI:function(){function a(a){var b=new n.PermissionHandler;a.getProfileProperties=function(){return b.getAll()};a.addProfileProperty=function(a){return b.add(a)};a.removeProfileProperty=function(a){return b.remove(a)};return b}function b(a){var b=
new n.PermissionHandler;a.getPlugins=function(){return b.getAll()};a.addPlugin=function(a){return b.add(a)};a.removePlugin=function(a){return b.remove(a)};return b}n.propertyOptOutHandler=a(S.prototype.permission.optout);n.propertyOptInHandler=a(S.prototype.permission.optin);n.pluginOptInHandler=b(S.prototype.permission.optin);n.pluginOptOutHandler=b(S.prototype.permission.optout);t.prototype.permission={};t.prototype.permission.level={DO_NOT_TRACK:n.DO_NOT_TRACK,ANONYMOUS:n.ANONYMOUS,PERSONAL:n.PERSONAL}}};
n.createAPI();var x={addQueue:{},setQueue:{},callbackQueue:[],addSources:{},setSources:{},replaySources:{},getProfile:function(a,b){var d=(new Date).getTime()+ ++h.requestId;h.addBatchRequest(h.GET_PROFILE,null,d,this,function(d){this._handleProfileResponse(d,!0);c.doCallback(a,b,q)})},_handleProfileResponse:function(a,b){if(a&&a.result){var d=function(a,d){var e=n[a.result.permissionlevel];n.permissionLevel=e;var f=c.ensureArray(a.result.optinproperties);n.propertyOptInHandler.set(f);var g=c.ensureArray(a.result.optoutproperties);
n.propertyOptOutHandler.set(g);var h=c.ensureArray(a.result.optinplugins);n.pluginOptInHandler.set(h);a=c.ensureArray(a.result.optoutplugins);n.pluginOptOutHandler.set(a);k&&(d="Profile object initialized"+("\x3cbr\x3e-id : ["+d+"]")+("\x3cbr\x3e-permission level : ["+e+"]")+("\x3cbr\x3e-optin properties : ["+f+"]"),d+="\x3cbr\x3e-optout properties : ["+g+"]",d+="\x3cbr\x3e-optin plugins : ["+h+"]",d+="\x3cbr\x3e-optout plugins : ["+a+"]",c.logInfo(d));b&&u.publish(u.ON_READY,{blueConicClient:v})},
e=a.profileId?a.profileId:a.tempId?a.tempId:a.result.id;q?(function(a){this._id=a}.call(q,e),q.getId()&&n.getLevel()||d.call(this,a,e)):(q=new pa(e),d.call(this,a,e));n.getLevel()!==n.DO_NOT_TRACK&&q.deleteDntRefusedObjectives()}},deleteProfile:function(a,b){var d=q.getPrivacyLegislation(),e=(new Date).getTime()+ ++h.requestId;h.addBatchRequest(h.DELETE_PROFILE,null,e,this,function(){c.setBcSessionId(null);q=new pa;n.permissionLevel=n.DO_NOT_TRACK;q._properties.privacy_legislation=d;k&&c.logInfo("profile is deleted");
c.doCallback(a,b)})},createProfile:function(a,b){var d=(new Date).getTime()+ ++h.requestId;h.addBatchRequest(h.CREATE_PROFILE,null,d,this,function(d){q=null;x.clearQueue();this._handleProfileResponse(d,!1);k&&c.logInfo("new profile is created");c.doCallback(a,b,q)})},clearQueue:function(){x.addQueue={};x.setQueue={};x.addSources={};x.setSources={}},updateProfile:function(a,b){if(za)b&&x.callbackQueue.push({caller:a,onSuccessCallback:b});else{var d=function(a){for(var b in a)return!1;return!0},e=function(a,
b){a===n.DO_NOT_TRACK&&c.setBcSessionId(b.profileId)};n.isPermissionLevelChanged&&n.previousPermissionLevel===n.DO_NOT_TRACK?function(){n.isPermissionLevelChanged=!1;var d=(new Date).getTime()+ ++h.requestId,g={};g.level=c.ensureArray(n.permissionLevel);g.message=c.ensureArray(n.message);q&&(q.getConsentedObjectives()&&(g.consented_objectives=c.ensureArray(q.getConsentedObjectives())),q.getRefusedObjectives()&&(g.refused_objectives=c.ensureArray(q.getRefusedObjectives())));c.setBcSessionId(null);
h.addBatchRequest(h.SET_PERMISSION_LEVEL,g,d,this,function(d){e(n.getLevel()+"",d);x.getProfile(this,function(){if(q)for(var d=q.getPropertyNames(),e=0;e<d.length;e++){var f=d[e],g=x.replaySources[f];q.setValues(f,q.getValues(f),g)}x.updateProfile(this,function(){v.createEvent("PAGEVIEW",!1,this,function(d){u.publish(u.ON_PERMISSION_LEVEL_CHANGE,{permissionLevel:n.permissionLevel,previousPermissionLevel:n.previousPermissionLevel});c.doCallback(a,b)})});h.submitBatch()});h.submitBatch()});h.submitBatch()}():
function(){function f(d){q--;if(0===q){if(x.callbackQueue&&0<x.callbackQueue.length){for(var e=0;e<x.callbackQueue.length;e++)c.doCallback(x.callbackQueue[e].caller,x.callbackQueue[e].onSuccessCallback);x.callbackQueue=[]}d&&d.result&&d.result.permissionlevel&&"No profile present and will not be created."!==c.getBcSessionId(Ea)&&(n.permissionLevel=n[d.result.permissionlevel]);c.doCallback(a,b)}}var g=x.addQueue,l=x.setQueue,r=x.addSources,m=x.setSources;x.clearQueue();for(var B=c.getPropertiesFromObject(l),
k=0,p=B.length;k<p;k++)delete g[B[k]];var Mb=c.getPropertiesFromObject(g),q=1;(new Date).getTime();(function(){if(n.isPermissionLevelChanged){var a={};q++;var b=n.getLevel()+"";a.level=c.ensureArray(b);a.message=c.ensureArray(n.message);n.isPermissionLevelChanged=!1;var d=(new Date).getTime()+ ++h.requestId;h.addBatchRequest(h.SET_PERMISSION_LEVEL,a,d,this,function(a){f.call(this);e(b,a);u.publish(u.ON_PERMISSION_LEVEL_CHANGE,{permissionLevel:n.permissionLevel,previousPermissionLevel:n.previousPermissionLevel})})}})();
(function(){var a=n.pluginOptInHandler&&n.pluginOptInHandler.getAddList(),b=n.propertyOptInHandler&&n.propertyOptInHandler.getAddList(),c={};if(0<a.length||0<b.length)q++,c.properties=b,c.plugins=a,a=(new Date).getTime()+ ++h.requestId,h.addBatchRequest(h.ADD_OPTIN,c,a,this,f)})();(function(){var a=n.pluginOptInHandler&&n.pluginOptInHandler.getRemoveList(),b=n.propertyOptInHandler&&n.propertyOptInHandler.getRemoveList(),c={};if(0<a.length||0<b.length)q++,c.properties=b,c.plugins=a,a=(new Date).getTime()+
++h.requestId,h.addBatchRequest(h.REMOVE_OPTIN,c,a,this,f)})();(function(){var a=n.pluginOptOutHandler&&n.pluginOptOutHandler.getAddList(),b=n.propertyOptOutHandler&&n.propertyOptOutHandler.getAddList(),c={};if(0<a.length||0<b.length)q++,c.properties=b,c.plugins=a,a=(new Date).getTime()+ ++h.requestId,h.addBatchRequest(h.ADD_OPTOUT,c,a,this,f)})();(function(){var a=n.pluginOptOutHandler&&n.pluginOptOutHandler.getRemoveList(),b=n.propertyOptOutHandler&&n.propertyOptOutHandler.getRemoveList(),c={};
if(0<a.length||0<b.length)q++,c.properties=b,c.plugins=a,a=(new Date).getTime()+ ++h.requestId,h.addBatchRequest(h.REMOVE_OPTOUT,c,a,this,f)})();(function(){if(0<B.length){var a={};a.properties=l;d(m)||(a.sources=m);q++;var b=(new Date).getTime()+ ++h.requestId;h.addBatchRequest(h.SET_PROPERTIES,a,b,this,f)}})();(function(){if(0<Mb.length){var a={};a.properties=g;d(r)||(a.sources=r);q++;var b=(new Date).getTime()+ ++h.requestId;h.addBatchRequest(h.ADD_PROPERTIES,a,b,this,f)}})();f();n.propertyOptOutHandler&&
n.propertyOptOutHandler.clear();n.propertyOptInHandler&&n.propertyOptInHandler.clear();n.pluginOptInHandler&&n.pluginOptInHandler.clear();n.pluginOptOutHandler&&n.pluginOptOutHandler.clear()}()}},getProperties:function(a,b,d){a={property:a};var e=(new Date).getTime()+ ++h.requestId;h.addBatchRequest(h.GET_PROPERTIES,a,e,this,function(a){function e(a,b){b=c.ensureArray(b);this._properties[a]=b}if(a&&a.result&&a.result.properties){a=a.result.properties;for(var f in a){var h=a[f];h&&"function"!=typeof h&&
e.call(q,f,h)}}c.doCallback(b,d)})},unsavedLog:function(a,b,d,e,f){var g=d?x.addQueue:x.setQueue;d||(delete x.addQueue[a],delete x.setQueue[a]);g[a]||(g[a]=[]);var g=g[a],h=function(){if(e&&f){var b=null;d?d&&(b=x.addSources):b=x.setSources;b&&(b[f]||(b[f]=[]),-1===v.util.array.indexOfArray(b[f],a)&&b[f].push(a));x.replaySources[a]=f}};if(c.isArray(b)){for(var r=b.length,m=0;m<r;m++)y.call(g,b[m]);h()}else null!==b&&b!==E?(y.call(g,b),h()):g=null}},eb={createEvent:function(a,b,d,e){var f=(new Date).getTime()+
++h.requestId;a=this.getParams(a,b,d);h.addBatchRequest(h.CREATE_TIMELINE_EVENT,a,f,d,function(a){a&&a.result?c.doCallback(d,e,"true"===a.error?new TypeError("Event is not added due to validation errors or invalid event type."):a.result):c.doCallback(d,e,null)});h.submitBatch()},getParams:function(a,b,d){for(var e=c.getPropertiesFromObject(b.data),f=0;f<e.length;f++){var g=e[f];b.data[g]=c.ensureArray(b.data[g]);if(0<b.data[g].length&&b.data[g][0]instanceof Object&&!c.isDate(b.data[g][0]))for(var h=
0;h<b.data[g].length;h++){var r=b.data[g][h];if(r)for(var m=c.getPropertiesFromObject(r),B=0;B<m.length;B++){var k=m[B];r[k]=c.ensureArray(r[k])}}}e=null;d&&d.context&&d.context.getInteractionId&&(e=d.context.getInteractionId());d=null;b.data&&b.data instanceof Object&&!c.isArray(b.data)&&(d=c.ensureArray(v.json.stringify(b.data)));a={referrer:c.ensureArray(b.referrer),profile:c.ensureArray(b.profile),type:c.ensureArray(a),eventSource:c.ensureArray(e),data:d};b.eventId&&(a.eventId=c.ensureArray(b.eventId));
b.timestamp&&(a.timestamp=c.ensureArray(b.timestamp.getTime()));return a}},u={types:["PAGEVIEW","VIEW","CLICK","CONVERSION"],dynamicTypes:[],eventQueue:[],handlersByEvent:{},ON_PERMISSION_LEVEL_CHANGE:"onpermissionlevelchange",ON_READY:"onready",ON_EVENT_READY:"oneventready",ON_URL_CHANGE:"onurlchange",ON_BEFORE_PRELISTENERS:"onbeforeprelisteners",ON_BEFORE_INTERACTIONS:"onbeforeinteractions",ON_SEGMENT_CHANGE:"onsegmentchange",ON_LIFECYCLE_STAGE_CHANGE:"onlifecyclestagechange",publish:function(a,
b){if(a&&"string"==typeof a){var d={};d.name=a.toLowerCase();d.context=b;u.eventQueue.push(d);k&&c.logInfo("published event : ["+a+"]");u.handleEvent(d)}},unsubscribe:function(a){for(var b=c.getPropertiesFromObject(u.handlersByEvent),d=0;d<b.length;d++){var e=u.handlersByEvent[b[d]],e=e?e:[];u.handlersByEvent[b[d]]=e;for(var f=e.length-1;0<=f;f--){var g=e[f].handlerObject.ctx;(g.isLocalEditMode()?g.getInteractionTypeId().substring(11):g.getInteractionTypeId())===a&&c.removeItemFromArray(e,e[f])}}},
subscribe:function(a,b,d){if(a&&"string"==typeof a&&d&&"function"==typeof d){a=a.toLowerCase();var e=u.handlersByEvent[a],e=e?e:[];u.handlersByEvent[a]=e;var f={};f.handlerObject=b;f.handlerFunction=d;e.push(f);k&&c.logInfo("subscribing to event: ["+a+"]");u.handleQueuedEvents(a,f)}},handleQueuedEvents:function(a,b){for(var d=[],e=0;e<u.eventQueue.length;e++){var f=u.eventQueue[e];f.name==a&&(c.doCallback(b.handlerObject,b.handlerFunction,a,f.context),d.push(f))}for(a=0;a<d.length;a++)c.removeItemFromArray(u.eventQueue,
d[a])},handleEvent:function(a){if(a&&a.name)for(var b=a.name.toLowerCase(),d=u.handlersByEvent[b],d=d?d:[],e=0;e<d.length;e++){var f=d[e];c.doCallback(f.handlerObject,f.handlerFunction,b,a.context)}},create:function(a,b,d){var e=(new Date).getTime()+ ++h.requestId,f={type:c.ensureArray(a.type),referrer:c.ensureArray(a.referrer),profile:c.ensureArray(a.profile)};a.interaction?f.interaction=c.ensureArray(a.interaction):a.timelineContext&&(f.timelineContext=a.timelineContext,f.timestamp=a.timestamp,
f.eventSource=a.eventSource);a.losingInteractions&&(f.losingInteractions=c.ensureArray(a.losingInteractions));h.addBatchRequest(h.CREATE_EVENT,f,e,this,function(a){function e(a){a=c.ensureArray(a);for(var b=a.length,d=0;d<b;d++){var e=a[d];e&&(e=zb(e),y.call(f,e))}}if(a&&a.result){a=a.result;var f=[];a.interactions&&e(a.interactions);a.loggedIn&&"true"===a.loggedIn&&(k=!0);a.channelId&&(qb=a.channelId);a.ipaddress&&(rb=a.ipaddress);if(a.interactionnames){for(var g=[],h=0;h<P.length;h++)g.push(P[h].id);
for(h=0;h<a.interactionnames.length;h++)-1===c.indexOfArray(g,a.interactionnames[h].id)&&P.push(a.interactionnames[h])}if(a.objectives)for(null===Y&&(Y={}),g=0;g<a.objectives.length;g++)-1===c.indexOfArray(Y,a.objectives[g].id)&&(h=a.objectives[g].myId,Y[h]=new Gb(h,a.objectives[g].myName,a.objectives[g].myDescription));if(a.connections){g=[];for(h=0;h<X.length;h++)g.push(X[h].id);for(h=0;h<a.connections.length;h++){var p=a.connections[h],n=c.indexOfArray(g,p.id);-1===n?X.push(p):X[n]=p}}if(a.goals)for(null===
fa&&(fa={}),g=c.getPropertiesFromObject(a.goals),h=0;h<g.length;h++)p=g[h],a.goals[p]&&(n=c.ensureArray(a.goals[p]),fa[p]=n.map(function(a){return new Hb(a)}));if(a.lifecycleStages){g=[];T&&0<T.length&&T.map&&(g=T.map(function(a){return a.getLifecycle().getId()+"_"+a.getStage().getId()}));T=[];if(0<a.lifecycleStages.length)for(h=0;h<a.lifecycleStages.length;h++)n=a.lifecycleStages[h],p=new Ib(n.myLifecycleId,n.myLifecycleName?n.myLifecycleName:""),n=new Jb(n.myStageId,n.myStageName?n.myStageName:
""),T.push(new Kb(p,n));null!==g&&(h=T.map(function(a){return a.getLifecycle().getId()+"_"+a.getStage().getId()}),h.sort().join(",")!==g.sort().join(",")&&u.publish(u.ON_LIFECYCLE_STAGE_CHANGE,{old:g,new:h}))}a.segments&&(g=null,ja&&0<ja.length&&ja.map&&(g=ja.map(function(a){return a.id})),ja=a.segments,null!==g&&(h=ja.map(function(a){return a.id}),h.sort().join(",")!==g.sort().join(",")&&u.publish(u.ON_SEGMENT_CHANGE,{old:g,new:h})));a.pluginversion&&(Ja=a.pluginversion);a.libraryversion&&(Ma=a.libraryversion);
a.templatesversion&&(Na=a.templatesversion);a.simulatordate&&(Wa=new Date(a.simulatordate));a.eventtypes&&(g=c.ensureArray(a.eventtypes),u.dynamicTypes=u.dynamicTypes.concat(g));a.selectedlegislations&&(hb=a.selectedlegislations);a.legislation&&(q._properties.privacy_legislation=a.legislation);a.consentedobjectives&&(q._properties.consented_objectives=a.consentedobjectives);a.refusedobjectives&&(q._properties.refused_objectives=a.refusedobjectives);c.doCallback(b,d,f)}else c.doCallback(b,d,null)})}};
t.prototype.event={publish:function(a,b){u.publish(a,b)},subscribe:function(a,b,c){u.subscribe(a,b,c)},unsubscribe:function(a){u.unsubscribe(a)},onProfilePermissionChange:u.ON_PERMISSION_LEVEL_CHANGE,onReady:u.ON_READY,onEventReady:u.ON_EVENT_READY,onUrlChange:u.ON_URL_CHANGE,onBeforePreListeners:u.ON_BEFORE_PRELISTENERS,onBeforeInteractions:u.ON_BEFORE_INTERACTIONS,onSegmentChange:u.ON_SEGMENT_CHANGE,onLifecycleStageChange:u.ON_LIFECYCLE_STAGE_CHANGE};var Ab={getRecommendationsEndpoint:function(a,
b){var d=V()+"/rest/recommendations",e=c.getZoneId();e&&(d+="/"+e);d+=b?"/"+b:"";a=a||{};b=c.getPropertiesFromObject(a);for(e=0;e<b.length;e++)"request"===b[e]&&"object"===typeof a[b[e]]&&(a[b[e]]=v.json.stringify(a[b[e]]));a=c.objectToUrl(a);return d+(a?"?"+a:"")},createEvent:function(a,b){h.JSONP.get(this.getRecommendationsEndpoint(a,"stats"),null,function(a){b&&c.doCallback(this,b,a)})},getRecommendations:function(a,b){h.JSONP.get(this.getRecommendationsEndpoint(a),null,function(a){a=new Eb(a);
b&&c.doCallback(this,b,a)})}};t.prototype.recommendation={getRecommendations:function(a,b){Ab.getRecommendations(a,b)},createEvent:function(a,b){Ab.createEvent(a,b)}};var L={selectors:[],handlersBySelector:{},handlerId:0,publish:function(a){a&&"string"===typeof a&&(k&&c.logInfo("published position update event for selector : ["+a+"]"),L.handlePositionUpdateEvent(a))},subscribe:function(a,b,d){if(!a||"string"!==typeof a)throw Error("Selector is empty or not of type string");if(!d||"function"!=typeof d)throw Error("No callback function defined or not a function.");
-1===c.indexOfArray(this.selectors,a)&&(c.isArray(a)?this.selectors=this.selectors.concat(a):this.selectors.push(a));var e=this.handlersBySelector[a],e=e?e:[];L.handlersBySelector[a]=e;var f={};f.id=++this.handlerId;f.handlerObject=b;f.handlerFunction=d;e.push(f);k&&c.logInfo("subscribing to position update event for selector: ["+a+"] with id ["+f.id+"]");return f.id},unsubscribe:function(a){if(!a||"number"!==typeof a)throw Error("Subscription id is empty or not of type number");for(var b=c.getPropertiesFromObject(this.handlersBySelector),
d=0;d<b.length;d++){var e=b[d],f=this.handlersBySelector[e],f=f.filter(function(b){b.id===a&&k&&c.logInfo("found handler with id: ["+a+"]");return b.id!==a});0===f.length?(delete this.handlersBySelector[e],c.removeItemFromArray(this.selectors,e)):this.handlersBySelector[e]=f}k&&c.logInfo("unsubscribing to position update event for id ["+a+"]")},handlePositionUpdateEvent:function(a){if(a){var b=L.handlersBySelector[a],b=b?b:[];delete L.handlersBySelector[a];c.removeItemFromArray(this.selectors,a);
for(var d=0,e=b.length;d<e;d++){var f=b[d];c.doCallback(f.handlerObject,f.handlerFunction,a)}}},getSelectors:function(){return this.selectors}};t.prototype.position={publish:function(a){L.publish(a)},subscribe:function(a,b,c){return L.subscribe(a,b,c)},unsubscribe:function(a){L.unsubscribe(a)}};t.prototype.objective={getObjectives:function(){return Y},getObjectiveById:function(a){return Y[a]?Y[a]:null}};var c={docReadyCallbacks:[],rxhtmlTag:/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,
hash:function(a){for(var b=0,c,e=0;e<a.length;e++)c=a.charCodeAt(e),b=31*b+c,b&=b;for(e=a.length-1;0<=e;e--)c=a.charCodeAt(e),b=31*b+c,b&=b;return b},doCallback:function(){for(var a=arguments[0],b=arguments[1],d=[],e=2,f=arguments.length;e<f;e++)y.call(d,arguments[e]);if(b&&"function"==typeof b)if(k)b.apply(a,d);else try{b.apply(a,d)}catch(g){c.logError("an error occured in callback function: ["+b+"], error: ["+g+"]")}},trimLeft:function(a){if(a)return a.replace(/^\s+/,"")},trimRight:function(a){if(a)return a.replace(/\s+$/,
"")},map:function(a,b,c){if(Vb)return a.map(function(a){return b.call(c,a)});for(var d=0,f=a.length,g=[];d<f;d++)d in a&&(g[d]=b.call(c,a[d]));return g},setContent:function(a,b){if(a&&b!==E&&null!==b){b=b.replace(c.rxhtmlTag,"\x3c$1\x3e\x3c/$2\x3e");var d=a.nodeName?a.nodeName.toLowerCase():a.nodeName;if(-1!==c.indexOfArray("area base br col command embed hr img input keygen link meta param source track wbr".split(" "),d)){var e=a.parentNode?a.parentNode.innerHTML:null;if(e){var f=document.createElement("div");
f.appendChild(a.cloneNode(!0));b=e.replace(f.innerHTML,b);if(a.parentNode.innerHTML!==b)try{a.parentNode.innerHTML=b,k&&c.logInfo("setContent replaced void element ["+d+"] with given html")}catch(g){k&&c.logInfo("setContent failed to replace void element ["+d+"] with given html")}}else k&&c.logInfo("could not set inner html for void element ["+d+"] because container was not ready")}else{for(;a.firstChild;)a.removeChild(a.firstChild);try{a.innerHTML=b}catch(g){d=document.createElement(),d.innerHTML=
b,a.appendChild(d)}}}},getBcTempId:function(a){return c.getBcId("BCTempID",a)},setBcTempId:function(a,b,d){c.setBcId("BCTempID",a,b,d)},getBcSessionId:function(a){return c.getBcId("BCSessionID",a)},getBcId:function(a,b){return b?b[a]:c.getCookie(a)},setBcSessionId:function(a,b){c.setBcId("BCSessionID",a,b)},setBcId:function(a,b,d,e){var f="BCSessionID"===a;f?mb?(c.setCookie(a,b,0),c.setCookie(a,null,null,Za)):(c.setCookie(a,null,null),c.setCookie(a,b,e,Za)):c.setCookie(a,b,e);d&&(b?d[a]=b:delete d[a]);
K&&f&&h.lastSyncedCookieId!==b&&h.thirdPartyCookieId!==b&&(h.lastSyncedCookieId=b,h.cookieSyncTimeoutHandle&&clearTimeout(h.cookieSyncTimeoutHandle),h.cookieSyncTimeoutHandle=setTimeout(function(){h.JSONP.get(h.resourceURL_CST,{bcsessionid:b||""},function(){k&&c.logInfo("CS update success: "+b)},null,function(){h.lastSyncedCookieId=E;c.logWarning("CS request failed...")},!1,!1)},0))},bcSessionIdChanged:function(a){var b=c.getCookie("BCSessionID");return a!==b},setCookie:function(a,b,d,e){if(Ia&&a)if(null===
b||b===E)document.cookie=a+"\x3d;expires\x3dThu, 01 Jan 1970 00:00:00 GMT; path\x3d/"+(e?";domain\x3d"+e:"")+(I?";SameSite\x3dNone;Secure":"");else{var f=new Date;null===d||d===E||isNaN(d)?f.setDate(f.getDate()+365):f=0<d?new Date(f.getTime()+parseInt(d)):null;b&&"string"==typeof b&&(b=b.replace(/[\n\r]/g,""));b=a+"\x3d"+encodeURIComponent(b);f&&(b+=";expires\x3d"+f.toUTCString());e&&(b+=";domain\x3d"+e);b+=";path\x3d/";I&&(b+=";SameSite\x3dNone;Secure");e=document.cookie+b;-1<a.indexOf("BCRevision")&&
3E3<e.length?k&&c.logInfo("could not set cookie ["+a+"] with size ["+b.length+"] because it would exceed the total cookie length of 3kb"):document.cookie=b}},getCookies:function(){var a=null,b=0,d={};if(!Ia)return d;a=null!==Da&&null===Ea?Da:document.cookie;if(Da!==a)Da=a;else if(null!==Ea)return Ea;a&&-1<a.indexOf("$Version\x3d")&&document.cookie.match(/^\s*\$Version=(?:"1"|1);\s*(.*)/)&&(a=RegExp.$1,b=1);0===b?c.map(a.split(/[,;]/),function(a){a=a.split(/=/);var b=decodeURIComponent(c.trimLeft(a[0])),
e=null;try{if(1<a.length)for(var h=1;h<a.length;h++)e=e?e+a[h]:a[h],h<a.length-1&&(e+=encodeURIComponent("\x3d"));d[b]=e?decodeURIComponent(c.trimRight(e)):null}catch(r){}}):c.map(a.match(/(?:^|\s+)([!#$%&'*+\-.0-9A-Z^`a-z|~]+)=([!#$%&'*+\-.0-9A-Z^`a-z|~]*|"(?:[\x20-\x7E\x80\xFF]|\\[\x00-\x7F])*")(?=\s*[,;]|$)/g),function(a,b){b='"'===b.charAt(0)?b.substr(1,-1).replace(/\\(.)/g,"$1"):b;d[a]=b});return Ea=d},getCookie:function(a){return c.getCookies()[a]},ensureArray:function(a){if(c.isArray(a))return a;
var b=[];null!==a&&a!==E&&y.call(b,a);return b},isArray:function(a){return a?Tb?Array.isArray(a):-1==nb.call(a).indexOf("Array")?!1:!0:!1},isDate:function(a){return a&&-1!=nb.call(a).indexOf("Date")&&a.getTime?!0:!1},diffArrays:function(a,b){if(Ub&&ob)return a.filter(function(a){return 0>b.indexOf(a)});var c,e=a.slice();for(a=0;a<e.length;a++)for(c=0;c<b.length;c++)if(e[a]===b[c]){e.splice(a,1);a--;break}return e},removeItemFromArray:function(a,b){if(c.isArray(a))for(var d;-1!==(d=c.indexOfArray(a,
b));)a.splice(d,1)},indexOfArray:function(a,b){if(!a||!c.isArray(a))return-1;if(ob)return a.indexOf(b);for(var d=0,e=a.length;d<e;d++)if(a[d]===b)return d;return-1},mergeArrays:function(a,b){if(c.isArray(a)&&b)if(c.isArray(b)||-1==c.indexOfArray(a,b))for(var d=0,e=b.length;d<e;d++){var f=b[d];-1===c.indexOfArray(a,f)&&y.call(a,f)}else y.call(a,b)},loadScript:function(a,b,d){var e=document.createElement("script"),f=!1,g;e.src=a;e.async=!0;e.onload=e.onreadystatechange=function(){f||this.readyState&&
"loaded"!==this.readyState&&"complete"!==this.readyState||(f=!0,e.onload=e.onreadystatechange=null,e&&e.parentNode&&e.parentNode.removeChild(e),c.doCallback(b,d))};g||(g=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]);g.appendChild(e)},loadCSS:function(a){c.loadCSS.urlMap||(c.loadCSS.urlMap={});c.loadCSS.counter||(c.loadCSS.counter=0);var b=c.loadCSS.urlMap,d=b[a];d||(b[a]="id_"+ ++c.loadCSS.counter);d=b[a];if(document.getElementById(d))k&&c.logInfo("skip loading css ["+
a+"]");else{k&&c.logInfo("start loading css ["+a+"]");var b=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0],e=document.createElement("link");e.id=d;e.rel="stylesheet";e.type="text/css";e.href=a;b.appendChild(e)}},bindDocumentReady:function(a,b){b&&"function"==typeof b&&(ha?c.doCallback(a,b):y.call(c.docReadyCallbacks,function(){c.doCallback(a,b)}))},docReady:function(){if(!ha){ha=!0;k&&c.logInfo("[+] document ready event thrown by browser");for(var a=c.docReadyCallbacks,
b=a.length,d=0;d<b;d++)a[d].apply()}},getInteractionParameters:function(a){var b={};if(a){a=c.ensureArray(a.parameters);for(var d=0,e=a.length;d<e;d++){var f=a[d];if(f){for(var g={},h=0,r=f.parameter.length;h<r;h++){var m=f.parameter[h];m&&(g[m.id]=m.value)}b[f.locale]=g}}}return b},getPropertiesFromObject:function(a){if(!a)return[];var b=[],c;for(c in a)va.call(a,c)&&"function"!=typeof a[c]&&y.call(b,c);return b},getDOMElement:function(a,b){if(!a)return null;"undefined"==typeof b&&(b=c.isCSSSelector(a));
return b?(a=Yb(a))&&0<a.length?a[0]:null:((b=document.getElementById(a))||(b=document.getElementsByTagName(a)),b&&b.length&&0<b.length?b[0]:b instanceof HTMLCollection&&0===b.length?null:b)},isCSSSelector:function(a){if(!a)return!1;var b=!1;-1!==a.indexOf("[")&&-1!==a.indexOf("]")&&-1!==a.indexOf("\x3d")&&(b=!0);var c=!1;if(-1!==a.indexOf("#")||-1!==a.indexOf(".")||-1!==a.indexOf(" ")||-1!==a.indexOf(":")||b)c=!0;return c},normalizePosition:function(a){if(!a)return null;c.isCSSSelector(a)||(a="#"+
a);return a},addCSSToDOM:function(a,b,d){if(a&&0!==a.length){k&&c.logInfo("hide positions  ["+a+"]");for(var e="",f=0,g=a.length;f<g;f++){var h=c.normalizePosition(a[f]);h&&(e=e+h+" {opacity:0.0;filter:alpha(opacity\x3d0);}\n")}a=document.createElement("style");a.setAttribute("type","text/css");a.setAttribute("id",b);a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e));(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a);d&&0<
d&&p.setTimeout(function(){var a=document.getElementById(b);a&&(a.parentNode.removeChild(a),k&&c.logInfo("timeout ["+d+"] expired; CSS ["+b+"] removed"))},d)}},getBaseURL:function(a){var b=null;da&&da[a]&&(b=da[a]);return b?0==b.indexOf("/blueconic/static/plugins/")?BC_URL+b:b:null},parseJSON:function(a){return a?v.json.parse(a):null},stringifyObject:function(a,b,c){return v.json.stringify(a,b,c)},checkNativeJsonLib:function(){Ca&&(!Ya||(new Date).getTime()-100)>Ya&&(Ca=A.isNative(p.JSON.parse,"window.JSON.parse")&&
A.isNative(p.JSON.stringify,"window.JSON.stringify"),Ya=(new Date).getTime());Ca||null!==wa||Lb()},handleProfileId:function(a,b){n.getLevel()!==n.DO_NOT_TRACK&&(c.bcSessionIdChanged(a)?(k&&c.logInfo("update cookie [BCSessionID] with profile id ["+a+"]"),c.setBcSessionId(a,b)):pb||(c.setBcSessionId(a,b),pb=!0),a&&c.getBcTempId(b)&&(c.setBcTempId(null,b),q&&!q.getId()&&function(a){this._id=a}.call(q,a)))},handleTempProfileId:function(a,b){a&&c.getBcTempId(b)!==a&&c.setBcTempId(a,b&&c.getBcTempId()?
b:null,6E5)},log:function(a){ga&&console.log("[BC]"+a)},logError:function(a){for(;-1!==a.indexOf("\x3cbr\x3e");)a=a.replace("\x3cbr\x3e","\n            ");c.log("[ERROR] "+a);ga&&console.trace&&(c.log("[ERROR] --stacktrace--"),console.trace(),c.log("[ERROR] --end stacktrace--"))},logWarning:function(a){k&&c.log("[WARNING] "+a)},logInfo:function(a){if(k){for(var b=(new Date).getTime()-Ob;-1!==a.indexOf("\x3cbr\x3e");)a=a.replace("\x3cbr\x3e","\n           ");c.log("[INFO] "+a+" +"+b+" ms")}},logDeprecated:function(a,
b){k&&c.log("[DEPRECATED] function ["+a+"] is deprecated. \n                 Please use : "+b)},formatLocalDate:function(){var a=new Date,b=-a.getTimezoneOffset(),c=0<=b?"+":"-",e=function(a){a=Math.abs(Math.floor(a));return(10>a?"0":"")+a};return a.getFullYear()+"-"+e(a.getMonth()+1)+"-"+e(a.getDate())+"T"+e(a.getHours())+":"+e(a.getMinutes())+":"+e(a.getSeconds())+c+e(b/60)+":"+e(b%60)},getCurrentTime:function(){var a=new Date;return("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2)},
objectToUrl:function(a){var b="",d;for(d in a){var e=a[d];if(c.isArray(e))for(var f=0;f<e.length;f++)""!==b&&(b+="\x26"),b+=d+"\x3d"+encodeURIComponent(e[f]);else""!==b&&(b+="\x26"),b+=d+"\x3d"+encodeURIComponent(e)}return b},getZoneId:function(){return J?sessionStorage.getItem("BCZoneID"):c.getCookie("BCZoneID")},handleZoneId:function(a){J?a?sessionStorage.setItem("BCZoneID",a):sessionStorage.removeItem("BCZoneID"):a?c.setCookie("BCZoneID",a,3E5):c.setCookie("BCZoneID",null)}};A.hideAllPositions();
var Ra;Ra=M?t.prototype.fn.getDomainGroup(M):t.prototype.fn.getDomainGroup(document.location.hostname);var Bb=Math.floor(1E3*Math.random())+100,h={GET_PROFILE:"getProfile",CREATE_PROFILE:"createProfile",DELETE_PROFILE:"deleteProfile",SET_PROPERTIES:"setProperties",ADD_PROPERTIES:"addProperties",GET_PROPERTIES:"getProperties",GET_LOGIN_STATUS:"getLoginStatus",GET_ALL:"getAll",CREATE_EVENT:"createEvent",GET_PROPERTY_LABELS:"getPropertyLabels",GET_PROFILE_PROPERTIES:"getProfileProperties",SEND_MAIL:"sendMail",
ADD_OPTIN:"addOptin",REMOVE_OPTIN:"removeOptin",ADD_OPTOUT:"addOptout",REMOVE_OPTOUT:"removeOptout",SET_PERMISSION_LEVEL:"setPermissionLevel",SET_OBJECTIVES:"setObjectives",ADD_OBJECTIVES:"addObjectives",CREATE_TIMELINE_EVENT:"createTimelineEvent",resourceURL_GET:(I?BC_URL:V())+"/DG/"+Ra+"/rest/rpc/",resourceURL_POST:(I?BC_URL:V())+"/DG/"+Ra+"/rest/rpc/"+ ++Bb,resourceURL_CST:BC_URL+"/DG/"+Ra+"/cs",batchRequests:[],requestId:0,openRequests:0,lastSyncedCookieId:E,thirdPartyCookieId:null,cookieSyncTimeoutHandle:!1,
_csRequestDone:K&&null!==ua()?!1:!0,_rpcThrottlingRequestCount:0,_rpcThrottlingTimeoutHandle:null,_batchTimeoutHandlers:{},JSONP:function(){function a(a,b,d){var f=document.createElement("script"),g=!1;f.src=a;f.async=!0;f.onload=f.onreadystatechange=function(){g||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(g=!0,f.onload=f.onreadystatechange=null,f&&f.parentNode&&f.parentNode.removeChild(f))};f.onerror=function(a){d&&c.handleZoneId();b&&b(a)};e||(e=document.getElementsByTagName("head")[0]);
e.appendChild(f)}function b(a,b){a="";!K&&b&&(b=null);var d=c.getCookies();b=b||c.getBcSessionId(d)||"";var d=c.getBcTempId(d)||"",e=M?encodeURIComponent(M):"";a+="referer\x3d"+encodeURIComponent(f.location)+"\x26";if(f.name&&-1<f.name.indexOf("bc_")){var g=f.name;if(g){for(var h=!1,r=g,k=0;k<ub.length;k++){var l=ub[k];-1<g.indexOf(l)&&(r=l,h=!0)}g=h?r:g.substring(g.indexOf("bc_"));a+="mode\x3d"+g+"\x26"}}else if(I||f.opener)a+="checkCookie\x3dtrue\x26isopener\x3d"+("undefined"!=typeof f.opener&&
null!=f.opener)+"\x26";a+="bcsessionid\x3d"+b+"\x26bctempid\x3d"+d+"\x26overruleReferrer\x3d"+e+"\x26time\x3d"+encodeURIComponent(c.formatLocalDate());if(q)for(b=q.getDntRefusedObjectives(),d=0;d<b.length;d++)a+="\x26bcro\x3d"+encodeURIComponent(b[d]);return a}function d(a,e,f,g,h,k){k=(-1===a.indexOf("?")?"?":"")+b(a,k);var m=function(a,b){var c=new XMLHttpRequest;"withCredentials"in c?(c.open(a,b,!0),c.setRequestHeader("Content-Type","text/plain"),c.withCredentials=!0,c.timeout=3E4):c=null;return c}("POST",
a+k+"\x26ts\x3d"+(new Date).getTime());if(!m)return c.logWarning("CORS POST request failed, is XMLHttpRequest overruled? Fallback to GET."),g(),!1;m.onload=function(){if(m.responseText){var a=v.json.parse(m.responseText);!h&&a.location?d(a.location,e,f,g,!0):f(a)}};m.onerror=function(){0<m.status?(c.logWarning("CORS POST request failed."),usePostMethod()&&c.handleZoneId()):c.log("[WARNING] BlueConic request failed, please make sure '"+(M?M:document.location.hostname)+"' is added as a channel (or alias) in BlueConic.");
g&&g()};m.onabort=function(a){ga&&console.log("CORS request is aborted.",a)};m.ontimeout=function(a){ga&&console.log("CORS request has timed-out, 30s exceeded.")};m.send(e);return!0}var e,f=this,g={};return{get:function(c,d,e,h,k,n,p,q){var m=-1===(c||"").indexOf("?")?"?":"\x26";d=d||{};for(var r in d)va.call(d,r)&&(m+=r+"\x3d"+d[r]+"\x26");p&&(m+=b(c,q));var l="bc_json"+ ++Bb;f[l]=function(a){e(a);try{delete f[l]}catch(Zb){}f[l]=null};a(c+m+"\x26"+(h||g.callbackName||"callback")+"\x3d"+l,k,n);return l},
post:d,init:function(a){g=a}}}(),resetThrottlingCounter:function(a){h._rpcThrottlingRequestCount=0;a&&h._rpcThrottlingTimeoutHandle&&(clearInterval(h._rpcThrottlingTimeoutHandle),h._rpcThrottlingTimeoutHandle=null)},handleRevisions:function(){var a=null,b;if(J){b=[];for(var d=0;d<localStorage.length;d++)b.push(localStorage.key(d))}else a=c.getCookies(),b=c.getPropertiesFromObject(a);for(var d=0,e=b.length;d<e;d++){var f=b[d];if(f&&-1!==f.indexOf("BCRevision")){var g;J?g=localStorage.getItem(f):a&&
(g=a[f]);var l=c.parseJSON(g);if(l){var r=l.method,m=l.param,l=l.requestId;r&&m&&l&&(k&&c.logInfo("scheduled revision RPC for requestId ["+l+"] with method : ["+r+"]"),m.source=["backlog"],h.addBatchRequest(r,m,l,null,null),J&&localStorage.getItem(f)?localStorage.removeItem(f):c.setCookie(f,null))}}}},RPCTask:function(a,b,d,e,f){this._id=a+"";this._param=b;this._method=d;this._caller=e;this._callBack=f;this._isFinished=this._isQueued=!1;this._revCookie=this._rpc=null;this.getContentLength=function(){return encodeURIComponent(c.stringifyObject(this.getRPC())).length};
this.getId=function(){return this._id.replace("rev_","")};this.isQueued=function(){return this._isQueued};this.getMethod=function(){return this._method};this.queued=function(){this._isQueued=!0};this.isFinished=function(){return this._isFinished};this.setParameter=function(a){this._param=a;this._rpc=null};this.getParameter=function(){return this._param};this.finished=function(a){this._isFinished=!0;c.handleZoneId(a.zoneId);this.removeRevisionCookie();c.doCallback(this._caller,this._callBack,a)};this.getRPC=
function(){this._rpc||(this._rpc={method:encodeURIComponent(this._method),params:c.stringifyObject(this._param),id:encodeURIComponent(this.getId())});return this._rpc};this.setRevisionCookie=function(){if(!(0===this._id.indexOf("rev")||n.getLevel()===n.DO_NOT_TRACK||this.getContentLength()>ia||this._method!==h.SET_PROPERTIES&&this._method!==h.ADD_PROPERTIES&&this._method!==h.SEND_MAIL&&this._method!==h.CREATE_EVENT&&this._method!==h.CREATE_TIMELINE_EVENT||this._method===h.CREATE_EVENT&&this._param&&
this._param.type&&"PAGEVIEW"===this._param.type[0])){var a="rev_"+this._id,b=c.stringifyObject({method:this._method,param:this._param,requestId:a}),d="BCRevision_"+this._id,e=function(){c.setCookie(d,b,0);var e=c.getCookie(d);if(!e){for(var e=c.getCookies(),e=c.getPropertiesFromObject(e),f=0,g=e.length;f<g;f++){var h=e[f];0===h.indexOf("BCRevision")&&c.setCookie(h,null)}c.setCookie(d,b,0);e=c.getCookie(d);if(!e){k&&c.logInfo("could not store revision cookie ["+d+"]");return}}k&&c.logInfo("revision cookie with name ["+
d+"] with revision ["+a+"] stored")};if(J){try{localStorage.setItem(d,b)}catch(B){k&&c.logInfo("adding item ["+d+"] to localStorage failed, fallback to cookie.")}localStorage.getItem(d)?k&&c.logInfo("revision with name ["+d+"] with revision ["+a+"] is stored in localStorage."):e()}else e();this._revCookie=d}};this.removeRevisionCookie=function(){this._revCookie&&(J&&localStorage.getItem(this._revCookie)?(k&&c.logInfo("revision with name ["+this._revCookie+"] removed from localStorage"),localStorage.removeItem(this._revCookie)):
(k&&c.logInfo("revision cookie with name ["+this._revCookie+"] removed"),c.setCookie(this._revCookie,null)))}},RemoteRequest:function(a,b,d,e,f){this._caller=b;this._onSuccess=d;this._isFinished=!1;this._parameter=e;this._requestId=f;this._method=a;this._tasks=[];this.getTasks=function(){return this._tasks};this.isFinished=function(){return this._isFinished};this.toString=function(){for(var a=(new h.RPCTask(this._requestId,this._parameter,this._method,null,null)).getContentLength(),a="RemoteRequest ["+
this._requestId+"] - method : ["+this._method+"], Tasks : ["+this._tasks.length+"], contentLength : ["+a+"]",b=0,d=this._tasks.length;b<d;b++){var e=this._tasks[b],f=e.getContentLength(),a=a+("\x3cbr\x3eTask ["+e.getId()+"] - Content length : ["+f+"]. Is finished ["+e.isFinished()+"]."),e=e.getParameter();if(!e)break;var e=e.properties?e.properties:e,g;for(g in e)if(va.call(e,g))if(a+="\x3cbr\x3e  -"+g,(f=e[g])&&0!==f.length)if(c.isArray(f))for(var k=0,l=f.length;k<l;k++){var n=f[k];if(""===n)n="(empty string)";
else if(null==n||n==E)n="(null or undefined)";a+="\x3cbr\x3e    "+n}else f&&(a+="\x3cbr\x3e    "+f);else a+="\x3cbr\x3e    (null or undefined)"}return a};b=function(a){for(var b=this._tasks,d=0,e=b.length;d<e;d++)if(!b[d].isFinished())return;this._isFinished=!0;k&&c.logInfo(this.toString());c.doCallback(this._caller,this._onSuccess,a)};d=new h.RPCTask(this._requestId,this._parameter,this._method,this,b);if(d.getContentLength()<=ia)y.call(this._tasks,d);else switch(a){case h.ADD_PROPERTIES:case h.SET_PROPERTIES:d=
function(a,b,d){for(var e=[],f=function(a,b){this.properties[a]=c.ensureArray(b)},g=function(a){try{delete this.properties[a]}catch(F){}},k=function(){return 1===c.getPropertiesFromObject(this.properties).length||(new h.RPCTask(a,this,b,null,null)).getContentLength()<=ia?!0:!1},m=c.getPropertiesFromObject(d.properties),n={properties:{}},l=0,r=m.length;l<r;l++){var p=m[l],q=d.properties[p];f.call(n,p,q);k.call(n)||(g.call(n,p),y.call(e,n),n={properties:{}},f.call(n,p,q))}y.call(e,n);return e}(this._requestId,
this._method,this._parameter);e=0;for(var g=d.length;e<g;e++){var l=new h.RPCTask(f+"-"+e,d[e],a,this,b);y.call(this._tasks,l)}break;default:y.call(this._tasks,d)}},addBatchRequest:function(a,b,c,e,f){a=new h.RemoteRequest(a,e,f,b,c);y.call(h.batchRequests,a)},submitBatchTimeout:function(a,b){h._batchTimeoutHandlers[b]&&clearTimeout(h._batchTimeoutHandlers[b]);h._batchTimeoutHandlers[b]=setTimeout(function(){delete h._batchTimeoutHandlers[b];h.batchRequests&&0!==h.batchRequests.length&&h.submitBatch()},
a)},submitBatch:function(){var a=function(){var a=Rb;if(a)switch(Nb){case "FORCE_GET":a=!1;break;case "POST_NATIVE_ONLY":a=XMLHttpRequest.prototype&&A.isNative(XMLHttpRequest.prototype.send,"XMLHttpRequest.prototype.send")}return a}(),b=function(a){for(var d=[],e=0,g=0,h=a.length;g<h;g++)for(var n=a[g].getTasks(),l=0,p=n.length;l<p;l++){var r=n[l];if(!r.isQueued()){var q=parseInt(r.getContentLength());if(e+q<=ia)r.queued(),e+=q,y.call(d,r);else{0===d.length&&(r.queued(),e+=q,y.call(d,r),k&&c.logInfo("RPC task with id ["+
r.getId()+"] method ["+r.getMethod()+" ] contains a profile property value which could be too large too handle.\x3cbr\x3e The size of the RPC is ["+q+"] while the max size is ["+ia+"]"));f.call(this,d,function(){b.call(this,a)});return}}}0<d.length&&f.call(this,d,null)},d=function(a,b,d){if(a){a=c.ensureArray(a);for(var e=c.getCookies(),f=0;f<a.length;f++){var g=a[f];if(g){e.BCTempID&&g.profileId&&(Ua=!0);g.secondAndTopLevelDomain&&(Za=g.secondAndTopLevelDomain);c.handleTempProfileId(g.tempId,e);
c.handleProfileId(g.profileId,e);for(var k=0;k<b.length;k++){var m=b[k];m.getId()===g.id&&m.finished(g)}}}}else for(a=0;a<b.length;a++)b[a].finished();d&&"function"===typeof d&&d.call(this);h.openRequests--},e=function(a){if(!c.getZoneId())return a;a&&"/"!==a[a.length-1]&&(a+="/");return a+=c.getZoneId()},f=function(b,f){if(20<=h.openRequests)c.logWarning("Too many open RPC requests (20), task will not be processed");else if(100<=h._rpcThrottlingRequestCount)c.logWarning("Too many RPC requests (100) done in this timeframe (1 minute), task will not be processed.");
else{null===h._rpcThrottlingTimeoutHandle&&(h._rpcThrottlingTimeoutHandle=setInterval(function(){h.resetThrottlingCounter(!1)},6E4));h._rpcThrottlingRequestCount++;var g=function(a,g,k){var m={requests:encodeURIComponent(c.stringifyObject(a))};m.requests&&"null"!==m.requests&&(h.openRequests++,h.JSONP.get(e(h.resourceURL_GET),m,function(a){d(a,b,f)},null,function(){h.JSONP.get(e(h.resourceURL_GET),m,function(a){d(a,b,f)},null,function(){h.openRequests--},g,!0,k)},g,!0,k))};if(q&&q.getId()&&!c.getBcSessionId()&&
!c.getBcTempId()){q=new pa;x.clearQueue();for(var m=[],n=0;n<b.length;n++){var l=b[n];-1<[h.ADD_PROPERTIES,h.SET_PROPERTIES].indexOf(l.getMethod())&&(l.finished({}),m.push(l))}for(n=0;n<m.length;n++)c.removeItemFromArray(b,m[n]);if(0===b.length){f&&"function"===typeof f&&f.call(this);return}}for(var p=[],m=0;m<b.length;m++)y.call(p,b[m].getRPC()),b[m].setRevisionCookie();var r=function(k){a?(h.openRequests++,h.JSONP.post(e(h.resourceURL_POST),c.stringifyObject(p),function(a){d(a,b,f)},function(){h.openRequests--;
c.logWarning("CORS POST request failed, fallback on JSONP GET request.");g(p,!1,k)},!1,k)):g(p,!0,k)};h._csRequestDone?r():h.JSONP.get(h.resourceURL_CST,{},function(a){var b=null;a&&a[0]&&a[0].profileId&&(b=a[0].profileId,k&&c.logInfo("CS callback success; third-party cookie:"+b));h.thirdPartyCookieId=b;h._csRequestDone=!0;r(b)},null,function(){h._csRequestDone=!0;r()},!1,!1)}},g=function(a){for(var b=[],c=0,d=a.length;c<d;c++)for(var e=a[c].getTasks(),f=0,g=e.length;f<g;f++)e[f].isQueued()||(e[f].queued(),
y.call(b,e[f]));return b},n=h.batchRequests;a?(g=g.call(this,n),0<g.length&&f.call(this,g)):b.call(this,n);h.batchRequests=[]}};(function(){if("undefined"!==typeof bcSubscriptions&&c.isArray(bcSubscriptions)){for(var a=0,b=bcSubscriptions.length;a<b;a++){var d=bcSubscriptions[a];if(!c.isArray(d)||2!==d.length)return;u.subscribe(d[0],null,d[1])}bcSubscriptions={push:function(a){c.isArray(a)&&2===a.length&&u.subscribe(a[0],null,a[1])}}}})();(function(){if("complete"===document.readyState||"interactive"===
document.readyState)c.docReady();else if(document.addEventListener)document.addEventListener("readystatechange",function(){c.docReady()},!1),document.addEventListener("DOMContentLoaded",function(){c.docReady()},!1),p.addEventListener("load",function(){c.docReady()},!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",function(){c.docReady()});p.attachEvent("onload",function(){c.docReady()});var a=!1;try{a=null==p.frameElement}catch(b){}document.documentElement.doScroll&&a&&
c.docReady()}})();p.Sizzle&&(p.bcTempSizzle=p.Sizzle);(function(a){function b(a,b,c,d){var e,f,w,g,G,h=b&&b.ownerDocument,z=b?b.nodeType:9;c=c||[];if("string"!==typeof a||!a||1!==z&&9!==z&&11!==z)return c;if(!d&&((b?b.ownerDocument||b:Z)!==D&&L(b),b=b||D,aa)){if(11!==z&&(g=Fa.exec(a)))if(e=g[1])if(9===z)if(f=b.getElementById(e)){if(f.id===e)return c.push(f),c}else return c;else{if(h&&(f=h.getElementById(e))&&T(b,f)&&f.id===e)return c.push(f),c}else{if(g[2])return sa.apply(c,b.getElementsByTagName(a)),
c;if((e=g[3])&&F.getElementsByClassName&&b.getElementsByClassName)return sa.apply(c,b.getElementsByClassName(e)),c}if(!(!F.qsa||Y[a+" "]||N&&N.test(a))){if(1!==z)h=b,G=a;else if("object"!==b.nodeName.toLowerCase()){(w=b.getAttribute("id"))?w=w.replace(ya,za):b.setAttribute("id",w=H);f=Q(a);for(e=f.length;e--;)f[e]="#"+w+" "+u(f[e]);G=f.join(",");h=pa.test(a)&&q(b.parentNode)||b}if(G)try{return sa.apply(c,h.querySelectorAll(G)),c}catch($b){Y(a)}finally{w===H&&b.removeAttribute("id")}}}return X(a.replace(fa,
"$1"),b,c,d)}function c(){function a(c,d){b.push(c+" ")>C.cacheLength&&delete a[b.shift()];return a[c+" "]=d}var b=[];return a}function e(a){a[H]=!0;return a}function f(a){var b=D.createElement("fieldset");try{return!!a(b)}catch(G){return!1}finally{b.parentNode&&b.parentNode.removeChild(b)}}function g(a,b){a=a.split("|");for(var c=a.length;c--;)C.attrHandle[a[c]]=b}function h(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(d)return d;if(c)for(;c=c.nextSibling;)if(c===
b)return-1;return a?1:-1}function k(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function m(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function n(a){return function(b){return"form"in b?b.parentNode&&!1===b.disabled?"label"in b?"label"in b.parentNode?b.parentNode.disabled===a:b.disabled===a:b.isDisabled===a||b.isDisabled!==!a&&Ia(b)===a:b.disabled===a:"label"in b?b.disabled===a:!1}}function p(a){return e(function(b){b=
+b;return e(function(c,d){for(var e,f=a([],c.length,b),w=f.length;w--;)c[e=f[w]]&&(c[e]=!(d[e]=c[e]))})})}function q(a){return a&&"undefined"!==typeof a.getElementsByTagName&&a}function t(){}function u(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function v(a,b,c){var d=b.dir,e=b.next,f=e||d,w=c&&"parentNode"===f,g=ga++;return b.first?function(b,c,e){for(;b=b[d];)if(1===b.nodeType||w)return a(b,c,e);return!1}:function(b,c,h){var G,z,k=[la,g];if(h)for(;b=b[d];){if((1===b.nodeType||
w)&&a(b,c,h))return!0}else for(;b=b[d];)if(1===b.nodeType||w)if(z=b[H]||(b[H]={}),z=z[b.uniqueID]||(z[b.uniqueID]={}),e&&e===b.nodeName.toLowerCase())b=b[d]||b;else{if((G=z[f])&&G[0]===la&&G[1]===g)return k[2]=G[2];z[f]=k;if(k[2]=a(b,c,h))return!0}return!1}}function x(a){return 1<a.length?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function y(a,b,c,d,e){for(var f,w=[],g=0,h=a.length,G=null!=b;g<h;g++)if(f=a[g])if(!c||c(f,d,e))w.push(f),G&&b.push(g);return w}function A(a,
c,d,f,g,h){f&&!f[H]&&(f=A(f));g&&!g[H]&&(g=A(g,h));return e(function(e,w,h,G){var z,k,ea=[],m=[],n=w.length,p;if(!(p=e)){p=c||"*";for(var l=h.nodeType?[h]:h,q=[],r=0,Sa=l.length;r<Sa;r++)b(p,l[r],q);p=q}p=!a||!e&&c?p:y(p,ea,a,h,G);l=d?g||(e?a:n||f)?[]:w:p;d&&d(p,l,h,G);if(f)for(z=y(l,m),f(z,[],h,G),h=z.length;h--;)if(k=z[h])l[m[h]]=!(p[m[h]]=k);if(e){if(g||a){if(g){z=[];for(h=l.length;h--;)(k=l[h])&&z.push(p[h]=k);g(null,l=[],z,G)}for(h=l.length;h--;)(k=l[h])&&-1<(z=g?Ga(e,k):ea[h])&&(e[z]=!(w[z]=
k))}}else l=y(l===w?l.splice(n,l.length):l),g?g(null,w,l,G):sa.apply(w,l)})}function I(a){var b,c,d,e=a.length,f=C.relative[a[0].type];c=f||C.relative[" "];for(var g=f?1:0,w=v(function(a){return a===b},c,!0),h=v(function(a){return-1<Ga(b,a)},c,!0),k=[function(a,c,d){a=!f&&(d||c!==S)||((b=c).nodeType?w(a,c,d):h(a,c,d));b=null;return a}];g<e;g++)if(c=C.relative[a[g].type])k=[v(x(k),c)];else{c=C.filter[a[g].type].apply(null,a[g].matches);if(c[H]){for(d=++g;d<e&&!C.relative[a[d].type];d++);return A(1<
g&&x(k),1<g&&u(a.slice(0,g-1).concat({value:" "===a[g-2].type?"*":""})).replace(fa,"$1"),c,g<d&&I(a.slice(g,d)),d<e&&I(a=a.slice(d)),d<e&&u(a))}k.push(c)}return x(k)}function R(a,c){var d=0<c.length,f=0<a.length,g=function(e,g,h,w,G){var z,k,m,n=0,l="0",p=e&&[],ea=[],q=S,r=e||f&&C.find.TAG("*",G),Sa=la+=null==q?1:Math.random()||.1,t=r.length;for(G&&(S=g===D||g||G);l!==t&&null!=(z=r[l]);l++){if(f&&z){k=0;g||z.ownerDocument===D||(L(z),h=!aa);for(;m=a[k++];)if(m(z,g||D,h)){w.push(z);break}G&&(la=Sa)}d&&
((z=!m&&z)&&n--,e&&p.push(z))}n+=l;if(d&&l!==n){for(k=0;m=c[k++];)m(p,ea,g,h);if(e){if(0<n)for(;l--;)p[l]||ea[l]||(ea[l]=ra.call(w));ea=y(ea)}sa.apply(w,ea);G&&!e&&0<ea.length&&1<n+c.length&&b.uniqueSort(w)}G&&(la=Sa,S=q);return p};return d?e(g):g}var J,F,C,M,V,Q,W,X,S,K,P,L,D,ba,aa,N,O,U,T,H="sizzle"+1*new Date,Z=a.document,la=0,ga=0,ca=c(),ha=c(),ja=c(),Y=c(),ka=function(a,b){a===b&&(P=!0);return 0},qa={}.hasOwnProperty,Ha=[],ra=Ha.pop,ta=Ha.push,sa=Ha.push,oa=Ha.slice,Ga=function(a,b){for(var c=
0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},ua=/[\x20\t\r\n\f]+/g,fa=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,va=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,wa=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,xa=/=[\x20\t\r\n\f]*([^\]'"]*?)[\x20\t\r\n\f]*\]/g,Ba=/:((?:\\.|[\w-]|[^\x00-\xa0])+)(?:\((('((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)")|((?:\\.|[^\\()[\]]|\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^\x00-\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^\x00-\xa0])+))|)[\x20\t\r\n\f]*\])*)|.*)\)|)/,
Ca=/^(?:\\.|[\w-]|[^\x00-\xa0])+$/,ia={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:/^((?:\\.|[\w-]|[^\x00-\xa0])+|[*])/,ATTR:/^\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^\x00-\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^\x00-\xa0])+))|)[\x20\t\r\n\f]*\]/,PSEUDO:/^:((?:\\.|[\w-]|[^\x00-\xa0])+)(?:\((('((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)")|((?:\\.|[^\\()[\]]|\[[\x20\t\r\n\f]*((?:\\.|[\w-]|[^\x00-\xa0])+)(?:[\x20\t\r\n\f]*([*^$|!~]?=)[\x20\t\r\n\f]*(?:'((?:\\.|[^\\'])*)'|"((?:\\.|[^\\"])*)"|((?:\\.|[\w-]|[^\x00-\xa0])+))|)[\x20\t\r\n\f]*\])*)|.*)\)|)/,
CHILD:/^:(only|first|last|nth|nth-last)-(child|of-type)(?:\([\x20\t\r\n\f]*(even|odd|(([+-]|)(\d*)n|)[\x20\t\r\n\f]*(?:([+-]|)[\x20\t\r\n\f]*(\d+)|))[\x20\t\r\n\f]*\)|)/i,bool:/^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$/i,needsContext:/^[\x20\t\r\n\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i},Da=/^(?:input|select|textarea|button)$/i,Ea=/^h\d$/i,da=
/^[^{]+\{\s*\[native \w/,Fa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,pa=/[+~]/,ma=/\\([\da-f]{1,6}[\x20\t\r\n\f]?|([\x20\t\r\n\f])|.)/ig,na=function(a,b,c){a="0x"+b-65536;return a!==a||c?b:0>a?String.fromCharCode(a+65536):String.fromCharCode(a>>10|55296,a&1023|56320)},ya=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,za=function(a,b){return b?"\x00"===a?"�":a.slice(0,-1)+"\\"+a.charCodeAt(a.length-1).toString(16)+" ":"\\"+a},Aa=function(){L()},Ia=v(function(a){return!0===a.disabled&&"fieldset"===
a.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{sa.apply(Ha=oa.call(Z.childNodes),Z.childNodes),Ha[Z.childNodes.length].nodeType}catch(w){sa={apply:Ha.length?function(a,b){ta.apply(a,oa.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}F=b.support={};V=b.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1};L=b.setDocument=function(a){var b;a=a?a.ownerDocument||a:Z;if(a===D||9!==a.nodeType||!a.documentElement)return D;
D=a;ba=D.documentElement;aa=!V(D);Z!==D&&(b=D.defaultView)&&b.top!==b&&(b.addEventListener?b.addEventListener("unload",Aa,!1):b.attachEvent&&b.attachEvent("onunload",Aa));F.attributes=f(function(a){a.className="i";return!a.getAttribute("className")});F.getElementsByTagName=f(function(a){a.appendChild(D.createComment(""));return!a.getElementsByTagName("*").length});F.getElementsByClassName=da.test(D.getElementsByClassName);F.getById=f(function(a){ba.appendChild(a).id=H;return!D.getElementsByName||
!D.getElementsByName(H).length});F.getById?(C.filter.ID=function(a){var b=a.replace(ma,na);return function(a){return a.getAttribute("id")===b}},C.find.ID=function(a,b){if("undefined"!==typeof b.getElementById&&aa)return(a=b.getElementById(a))?[a]:[]}):(C.filter.ID=function(a){var b=a.replace(ma,na);return function(a){return(a="undefined"!==typeof a.getAttributeNode&&a.getAttributeNode("id"))&&a.value===b}},C.find.ID=function(a,b){if("undefined"!==typeof b.getElementById&&aa){var c,d,e=b.getElementById(a);
if(e){if((c=e.getAttributeNode("id"))&&c.value===a)return[e];d=b.getElementsByName(a);for(b=0;e=d[b++];)if((c=e.getAttributeNode("id"))&&c.value===a)return[e]}return[]}});C.find.TAG=F.getElementsByTagName?function(a,b){if("undefined"!==typeof b.getElementsByTagName)return b.getElementsByTagName(a);if(F.qsa)return b.querySelectorAll(a)}:function(a,b){var c=[],d=0;b=b.getElementsByTagName(a);if("*"===a){for(;a=b[d++];)1===a.nodeType&&c.push(a);return c}return b};C.find.CLASS=F.getElementsByClassName&&
function(a,b){if("undefined"!==typeof b.getElementsByClassName&&aa)return b.getElementsByClassName(a)};O=[];N=[];if(F.qsa=da.test(D.querySelectorAll))f(function(a){ba.appendChild(a).innerHTML="\x3ca id\x3d'"+H+"'\x3e\x3c/a\x3e\x3cselect id\x3d'"+H+"-\r\\' msallowcapture\x3d''\x3e\x3coption selected\x3d''\x3e\x3c/option\x3e\x3c/select\x3e";a.querySelectorAll("[msallowcapture^\x3d'']").length&&N.push("[*^$]\x3d[\\x20\\t\\r\\n\\f]*(?:''|\"\")");a.querySelectorAll("[selected]").length||N.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");
a.querySelectorAll("[id~\x3d"+H+"-]").length||N.push("~\x3d");a.querySelectorAll(":checked").length||N.push(":checked");a.querySelectorAll("a#"+H+"+*").length||N.push(".#.+[+~]")}),f(function(a){a.innerHTML="\x3ca href\x3d'' disabled\x3d'disabled'\x3e\x3c/a\x3e\x3cselect disabled\x3d'disabled'\x3e\x3coption/\x3e\x3c/select\x3e";var b=D.createElement("input");b.setAttribute("type","hidden");a.appendChild(b).setAttribute("name","D");a.querySelectorAll("[name\x3dd]").length&&N.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?\x3d");
2!==a.querySelectorAll(":enabled").length&&N.push(":enabled",":disabled");ba.appendChild(a).disabled=!0;2!==a.querySelectorAll(":disabled").length&&N.push(":enabled",":disabled");a.querySelectorAll("*,:x");N.push(",.*:")});(F.matchesSelector=da.test(U=ba.matches||ba.webkitMatchesSelector||ba.mozMatchesSelector||ba.oMatchesSelector||ba.msMatchesSelector))&&f(function(a){F.disconnectedMatch=U.call(a,"*");U.call(a,"[s!\x3d'']:x");O.push("!\x3d",":((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?\x3d)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)")});
N=N.length&&new RegExp(N.join("|"));O=O.length&&new RegExp(O.join("|"));T=(b=da.test(ba.compareDocumentPosition))||da.test(ba.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a;b=b&&b.parentNode;return a===b||!!(b&&1===b.nodeType&&(c.contains?c.contains(b):a.compareDocumentPosition&&a.compareDocumentPosition(b)&16))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};ka=b?function(a,b){if(a===b)return P=!0,0;var c=!a.compareDocumentPosition-!b.compareDocumentPosition;
if(c)return c;c=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;return c&1||!F.sortDetached&&b.compareDocumentPosition(a)===c?a===D||a.ownerDocument===Z&&T(Z,a)?-1:b===D||b.ownerDocument===Z&&T(Z,b)?1:K?Ga(K,a)-Ga(K,b):0:c&4?-1:1}:function(a,b){if(a===b)return P=!0,0;var c=0,d=a.parentNode,e=b.parentNode,f=[a],g=[b];if(!d||!e)return a===D?-1:b===D?1:d?-1:e?1:K?Ga(K,a)-Ga(K,b):0;if(d===e)return h(a,b);for(;a=a.parentNode;)f.unshift(a);for(a=b;a=a.parentNode;)g.unshift(a);
for(;f[c]===g[c];)c++;return c?h(f[c],g[c]):f[c]===Z?-1:g[c]===Z?1:0};return D};b.matches=function(a,c){return b(a,null,null,c)};b.matchesSelector=function(a,c){(a.ownerDocument||a)!==D&&L(a);c=c.replace(xa,"\x3d'$1']");if(!(!F.matchesSelector||!aa||Y[c+" "]||O&&O.test(c)||N&&N.test(c)))try{var d=U.call(a,c);if(d||F.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(ea){Y(c)}return 0<b(c,D,null,[a]).length};b.contains=function(a,b){(a.ownerDocument||a)!==D&&L(a);return T(a,b)};
b.attr=function(a,b){(a.ownerDocument||a)!==D&&L(a);var c=C.attrHandle[b.toLowerCase()],c=c&&qa.call(C.attrHandle,b.toLowerCase())?c(a,b,!aa):E;return c!==E?c:F.attributes||!aa?a.getAttribute(b):(c=a.getAttributeNode(b))&&c.specified?c.value:null};b.escape=function(a){return(a+"").replace(ya,za)};b.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};b.uniqueSort=function(a){var b,c=[],d=0,e=0;P=!F.detectDuplicates;K=!F.sortStable&&a.slice(0);a.sort(ka);if(P){for(;b=a[e++];)b===
a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}K=null;return a};M=b.getText=function(a){var b,c="",d=0;b=a.nodeType;if(!b)for(;b=a[d++];)c+=M(b);else if(1===b||9===b||11===b){if("string"===typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=M(a)}else if(3===b||4===b)return a.nodeValue;return c};C=b.selectors={cacheLength:50,createPseudo:e,match:ia,attrHandle:{},find:{},relative:{"\x3e":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},
"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){a[1]=a[1].replace(ma,na);a[3]=(a[3]||a[4]||a[5]||"").replace(ma,na);"~\x3d"===a[2]&&(a[3]=" "+a[3]+" ");return a.slice(0,4)},CHILD:function(a){a[1]=a[1].toLowerCase();"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]);return a},PSEUDO:function(a){var b,c=!a[6]&&a[2];if(ia.CHILD.test(a[0]))return null;a[3]?a[2]=a[4]||a[5]||"":c&&Ba.test(c)&&
(b=Q(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b));return a.slice(0,3)}},filter:{TAG:function(a){var b=a.replace(ma,na).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=ca[a+" "];return b||(b=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"),ca(a,function(a){return b.test("string"===typeof a.className&&a.className||"undefined"!==typeof a.getAttribute&&a.getAttribute("class")||
"")}))},ATTR:function(a,c,d){return function(e){e=b.attr(e,a);if(null==e)return"!\x3d"===c;if(!c)return!0;e+="";return"\x3d"===c?e===d:"!\x3d"===c?e!==d:"^\x3d"===c?d&&0===e.indexOf(d):"*\x3d"===c?d&&-1<e.indexOf(d):"$\x3d"===c?d&&e.slice(-d.length)===d:"~\x3d"===c?-1<(" "+e.replace(ua," ")+" ").indexOf(d):"|\x3d"===c?e===d||e.slice(0,d.length+1)===d+"-":!1}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:
function(b,c,k){var m,w,l,n,p;c=f!==g?"nextSibling":"previousSibling";var z=b.parentNode,q=h&&b.nodeName.toLowerCase();k=!k&&!h;m=!1;if(z){if(f){for(;c;){for(l=b;l=l[c];)if(h?l.nodeName.toLowerCase()===q:1===l.nodeType)return!1;p=c="only"===a&&!p&&"nextSibling"}return!0}p=[g?z.firstChild:z.lastChild];if(g&&k)for(l=z,w=l[H]||(l[H]={}),w=w[l.uniqueID]||(w[l.uniqueID]={}),m=w[a]||[],m=(n=m[0]===la&&m[1])&&m[2],l=n&&z.childNodes[n];l=++n&&l&&l[c]||(m=n=0)||p.pop();){if(1===l.nodeType&&++m&&l===b){w[a]=
[la,n,m];break}}else if(k&&(l=b,w=l[H]||(l[H]={}),w=w[l.uniqueID]||(w[l.uniqueID]={}),m=w[a]||[],m=n=m[0]===la&&m[1]),!1===m)for(;(l=++n&&l&&l[c]||(m=n=0)||p.pop())&&((h?l.nodeName.toLowerCase()!==q:1!==l.nodeType)||!++m||(k&&(w=l[H]||(l[H]={}),w=w[l.uniqueID]||(w[l.uniqueID]={}),w[a]=[la,m]),l!==b)););m-=e;return m===d||0===m%d&&0<=m/d}}},PSEUDO:function(a,c){var d,f=C.pseudos[a]||C.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[H]?f(c):1<f.length?(d=[a,a,"",c],C.setFilters.hasOwnProperty(a.toLowerCase())?
e(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=Ga(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,d)}):f}},pseudos:{not:e(function(a){var b=[],c=[],d=W(a.replace(fa,"$1"));return d[H]?e(function(a,b,c,e){e=d(a,null,e,[]);for(var f=a.length;f--;)if(c=e[f])a[f]=!(b[f]=c)}):function(a,e,f){b[0]=a;d(b,null,f,c);b[0]=null;return!c.pop()}}),has:e(function(a){return function(c){return 0<b(a,c).length}}),contains:e(function(a){a=a.replace(ma,na);return function(b){return-1<(b.textContent||b.innerText||
M(b)).indexOf(a)}}),lang:e(function(a){Ca.test(a||"")||b.error("unsupported lang: "+a);a=a.replace(ma,na).toLowerCase();return function(b){var c;do if(c=aa?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===ba},focus:function(a){return a===D.activeElement&&(!D.hasFocus||D.hasFocus())&&
!!(a.type||a.href||~a.tabIndex)},enabled:n(!1),disabled:n(!0),checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(6>a.nodeType)return!1;return!0},parent:function(a){return!C.pseudos.empty(a)},header:function(a){return Ea.test(a.nodeName)},input:function(a){return Da.test(a.nodeName)},button:function(a){var b=
a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:p(function(){return[0]}),last:p(function(a,b){return[b-1]}),eq:p(function(a,b,c){return[0>c?c+b:c]}),even:p(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:p(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:p(function(a,b,c){for(b=0>c?c+b:c;0<=--b;)a.push(b);
return a}),gt:p(function(a,b,c){for(c=0>c?c+b:c;++c<b;)a.push(c);return a})}};C.pseudos.nth=C.pseudos.eq;for(J in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[J]=k(J);for(J in{submit:!0,reset:!0})C.pseudos[J]=m(J);t.prototype=C.filters=C.pseudos;C.setFilters=new t;Q=b.tokenize=function(a,c){var d,e,f,g,h,k,l;if(h=ha[a+" "])return c?0:h.slice(0);h=a;k=[];for(l=C.preFilter;h;){if(!d||(e=va.exec(h)))e&&(h=h.slice(e[0].length)||h),k.push(f=[]);d=!1;if(e=wa.exec(h))d=e.shift(),f.push({value:d,
type:e[0].replace(fa," ")}),h=h.slice(d.length);for(g in C.filter)!(e=ia[g].exec(h))||l[g]&&!(e=l[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):ha(a,k).slice(0)};W=b.compile=function(a,b){var c,d=[],e=[],f=ja[a+" "];if(!f){b||(b=Q(a));for(c=b.length;c--;)f=I(b[c]),f[H]?d.push(f):e.push(f);f=ja(a,R(e,d));f.selector=a}return f};X=b.select=function(a,b,c,d){var e,f,g,h,k="function"===typeof a&&a,l=!d&&Q(a=k.selector||a);c=c||[];
if(1===l.length){f=l[0]=l[0].slice(0);if(2<f.length&&"ID"===(g=f[0]).type&&9===b.nodeType&&aa&&C.relative[f[1].type]){b=(C.find.ID(g.matches[0].replace(ma,na),b)||[])[0];if(!b)return c;k&&(b=b.parentNode);a=a.slice(f.shift().value.length)}for(e=ia.needsContext.test(a)?0:f.length;e--;){g=f[e];if(C.relative[h=g.type])break;if(h=C.find[h])if(d=h(g.matches[0].replace(ma,na),pa.test(f[0].type)&&q(b.parentNode)||b)){f.splice(e,1);a=d.length&&u(f);if(!a)return sa.apply(c,d),c;break}}}(k||W(a,l))(d,b,!aa,
c,!b||pa.test(a)&&q(b.parentNode)||b);return c};F.sortStable=H.split("").sort(ka).join("")===H;F.detectDuplicates=!!P;L();F.sortDetached=f(function(a){return a.compareDocumentPosition(D.createElement("fieldset"))&1});f(function(a){a.innerHTML="\x3ca href\x3d'#'\x3e\x3c/a\x3e";return"#"===a.firstChild.getAttribute("href")})||g("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)});F.attributes&&f(function(a){a.innerHTML="\x3cinput/\x3e";a.firstChild.setAttribute("value",
"");return""===a.firstChild.getAttribute("value")})||g("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue});f(function(a){return null==a.getAttribute("disabled")})||g("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(a,b,c){var d;if(!c)return!0===a[b]?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null});var Ja=a.Sizzle;b.noConflict=function(){a.Sizzle===b&&(a.Sizzle=
Ja);return b};a.Sizzle=b})(p);var Yb=p.Sizzle;try{p.bcTempSizzle?(p.Sizzle=p.bcTempSizzle,delete p.bcTempSizzle):delete p.Sizzle}catch(a){}var v=p.blueConicClient=A.getBlueConicClient();v.fn.setRequestInfo({});(function(){var a=function(){A.publishPlainEventAndCallHook("onBlueConicLoaded");u.publish(u.ON_BEFORE_PRELISTENERS);A.checkPreListeners();var a=!1,b=!1;k&&c.logInfo("start pageview event");v.createEvent("PAGEVIEW",null,this,function(d){if(!d||0==d.length){k&&c.logInfo("the pageview event did not return any interacion, check if the channel is configured");
var e=document.getElementById(bb);e&&(e.parentNode.removeChild(e),k&&c.logInfo("removed css for phase 1"))}k&&c.logInfo("[+] finished pageview event ["+d.length+" interactions to run]");ra=d;a=!0;k&&c.logInfo("start hide positions mechanism for positions claimed by the configured interactions");d=[];for(var e=0,f=ra.length;e<f;e++){var h=ra[e].getPosition();h&&y.call(d,h)}c.addCSSToDOM(d,tb,2E3);p.setTimeout(function(){var a=document.getElementById(bb);a&&a.parentNode.removeChild(a)},1);b=!1;k&&c.logInfo("start plugin download from url [/plugin/plugin] with version ["+
Ja+"]");d=I?BC_URL:V();d=Ja?d+"/plugin/plugin/"+Ja:d+"/plugin/plugin";I&&(d+="_e");c.loadScript(d,this,function(){k&&c.logInfo("finished plugin download");b=!0;b&&a&&(q||c.log("Profile is not initialized"),Qa(ra,!0))})})};mb=null!==ua();var b=c.getBcSessionId();b||(b=null);q=new pa(b);I?h.JSONP.get(BC_URL+"/frontend/e",null,function(b){b||(I=!1,jb=ib());I&&p.name&&-1<p.name.indexOf("bc_simulator")?c.loadScript(BC_URL+"/simulatordevice",null,function(){a()}):a()}):a()})()}})(window,this.bcVerbose,
this.bcChannelIdentifier,this.bcRpcMode,this.bcCSEnabled,this.bcHostname,getDG()||{},getP()||{},window.blueConicPreListeners);
})();


}
/*
     FILE ARCHIVED ON 04:46:55 Oct 07, 2021 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 03:36:11 Oct 17, 2021.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  exclusion.robots: 0.076
  exclusion.robots.policy: 0.067
  RedisCDXSource: 0.721
  esindex: 0.01
  LoadShardBlock: 405.186 (6)
  PetaboxLoader3.datanode: 223.688 (7)
  CDXLines.iter: 15.395 (3)
  load_resource: 103.39
  PetaboxLoader3.resolve: 55.893
*/