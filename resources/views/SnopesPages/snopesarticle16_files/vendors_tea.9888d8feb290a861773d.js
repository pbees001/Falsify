(window["bytedance_secsdk_captcha_jsonp_2.23.3"]=window["bytedance_secsdk_captcha_jsonp_2.23.3"]||[]).push([[3],{440:function(e,t,i){"use strict";i.r(t),i.d(t,"Collector",function(){return gt});var n=function(){return(n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,o,r=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=r.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}return s}function r(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e}var s,a=(function(e,t){var i;i=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function i(n){function o(){}function r(t,i,r){if("undefined"!=typeof document){"number"==typeof(r=e({path:"/"},o.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var s=JSON.stringify(i);/^[\{\[]/.test(s)&&(i=s)}catch(e){}i=n.write?n.write(i,t):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var c in r)r[c]&&(a+="; "+c,!0!==r[c]&&(a+="="+r[c].split(";")[0]));return document.cookie=t+"="+i+a}}function s(e,i){if("undefined"!=typeof document){for(var o={},r=document.cookie?document.cookie.split("; "):[],s=0;s<r.length;s++){var a=r[s].split("="),c=a.slice(1).join("=");i||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=t(a[0]);if(c=(n.read||n)(c,u)||t(c),i)try{c=JSON.parse(c)}catch(e){}if(o[u]=c,e===u)break}catch(e){}}return e?o[e]:o}}return o.set=r,o.get=function(e){return s(e,!1)},o.getJSON=function(e){return s(e,!0)},o.remove=function(t,i){r(t,"",e(i,{expires:-1}))},o.defaults={},o.withConverter=i,o}(function(){})},e.exports=i()}(s={exports:{}}),s.exports),c=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e}(),u={getItem:function(e){try{var t=localStorage.getItem(e),i=t;try{t&&"string"==typeof t&&(i=JSON.parse(t))}catch(e){}return i||void 0}catch(e){}},setItem:function(e,t){try{var i="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,i)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){try{return a.get(e,{domain:t||document.domain})}catch(e){return""}},setCookie:function(e,t,i,n){try{var o=n||document.domain,r=+new Date+i;a.set(e,t,{expires:new Date(r),path:"/",domain:o})}catch(e){}},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(be){return!1}}()},h={getItem:function(e){try{var t=sessionStorage.getItem(e),i=t;try{t&&"string"==typeof t&&(i=JSON.parse(t))}catch(e){}return i||void 0}catch(e){}},setItem:function(e,t){try{var i="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,i)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(be){return!1}}()},l=function(){function e(e,t){this._storage=t&&"session"===t?h:!e&&u.isSupportLS?u:new c}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,i,n){this._storage.setCookie(e,t,i,n)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),d={sg:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z21z1ez4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z24z18z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k",in:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z49z24z18z49z23z21z1cz18z21z22z4ez18z4az22z1gz1iz22z1mz1iz24z4az1az1mz1k"},p="/v1/user/webid",f="/v1/list",_="4.1.38_tcpy",m={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005},g=function(e,t){return t?"__tea_cache_tokens_"+e:"__tea_cache_events_"+e},v=function(e){return"__tea_session_id_"+e},z=function(e){return"__tea_cache_config_"+e},y=function(){if("undefined"!=typeof window)return window.TeaAnalyticsObject},b={va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",in:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},w="__shushuo_libra_style__",k="v1/list_test",E="1fz22z22z1nz21z4mz4bz4bz21z1dz4dz4iz49z21z1az1kz1az1bz1lz49z24z18z4az1gz19z27z22z1cz1bz22z1mz21z4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az49z23z21z4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1az1mz20z1cz4az1hz21",S="1fz22z22z1nz21z4mz4bz4bz21z1dz4dz4iz49z21z1az1kz1az1bz1lz49z24z18z4az1gz19z27z22z1cz1bz22z1mz21z4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az49z23z21z4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1fz1cz18z22z1kz18z1nz49z1az1mz20z1cz4az1hz21";function I(e,t,i,n,o,r,s,a){try{var c=new XMLHttpRequest,u=a||"POST";c.open(u,""+e,!0),c.setRequestHeader("Content-Type","application/json; charset=utf-8"),o&&c.setRequestHeader("X-MCS-AppKey",""+o),s&&(c.withCredentials=!0),c.onload=function(){if(i){var e=null;if(c.responseText){try{e=JSON.parse(c.responseText)}catch(t){e={}}i(e)}}},r&&(c.timeout=r),r&&(c.ontimeout=function(){n&&n(t,m.TIMEOUT)}),c.onerror=function(){c.abort(),n&&n(t,m.XHR_ON)},c.send(JSON.stringify(t))}catch(e){}}var T=function(e,t,i,n){try{var o,r=e.match(/\/v\d\//);o=r?r[0]:-1!==e.indexOf("/v1/")?"/v1/":"/v2/";var s=e.split(o)[0];if(!s)return void n(e,t,m.NO_URL);t.forEach(function(o){var r=function(e){var t="";for(var i in e)e.hasOwnProperty(i)&&void 0!==e[i]&&(t+="&"+i+"="+encodeURIComponent(JSON.stringify(e[i])));return"&"===t[0]?t.slice(1):t}(o),a=new Image(1,1);a.onload=function(){a=null,i&&i()},a.onerror=function(){a=null,n&&n(e,t,m.IMG_ON)},a.src=s+"/v1/gif?"+r})}catch(i){n&&n(e,t,m.IMG_CATCH,i.message)}},O=function(e,t,i,n,o,r,s,a,c,u){var h=window.navigator.userAgent,l=-1!==window.navigator.appName.indexOf("Microsoft Internet Explorer")&&(-1!==h.indexOf("MSIE 8.0")||-1!==h.indexOf("MSIE 9.0")),d=!!n;if(!d&&l)T(e,i,o,r);else if(!d&&a)return window.navigator&&window.navigator.sendBeacon?(u&&u(),void(window.navigator.sendBeacon(e,JSON.stringify(i))?o():r(e,i,m.BEACON_FALSE))):void T(e,i,o,r);s&&delete i.app_key,I(e,i,o,r,n,t,c)};function x(e){return e?(e^16*Math.random()>>e/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,x)}var C=function(){return x().replace(/-/g,"").slice(0,19)},A=function(e){return function(e,t,i){if("string"==typeof e&&"number"==typeof i){var n,o=[];i=i<=25?i:i%25;var r=String.fromCharCode(i+97);n=e.split(r);for(var s=0;s<n.length;s++){var a=parseInt(n[s],i);a=1*a^64;var c=String.fromCharCode(a);o.push(c)}return o.join("")}}(e,0,25)},N=function(){function e(e,t,i,n){this.config=e,this.cfg=t,this.storage=new l(!1),this.appInfo=e.app_key||e.app_id,this.isNoWebid=e.disable_webid,this.enable_ttwebid=e.enable_ttwebid||!1,this.domain=e.channel_domain||A(d[e.channel]),this.tokenReady=!1,this.checkExp=e.checkExp||!1,this.enableCookie=e.cross_subdomain||!1,this.expiresTime=94608e6,this.fetchUrl=""+this.domain+p,this.hook=i,this.session=n,this.cookieDomain=e.cookie_domain||""}return e.prototype._getToken=function(){this.tokensKey=g(this.appInfo,!0),this.cookieKey="__tea_cookie_tokens_"+this.appInfo;var e=this.storage.getItem(this.tokensKey),t=this.storage.getCookie(this.cookieKey,this.cookieDomain);if(this.enable_ttwebid)if(e){var i={user_unique_id:e.user_unique_id||"",timestamp:Date.now()};this.storage.setItem(this.tokensKey,i),this._setTtWid(e,!1)}else this._setTtWid(e,!0);else if(this.enableCookie)if(t){var n=(t=JSON.parse(decodeURIComponent(t))).user_unique_id,o=t.web_id,r=t.timestamp;this._setToken(o,n,r)}else{if(!e)return void this._requestWebId();this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(e)),this.expiresTime,this.cookieDomain),this._checkLocal(e)}else{if(!e)return void this._requestWebId();this._checkLocal(e)}},e.prototype._checkLocal=function(e){var t=e.user_unique_id,i=e.web_id,n=e.timestamp;i&&t?this._setToken(i,t,n):this._requestWebId()},e.prototype._setToken=function(e,t,i){if(this.checkExp){var n=Date.now()-parseFloat(i);if(n>7344e6)return void this._requestWebId();if(n>432e7)return void this._updateWebId(e)}this.cfg.envInfo.user.user_unique_id=t,this.cfg.envInfo.user.web_id=e,this.storage.setItem(this.tokensKey,{user_unique_id:t,web_id:e,timestamp:Date.now()}),this.tokenReady=!0},e.prototype._requestWebId=function(){this.isNoWebid?this._setTokenId(C()):this._fetchWebId(this.fetchUrl,!1)},e.prototype._updateWebId=function(e){var t=""+this.domain+p+"/"+e+"/update";this._fetchWebId(t,!0)},e.prototype._fetchWebId=function(e,t){var i=this;O(e,3e3,{app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""},this.config.app_key,function(e){e&&0===e.e?i._setTokenId(e.web_id):(i.hook.emit("token-error"),console.warn("[]appid: "+i.config.app_id+", "+(t?" update":"get")+" webid error, init error~"))},function(){i.hook.emit("token-error"),console.warn("[]appid: "+i.config.app_id+", get webid error, init error~")},!0,!1,this.enable_ttwebid)},e.prototype._setTtWid=function(e,t){if(!t){var i={web_id:e.web_id||"",timestamp:Date.now()},n=e.user_unique_id||"";this.cfg.envInfo.user.user_unique_id=this.cfg.envInfo.user.user_unique_id||n,this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(i)),108e5,this.cookieDomain)}this.tokenReady=!0,this.hook.emit("token-ready")},e.prototype._setTokenId=function(e){var t=this.cfg.envInfo.user.web_id||e,i={web_id:t,user_unique_id:this.cfg.envInfo.user.user_unique_id||t,timestamp:Date.now()};this.enableCookie&&this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(i)),this.expiresTime,this.cookieDomain),this.storage.setItem(this.tokensKey,i),this.cfg.envInfo.user.web_id=this.cfg.envInfo.user.web_id||t,this.cfg.envInfo.user.user_unique_id=this.cfg.envInfo.user.user_unique_id||t,this.tokenReady=!0,this.hook.emit("token-ready")},e.prototype._setUuid=function(e){try{var t=this.storage.getItem(this.tokensKey);if(e){"string"!=typeof e&&console.warn("user_unique_id must be string!!! please check");var i=String(e);this.cfg.envInfo.user.user_unique_id=i,t&&t.user_unique_id?t.user_unique_id!==i&&(t.user_unique_id=i,this.hook.emit("uuid-change")):((t={}).user_unique_id=i,this.hook.emit("uuid-change")),t.timestamp=Date.now(),this.storage.setItem(this.tokensKey,t),this.session._resetSessionId()}else this._clearUuid(t)}catch(e){}},e.prototype._clearUuid=function(e){this.enable_ttwebid||e&&e.web_id&&(this.cfg.envInfo.user.user_unique_id=e.web_id,e.user_unique_id=e.web_id,e.timestamp=Date.now(),this.storage.setItem(this.tokensKey,e))},e.prototype._setWebid=function(e){if(!this.enable_ttwebid){var t=this.storage.getItem(this.tokensKey),i=!1;t&&t.web_id?t.web_id!==e&&(t.user_unique_id=t.web_id===t.user_unique_id?e:t.user_unique_id,t.web_id=e,this.cfg.envInfo.user.user_unique_id&&this.cfg.envInfo.user.user_unique_id!==this.cfg.envInfo.user.web_id||(this.cfg.envInfo.user.user_unique_id=e,i=!0)):(t={}).web_id=e,t.timestamp=Date.now(),this.cfg.envInfo.user.web_id=e,this.storage.setItem(this.tokensKey,t),i&&this.hook.emit("uuid-change")}},e.prototype.isTokenReady=function(){return this.tokenReady},e.prototype._getTobId=function(e){var t=this.domain+"/tobid";O(t,3e4,{app_id:this.config.app_id,user_unique_id:this.cfg.envInfo.user.user_unique_id,web_id:this.cfg.envInfo.user.web_id},this.config.app_key,function(t){t&&0===t.e?e(t.tobid):e(null)},function(){e(null)},!0,!1,this.enable_ttwebid)},e}(),V=function(e){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)},D=function(e,t,i){void 0===e&&(e=[]),void 0===t&&(t=function(e){return e}),void 0===i&&(i=20);var n,o=[],r=0;return e.forEach(function(e){var s=t(e);void 0===n?n=s:(s!==n||o[r].length>=i)&&(r+=1,n=s),o[r]=o[r]||[],o[r].push(e)}),o},j=function(){function e(e,t,i,n,o,r){this.collect=e,this.cfg=i,this.config=t,this._token=n,this.appInfo=t.app_key||t.app_id,this.debugMode=!!t.log,this.evtDataKey=g(this.appInfo,!1);var s=t.channel_domain||A(d[t.channel]);if(this.reportUrl=t.report_url?t.report_url:""+s+f,this.storage=new l(!0),this.EventStorage=new l(!1),this.maxStorage=t.max_storage_num||-1,this.maxReport=t.max_report||20,this.reportTime=t.reportTime||30,this.timeout=t.timeout||0,this.closeStorage=!0,this.session=r,this.plugin=o,this.withCredentials=t.enable_ttwebid,this.plugin){var a=t.enable_storage,c=t.disable_storage;(a||!1===c)&&(this.closeStorage=!1)}this.addListener()}return e.prototype.addListener=function(){var e=this;window.addEventListener("unload",function(){e.report(!0)},!1),V(function(){e.report(!0)}),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&e.report(!0)},!1)},e.prototype.setReady=function(){this.isReady=!0,this.closeStorage||this.checkStorageEvent(),this.report()},e.prototype.event=function(e){var t=this;void 0===e&&(e=[]);var i=r(e,this.storage.getItem(this.evtDataKey)||[]);this.storage.setItem(this.evtDataKey,i),this.reportTimer&&clearTimeout(this.reportTimer),i.length>=this.maxReport?this.report(!1):this.reportTimer=setTimeout(function(){t.report(!1),t.reportTimer=null},this.reportTime)},e.prototype.beconEvent=function(e){void 0===e&&(e=[]);var t=this._mergeEvents(e);this._dealData(t,!0)},e.prototype.report=function(e){if(void 0===e&&(e=!1),!this.collect.destroyInstance&&this._token.isTokenReady()&&this.isReady){var t=this.storage.getItem(this.evtDataKey)||[],i=this._mergeEvents(t);this.storage.removeItem(this.evtDataKey),this._dealData(i,e)}},e.prototype._mergeEvents=function(e){var t=this;if(!e.length)return e;var i=this.cfg.get();return i.header.custom=JSON.stringify(i.header.custom),D(e,function(e){return!t.closeStorage&&!!e.params.__disable_storage__},this.maxReport).map(function(e){return n({events:e.map(function(e){var i=n({},t.cfg.get("evtParams"),e.params);delete i.__disable_storage__;var o=[];return t.plugin&&t.plugin.ab&&t.plugin.ab.versions&&t.plugin.ab.extVersions&&(o=-1!==window.location.href.indexOf("multilink=true")?t.plugin.ab.mulilinkVersions.concat(t.plugin.ab.extVersions):t.plugin.ab.versions.concat(t.plugin.ab.extVersions)),n({},e,{params:JSON.stringify(i),ab_sdk_version:o.join(","),session_id:t.session._getSessionId()})}),user:i.user,header:i.header},t.closeStorage?{}:{__disable_storage__:e[0].params.__disable_storage__},{verbose:t.debugMode?1:void 0})})},e.prototype._dealData=function(e,t){var i=this;if(!e.length)return e;var n=[];n=D(e,function(e){return!!e.__disable_storage__},this.maxReport),!this.closeStorage&&this.plugin.maxStorage&&this.plugin.maxStorage(n,this.maxStorage,this.evtDataKey,this.storage);var o={};n.forEach(function(e){var n=C();if(!i.closeStorage&&!e[0].__disable_storage__){var r=JSON.parse(JSON.stringify(e));r&&r[0]&&(r[0].header.__storage_index__=Date.now()),o[n]=r,i.EventStorage.setItem(i.evtDataKey,o)}i._send(n,e,t)})},e.prototype._send=function(e,t,i){var n=this;this.isSending=!0;var o=function(){n.isSending=!1};if(!this.closeStorage)try{t&&t[0]&&t[0].header.__storage_index__&&delete(t=JSON.parse(JSON.stringify(t)))[0].header.__storage_index__}catch(e){}this.plugin&&this.plugin.et_test&&this.plugin.et_test.send(t),O(this.reportUrl,this.timeout,t,this.config.app_key,function(){if(o(),n.plugin&&!n.closeStorage){var t=n.EventStorage.getItem(n.evtDataKey)||{};Object.keys(t).length?(delete t[e],n.EventStorage.setItem(n.evtDataKey,t)):n.EventStorage.removeItem(n.evtDataKey)}},function(e,t){o(),n.cfg.get("reportErrorCallback")(e,t),n.plugin&&n.plugin.monitor&&n.plugin.monitor.sdkError(n.config.app_key,n.reportUrl,e,t)},!1,i,this.withCredentials,o),this.plugin&&this.plugin.monitor&&this.plugin.monitor.sdkOnload(this.config.app_key,this.reportUrl,t)},e.prototype.checkStorageEvent=function(){var e=this;try{var t=this.EventStorage.getItem(this.evtDataKey)||{},i=Object.keys(t);i.length>0&&setTimeout(function n(){for(var o=[],r=0;r<e.maxReport;r++)i.length>0&&o.push(i.shift());o.length>0&&o.forEach(function(i){e._send(i,t[i],!1)}),setTimeout(n,5)},5)}catch(e){}},e}(),P=function(e,t){var i,n,o=function(e){var t=document.createElement("a");return t.href=e,t},r=window.screen.width,s=window.screen.height,a=window.navigator.appVersion,c=window.navigator.userAgent,u=window.navigator.language,h=document.referrer,d=h?o(h).hostname:"",p=function(e){var t=o(e).search;t=t.slice(1);var i={};return t.split("&").forEach(function(e){var t,n,o=e.split("=");o.length&&(t=o[0],n=o[1]);try{i[t]=decodeURIComponent(void 0===n?"":n)}catch(e){i[t]=n}}),i}(window.location.href),f="",_="",m="",g=""+parseFloat(a);-1!==(i=c.indexOf("Opera"))&&(m="Opera",g=c.substring(i+6),-1!==(i=c.indexOf("Version"))&&(g=c.substring(i+8))),-1!==(i=c.indexOf("Edge"))?(m="Microsoft Edge",g=c.substring(i+5)):-1!==(i=c.indexOf("MSIE"))?(m="Microsoft Internet Explorer",g=c.substring(i+5)):-1!==c.indexOf("Chrome")?-1!==(i=c.indexOf("Chrome"))&&(m="Chrome",g=c.substring(i+7)):-1!==c.indexOf("Safari")?-1!==(i=c.indexOf("Safari"))&&(m="Safari",g=c.substring(i+7),-1!==(i=c.indexOf("Version"))&&(g=c.substring(i+8))):-1!==(i=c.indexOf("Firefox"))&&(m="Firefox",g=c.substring(i+8)),-1!==(n=g.indexOf(";"))&&(g=g.substring(0,n)),-1!==(n=g.indexOf(" "))&&(g=g.substring(0,n)),-1!==(n=g.indexOf(")"))&&(g=g.substring(0,n));for(var v,z,y=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(a)?"wap":"web",b=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],w=0;w<b.length;w++){var k=b[w];if(k.r.test(c)){f=k.s;break}}function E(e,t){var i=e.exec(t);return i&&i[1]?i[1]:""}switch(/Windows/.test(f)&&(_=E(/Windows (.*)/,f),f="windows"),f){case"Mac OS X":v=c,_=(z=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?)","i").exec(v))?z.slice(1)[0]:"",f="mac";break;case"Android":_=function(e){var t=E(/Android ([\.\_\d]+)/,e);return t||(t=E(/Android\/([\.\_\d]+)/,e)),t}(c),f="android";break;case"iOS":_=(_=/OS (\d+)_(\d+)_?(\d+)?/.exec(a))?_[1]+"."+_[2]+"."+(0|_[3]):"",f="ios"}var S=function(e,t,i){var n=new l(!1),o=new l(!1,"session"),r=e?"_tea_utm_cache_"+e:"_tea_utm_cache",s=e?"_$utm_from_url_"+e:"_$utm_from_url",a={},c=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],u={utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4};try{var h=!1;for(var d in u)u[d]&&(-1!==c.indexOf(d)?(a.hasOwnProperty("tracer_data")||(a.tracer_data={}),a.tracer_data[d]=u[d]):a[d]=u[d],h=!0);if(h)o.setItem(s,"1"),n.setCookie(r,JSON.stringify(a),7776e6,i);else{var p=n.getCookie(r,i);p&&(a=JSON.parse(p))}o.getItem(s)&&(a.tracer_data.$utm_from_url=1)}catch(e){return u}return a}(e,p,t);return{browser:m,browser_version:g,platform:y,os_name:f,os_version:_,userAgent:c,screen_width:r,screen_height:s,device_model:function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach(function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))});else if("ios"===e||"mac"===e){var i=navigator.userAgent.replace("Mozilla/5.0 (",""),n=i.indexOf(";");t=i.slice(0,n)}}catch(e){}return t.trim()}(f),language:u,referrer:h,referrer_host:d,utm_source:S.utm_source,utm_medium:S.utm_medium,utm_campaign:S.utm_campaign,utm_term:S.utm_term,utm_content:S.utm_content}},L=void 0,q=(new Date).getTimezoneOffset(),J=parseInt(""+-q/60,10),U=60*q,M=function(){function e(e,t,i){this.cookieDomain=t.cookie_domain||"",this.initConfig=t;var n=P(e,this.cookieDomain);this.configKey=z(""+e),this.sessionStorage=new l(!1,"session"),this.localStorage=new l(!1,"local"),i&&(this.storage=1===i?this.sessionStorage:this.localStorage),this.envInfo={user:{user_unique_id:L,user_type:L,user_id:L,user_is_auth:L,user_is_login:L,device_id:L,web_id:L,ip_addr_id:L},header:{app_id:L,app_name:L,app_install_id:L,install_id:L,app_package:L,app_channel:L,app_version:L,os_name:n.os_name,os_version:n.os_version,device_model:n.device_model,ab_client:L,ab_version:L,ab_sdk_version:L,traffic_type:L,client_ip:L,device_brand:L,os_api:L,access:L,language:n.language,region:L,app_language:L,app_region:L,creative_id:L,ad_id:L,campaign_id:L,log_type:L,rnd:L,platform:n.platform,sdk_version:_,sdk_lib:"js",province:L,city:L,timezone:J,tz_offset:U,tz_name:L,sim_region:L,carrier:L,resolution:n.screen_width+"x"+n.screen_height,browser:n.browser,browser_version:n.browser_version,referrer:n.referrer,referrer_host:n.referrer_host,width:n.screen_width,height:n.screen_height,screen_width:n.screen_width,screen_height:n.screen_height,utm_term:n.utm_term,utm_content:n.utm_content,utm_source:n.utm_source,utm_medium:n.utm_medium,utm_campaign:n.utm_campaign,tracer_data:JSON.stringify(n.tracer_data),custom:{}}},this.evtParams={},this.reportErrorCallback=function(){}}return e.prototype.set=function(e,t){var i=this;if(t||(this.delete(e),t=void 0),"evtParams"===e||"_staging_flag"===e){var o;o="evtParams"===e?t:{_staging_flag:Number(t)};var r=n({},o);Object.keys(r).forEach(function(e){i.evtParams[e]=r[e]})}else if("reportErrorCallback"===e&&"function"==typeof t)this.reportErrorCallback=t;else{var s="";if(e.indexOf(".")>-1){var a=e.split(".");s=a[0],e=a[1]}"os_version"===e&&(e=""+t),s?"user"===s||"header"===s?this.envInfo[s][e]=t:this.envInfo.header.custom[e]=t:this.envInfo.user.hasOwnProperty(e)?["user_type","ip_addr_id"].indexOf(e)>-1?this.envInfo.user[e]=t?Number(t):t:["user_id"].indexOf(e)>-1?this.envInfo.user[e]=t?String(t):t:["user_is_auth","user_is_login"].indexOf(e)>-1?this.envInfo.user[e]=Boolean(t):"device_id"===e&&(this.envInfo.user[e]=t):this.envInfo.header.hasOwnProperty(e)?this.envInfo.header[e]=t:this.envInfo.header.custom[e]=t}},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){console.log("get config stringify error ")}},e.prototype.setStore=function(e){try{var t=this.storage.getItem(this.configKey);if(Object.keys(e).length){var i=Object.assign(e,t);this.storage.setItem(this.configKey,i)}}catch(e){}},e.prototype.getStore=function(){try{var e=this.storage.getItem(this.configKey);return Object.keys(e).length?e:null}catch(e){return null}},e.prototype.delete=function(e){try{var t=this.storage.getItem(this.configKey);t&&t.hasOwnProperty(e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){}},e}(),R=function(){function e(e,t){this.isLog=t,this.name=e||""}var t=e.prototype;return t.info=function(e){this.isLog&&console.log("["+this.name+"] "+e)},t.warn=function(e){this.isLog&&console.warn("["+this.name+"] "+e)},t.error=function(e){this.isLog&&console.error("["+this.name+"] "+e)},t.throw=function(e){throw this.error(this.name),new Error(e)},e}(),H=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},K=function(){function e(e,t){this.storage=new l(!1,"session"),this.sessionKey=v(e),this.disableSession=t.disable_session,this.expireTime=t.expireTime||18e5,this.disableSession||this._setSessionId()}return e.prototype._updateSessionId=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=e.timestamp;Date.now()-t>this.expireTime?e={sessionId:H(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this._resetExpTime()}},e.prototype._setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:H(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.sessionExp=setInterval(function(){e._checkEXp()},this.expireTime)},e.prototype._getSessionId=function(){if(this.disableSession)return"";var e=this.storage.getItem(this.sessionKey);return e&&e.sessionId?e.sessionId:null},e.prototype._resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval(function(){e._checkEXp()},this.expireTime))},e.prototype._resetSessionId=function(){var e={sessionId:H(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,e)},e.prototype._checkEXp=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=Date.now()-e.timestamp;t+30>=this.expireTime&&(console.log(t),e={sessionId:H(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))}},e}(),W=function(){function e(){this._hooks={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var i=this;e&&t&&"function"==typeof t&&this.on(e,function n(o){t(o),i.off(e,n)})},e.prototype.off=function(e,t){if(e&&this._hooks[e]&&this._hooks[e].length)if(t){var i=this._hooks[e].indexOf(t);-1!==i&&this._hooks[e].splice(i,1)}else this._hooks[e]=[]},e.prototype.emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&r(this._hooks[e]).forEach(function(e){try{e(t)}catch(e){}})},e}();function B(e,t,i){return{title:t||document.title||location.pathname,url:i||location.href,url_path:e||location.pathname}}function F(){return Date.now()}function $(){var e=y();return window[e]?window[e].l:F()}function X(){var e=!1;return["hidden","msHidden","webkitHidden"].forEach(function(t){void 0!==document[t]&&(e=!0)}),e}var G=function(){function e(e,t){var i=this;this._sendEvent=function(e){void 0===e&&(e=!1);var t=e?i.options.aliveDTime:F()-i.sessionStartTime;F()-i.pageStartTime>i.options.maxDuration||(i.event("predefine_page_alive",n({},B(i.url_path,i.title,i.url),{duration:t,is_support_visibility_change:i.options.sup_vis_change?1:0,startTime:i.sessionStartTime}),"sdk"),i.sessionStartTime=F())},this._setUpTimer=function(){return i.timerHandler&&clearInterval(i.timerHandler),setInterval(function(){F()-i.sessionStartTime>i.options.aliveDTime&&i._sendEvent(!0)},1e3)},this._visibilitychange=function(){"hidden"===document.visibilityState?i.timerHandler&&(clearInterval(i.timerHandler),i._sendEvent()):"visible"===document.visibilityState&&(i.sessionStartTime=F(),i.timerHandler=i._setUpTimer())},this._beforeunload=function(){document.hidden||i._sendEvent()},this._wtest=function(){document.getElementById("wtest").innerHTML="visibilitychange"},this._dtest=function(){document.getElementById("dtest").innerHTML="dvisibilitychange"},this.event=e,this.config=t,this.isSupVisChange=X(),this.options={maxDuration:432e5,aliveDTime:6e4,sup_vis_change:X()},this.pageStartTime=$(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,this.disableCallback=function(){}}return e.prototype.enable=function(e,t,i){this.url_path=e,this.url=i,this.title=t,this.disableCallback=this._enablePageAlive()},e.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now()},e.prototype._enablePageAlive=function(){var e=this;return this.timerHandler=this._setUpTimer(),document.addEventListener("visibilitychange",this._visibilitychange),V(this._beforeunload),function(){e._beforeunload(),document.removeEventListener("visibilitychange",e._visibilitychange),window.removeEventListener("beforeunload",e._beforeunload),window.removeEventListener("pagehide",e._beforeunload)}},e}(),Q=function(){function e(e,t){var i=this;this._visibilitychange=function(){"hidden"===document.visibilityState?i.activeEndTime=F():"visible"===document.visibilityState&&(i.activeEndTime&&(i.totalTime+=i.activeEndTime-i.activeStartTime,i.activeTimes+=1),i.activeEndTime=void 0,i.activeStartTime=F())},this._beforeunload=function(){if(i.totalTime+=(i.activeEndTime||F())-i.activeStartTime,i.config.autotrack)try{window.sessionStorage.setItem("_tea_cache_duration",JSON.stringify({duration:i.totalTime,page_title:document.title||location.pathname}))}catch(e){}i._sendEventPageClose()},this.event=e,this.config=t,this.isSupVisChange=X(),this.options={sup_vis_change:this.isSupVisChange},this.maxDuration=t.maxDuration||864e5,this.disableCallback=function(){},this.pageStartTime=$(),this._resetData()}return e.prototype.enable=function(e,t,i){this.url_path=e,this.url=i,this.title=t,this.disableCallback=this._enablePageClose()},e.prototype.disable=function(){this.disableCallback()},e.prototype._resetData=function(){this.activeStartTime=void 0===this.activeStartTime?$():Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0},e.prototype._sendEventPageClose=function(){var e=F()-this.pageStartTime;this.totalTime>=this.maxDuration||(this.event("predefine_page_close",n({},B(this.url_path,this.title,this.url),{active_times:this.activeTimes,duration:this.totalTime,total_duration:e,is_support_visibility_change:this.options.sup_vis_change?1:0}),"sdk"),this.pageStartTime=Date.now(),this._resetData())},e.prototype._enablePageClose=function(){var e=this;return document.addEventListener("visibilitychange",this._visibilitychange),V(this._beforeunload),function(){e._beforeunload(),document.removeEventListener("visibilitychange",e._visibilitychange),window.removeEventListener("beforeunload",e._beforeunload),window.removeEventListener("pagehide",e._beforeunload)}},e}(),Y=function(){function e(e,t){this.pageAlive=new G(e,t),this.pageClose=new Q(e,t),this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this._enable(this.url_path,this.title,this.url)}return e.prototype._enable=function(e,t,i){this.pageAlive.enable(e,t,i),this.pageClose.enable(e,t,i)},e.prototype._disable=function(){this.pageAlive.disable(),this.pageClose.disable()},e.prototype.reset=function(e,t,i){this._disable(),this._enable(e,t,i)},e}(),Z=function(){function e(e){var t=this;this._setInterval=function(){t._clearIntervalFunc=function(e,t){void 0===e&&(e=function(){}),void 0===t&&(t=1e3);var i,n=Date.now()+t;return i=window.setTimeout(function o(){var r=Date.now()-n;e(),n+=t,i=window.setTimeout(o,Math.max(0,t-r))},t),function(){window.clearTimeout(i)}}(function(){t._isSessionhasEvent&&t._endCurrentSession()},t.sessionInterval)},this._clearInterval=function(){t._clearIntervalFunc&&t._clearIntervalFunc()},this.sessionInterval=6e4,this._eventSenderFunc=e,this._startTime=0,this._lastTime=0,this._setInterval()}return e.prototype._endCurrentSession=function(){this._eventSenderFunc("_be_active",{start_time:this._startTime,end_time:this._lastTime,url:window.location.href,referrer:window.document.referrer}),this._isSessionhasEvent=!1,this._startTime=0},e.prototype.process=function(){this._isSessionhasEvent||(this._isSessionhasEvent=!0,this._startTime=+new Date);var e=this._lastTime||+new Date;this._lastTime=+new Date,this._lastTime-e>this.sessionInterval&&(this._clearInterval(),this._endCurrentSession(),this._setInterval())},e}(),ee=function(){function e(e){this.event=e,this.cache={},this.duration=6e4,this.profileReady=!1,this.lastId=0,this.lastOnceId=0}return e.prototype.start=function(){this.profileReady=!0},e.prototype.setProfile=function(e){var t=this._formatParams(e);t&&Object.keys(t).length&&(this._pushCache(t),this.event("__profile_set",n({},t,{profile:!0})))},e.prototype.setOnceProfile=function(e){var t=this._formatParams(e,!0);t&&Object.keys(t).length&&(this._pushCache(t),this.event("__profile_set_once",n({},t,{profile:!0})))},e.prototype.incrementProfile=function(e){e?this.event("__profile_increment",n({},e,{profile:!0})):console.warn("please check the params, must be object!!!")},e.prototype.unsetProfile=function(e){if(e){var t={};t[e]="1",this.event("__profile_unset",n({},t,{profile:!0}))}else console.warn("please check the key, must be string!!!")},e.prototype.appendProfile=function(e){if(e){var t={};for(var i in e)"string"==typeof e[i]||"Array"===Object.prototype.toString.call(e[i]).slice(8,-1)?t[i]=e[i]:console.warn("please check the value of param: "+i+", must be string or array !!!");Object.keys(t).length&&this.event("__profile_append",n({},t,{profile:!0}))}else console.warn("please check the params, must be object!!!")},e.prototype._pushCache=function(e){var t=this;Object.keys(e).forEach(function(i){t.cache[i]={val:t._clone(e[i]),timestamp:Date.now()}})},e.prototype._formatParams=function(e,t){var i=this;void 0===t&&(t=!1);try{if(!e||"[object Object]"!==Object.prototype.toString.call(e))return void console.warn("please check the params type, must be object !!!");var n={};for(var o in e)"string"==typeof e[o]||"number"==typeof e[o]||"Array"===Object.prototype.toString.call(e[o]).slice(8,-1)?n[o]=e[o]:console.warn("please check the value of params:"+o+", must be string,number,Array !!!");var r=Object.keys(n);if(!r.length)return;var s=Date.now();return r.filter(function(n){var o=i.cache[n];return t?!o:!(o&&i._compare(o.val,e[n])&&s-o.timestamp<i.duration)}).reduce(function(e,t){return e[t]=n[t],e},{})}catch(e){}},e.prototype._compare=function(e,t){try{return JSON.stringify(e)===JSON.stringify(t)}catch(e){return!1}},e.prototype._clone=function(t){try{return JSON.parse(JSON.stringify(t))}catch(e){return t}},e.prototype._unReady=function(){console.warn("sdk is not ready, please use this api after start")},e}(),te=function(){function e(){}return e.prototype.sdkOnload=function(e,t,i){if(!this.sdkReady){this.sdkReady=!0;try{if(0===i.length)return;var n=i[0],o=n.header,r=n.user,s=o.app_id,a=o.app_name,c=o.sdk_version,u=r.web_id,h={events:[{event:"onload",params:JSON.stringify({app_key:e,app_id:s,app_name:a||"",sdk_version:c}),local_time_ms:Date.now()}],user:{user_unique_id:u},header:{}};setTimeout(function(){O(t,3e4,[h],"566f58151b0ed37e")},16)}catch(e){}}},e.prototype.sdkError=function(e,t,i,n){try{var o=i[0],r=o.user,s=o.header,a=[];i.forEach(function(e){e.events.forEach(function(e){a.push(e)})});var c={events:a.map(function(t){return{event:"on_error",params:JSON.stringify({error_code:n,app_key:e,app_id:s.app_id,app_name:s.app_name||"",error_event:t.event,sdk_version:s.sdk_version,local_time_ms:t.local_time_ms,tea_event_index:Date.now(),params:t.params,header:JSON.stringify(s),user:JSON.stringify(r)}),local_time_ms:Date.now()}}),user:{user_unique_id:r.user_unique_id},header:{}};setTimeout(function(){O(t,3e4,[c],"566f58151b0ed37e")},16)}catch(e){}},e}(),ie=function(){try{var e=JSON.parse(atob(window.name));return e&&e.href?e.href:""}catch(e){return""}},ne=new l(!1),oe=function(e){return"__tea_sdk_ab_version_"+e},re=function(e){var t={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date};try{t=ne.getItem(oe(e))||t}catch(e){}return t},se=function(e,t){try{var i=re(e);ne.setItem(oe(e),n({},i,t))}catch(be){}},ae=function(e,t,i){void 0===i&&(i=!1);var n=i?{ab_ext_version:t,timestamp:Date.now()}:{ab_version:t,timestamp:Date.now()};se(e,n)},ce={},ue=[],he=function(e){e.length&&e.forEach(function(e){ue.push(e)})};function le(e,t,i,n){var o=e&&e.source||window.opener||window.parent,r=e&&e.origin||n||"*",s={type:t,payload:i};o.postMessage(JSON.stringify(s),r)}function de(e,t){ce[e]=ce[e]||[],ce[e].push(t)}function pe(e){if(ue.some(function(e){return"*"===e})||ue.some(function(t){return e.origin.indexOf(t)>-1})){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){t=void 0}if(!t)return;var i=t.type,n=t.payload;ce[i]&&ce[i].forEach(function(t){"function"==typeof t&&t(e,n)})}}function fe(e,t){(window.opener||window.parent).postMessage("[tea-sdk]ready","*"),(window.opener||window.parent).postMessage({type:"tea:sdk:info",config:e,version:t},"*"),window.addEventListener("message",pe,!1)}function _e(e,t,i){var n=document.createElement("script");n.src=e,n.onerror=function(){i(e)},n.onload=function(){t()},document.getElementsByTagName("head")[0].appendChild(n)}window.TEAVisualEditor=window.TEAVisualEditor||{};var me="",ge=!1;function ve(e){var t=e.event,i=e.editorUrl;e.collectInstance,e.fromSession,ge||(ge=!0,_e(i,function(){le(t,"abEditorScriptloadSuccess")},function(){t&&le(t,"abEditorScriptloadError"),ge=!1}))}var ze,ye,be,we=function(e,t,i,n){window.TEAVisualEditor.appId=t,de("tea:openTesterEventInspector",function(t){var i=t.data;if("string"==typeof t.data)try{i=JSON.parse(t.data)}catch(e){i=void 0}if(i){var n=i.referrer,o=i.lang,r=i.appId;window.TEAVisualEditor.__editor_ajax_domain=n||"",window.TEAVisualEditor.__ab_appId=r||"",window.TEAVisualEditor.lang=o||"",ve({event:t,editorUrl:A("1fz22z22z1nz21z4mz4bz4bz1jz1dz4dz4iz49z1bz18z22z18z4az19z27z22z1cz1nz1jz23z21z1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az49z21z1ez4bz22z1cz21z22z1cz20z4bz21z1bz1iz4bz22z1cz21z22z1cz20z49z1cz24z1cz1lz22z49z1gz1lz21z1nz1cz1az22z1mz20z4az1hz21")+"?query="+Date.now(),collectInstance:e})}})},ke=A("1fz22z22z1nz21z4mz4bz4bz21z1dz4dz4iz49z21z1az1kz1az1bz1lz49z24z18z4az1gz19z27z22z1cz1bz22z1mz21z4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az49z23z21z4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1jz1mz18z1bz1cz20z4az1hz21")+"?query="+Date.now();(be=ze||(ze={}))[be.No=0]="No",be[be.Ing=1]="Ing",be[be.Complete=2]="Complete",function(e){e[e.Var=0]="Var",e[e.All=1]="All"}(ye||(ye={}));var Ee=function(){function e(e,t,i){this.appId=0,this.user={},this.header={},this.domain="",this.protocal=location.protocol,this.fetchStatus=ze.No,this.callbacks=[],this.data=null,this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.collector=e;var n=this.collector._initConfig,o=n.app_id,r=n.channel,s=n.enable_multilink,a=n.multilink_timeout_ms,c=n.ab_channel_domain,u=n.channel_domain,h=n.enable_ab_visual,l=n.ab_timeout;if(this.appId=o,this.timeout=l||3e3,this.domain=c||A(b[r||"cn"]),this.domain){this.needOverlay=s||h||!1,this.enable_ab_visual=h,this.enable_multilink=s,this.closeTime=a||500,this.Hook=t;var p=u||A(d[r]);if(this.reportUrl=""+p+f,h){!function(e,t,i,n){he(["*"]);var o="";fe(n,_);var r,s=window.performance.getEntriesByType("resource"),a="";try{if(s&&s.length&&(s.forEach(function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(a=e.name)}),a||document.currentScript&&(a=document.currentScript.src),a&&(r=a.split("/"))&&r.length)){o="https:/";for(var c=2;c<r.length&&c!==r.length-1;c++)o=o+"/"+r[c];o+="/visual-editor-ab"}}catch(e){}de("tea:openVisualABEditor",function(n){var r=n.data;if("string"==typeof n.data)try{r=JSON.parse(n.data)}catch(e){r=void 0}if(r){var s=r.lang;if(r.appId!==t)return le(n,"appIdError"),void console.error("abtest appid is not belong the page appid please check");var a=r.version;me=a&&o?o+(a?"."+a:".1.0.1")+".js?query="+Date.now():A(E)+"?query="+Date.now(),window.TEAVisualEditor.lang=s,i&&(window.TEAVisualEditor.__ab_domin=i),ve({event:n,editorUrl:me,collectInstance:e})}})}(e,this.appId,c||"",i);var m=ie();if(m&&(-1!==m.indexOf("datatester")||-1!==m.indexOf("visual-editor")))return console.log("edit mode"),void this.collector.destroy()}s&&we(e,this.appId,c||"",i),this._check(),this.wait()}else console.warn("sorry you env is not support abtest yet~")}return e.prototype.init=function(e,t){if(!this.collector.destroyInstance)if(this.domain){this.config=e;var i=e.user,o=e.header,r=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(i[n[o]]=e[n[o]])}return i}(o,[]);this.user=n({},i),this.header=n({},o),this._fetch(n({},r),{success:t,fail:t})}else console.warn("sorry you env is not support abtest yet~")},e.prototype._check=function(){var e=this,t=function(e){var t=re(e),i=t.timestamp;if(Date.now()-i>=2592e6){try{ne.removeItem("__tea_sdk_ab_version")}catch(e){}return null}return t}(this.appId);if(t){var i=t.ab_version,n=t.data,o=t.ab_ext_version,r=t.ab_version_multilink;this.mulilinkVersions=r||[],this.extVersions=o,i&&i.length&&(this.versions=i,this.data=n,setTimeout(function(){e._configVersions()}))}},e.prototype.wait=function(){var e=this;this.needOverlay&&(this.isWait||(this.openOverlayer(),this.isWait=!0),setTimeout(function(){e.closeOverlayer()},this.closeTime))},e.prototype.getAllVars=function(e){if("function"!=typeof e)throw new Error("callback must be a function");var t={callback:e,type:ye.All};this.fetchStatus===ze.Complete?this._getAllVars(t):this.callbacks.push(t)},e.prototype._getAllVars=function(e){(0,e.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{})},e.prototype.getVids=function(){try{var e=re(this.appId).ab_version,t="";return e&&e.length&&(t=e.join(",")),t}catch(e){return""}},e.prototype.getAbSdkVersion=function(e){e(this.getVids())},e.prototype.getVar=function(e,t,i){if(!e)throw new Error("variable must not be empty");if(void 0===t)throw new Error("variable no default value");if("function"!=typeof i)throw new Error("callback must be a function");var n={name:e,defaultValue:t,callback:i,type:ye.Var};if(this.fetchStatus===ze.Complete){this._getVar(n,e);try{this.Hook.emit("onAbSdkVersionChange",this.getVids())}catch(e){}}else this.callbacks.push(n)},e.prototype._getVar=function(e,t){var i=e.name,n=e.defaultValue,o=e.callback,r=this.data;if(r){if("object"==typeof r[i]&&void 0!==r[i].val){var s=r[i].vid;return"$ab_url"===t?(-1===this.mulilinkVersions.indexOf(s)&&this.mulilinkVersions.push(s),this._updateMultilinkVersions()):(-1===this.versions.indexOf(s)&&this.versions.push(s),this._updateVersions()),this._abEvent(s,t,n),void o(r[i].val)}o(n)}else o(n)},e.prototype._abEvent=function(e,t,i){var n=this;try{if(e){var o={event:"abtest_exposure",ab_sdk_version:""+e,params:JSON.stringify({app_id:this.appId,ab_url:"$ab_url"===t?i:window.location.href}),local_time_ms:Date.now()},r=this.collector._config.get(),s=r.header,a=r.user;s.ab_sdk_version=""+e,s.custom=JSON.stringify(s.custom);var c={events:[o],user:a,header:s};"$ab_url"===t?window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify([c])):O(this.reportUrl,2e4,[c],""):setTimeout(function(){O(n.reportUrl,2e4,[c],"")},16)}}catch(e){}},e.prototype.openOverlayer=function(){!function(){if(!document.getElementById(w)){var e="body { opacity: 0 !important; }",t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.id=w,i.type="text/css",i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e)),t.appendChild(i)}}()},e.prototype.closeOverlayer=function(){var e;(e=document.getElementById(w))&&e.parentElement.removeChild(e)},e.prototype._setAbVersion=function(e){this.extVersions=[e],ae(this.appId,this.extVersions,!0)},e.prototype._updateVersions=function(){ae(this.appId,this.versions),this._configVersions()},e.prototype._updateMultilinkVersions=function(){var e,t;e=this.appId,t={ab_version_multilink:this.mulilinkVersions,timestamp:Date.now()},se(e,t)},e.prototype._configVersions=function(){var e=this.versions.join(",");e&&this.collector.config({ab_sdk_version:e})},e.prototype._getABconfig=function(e,t){var i=Object.keys(e);i&&i.length&&this.collector.config(e),this.init(this.collector._config.get(),t)},e.prototype._fetchComplete=function(e){var t=this;if(e){!function(e,t){se(e,{data:t})}(this.appId,e),this.data=e;var i=[];Object.keys(e).forEach(function(t){var n=e[t].vid;n&&i.push(n)}),-1!==window.location.href.indexOf("multilink=true")||(this.versions=this.versions.filter(function(e){return-1!==i.indexOf(e)}));var n=e.$ab_url,o=e.$ab_modification;if(o&&o.val&&this.enable_ab_visual){if(this.collector.destroyInstance)return;this.getVar("$ab_modification",window.location.href,function(){var e;e=o.val,window.TEAVisualEditor.__ab_config=e,_e(ke,function(){console.log("load visual render success")},function(){console.log("load visual render fail")})})}else if(n&&this.enable_multilink){var r=n.val,s=n.vid;r&&s&&this.getVar("$ab_url",r,function(){var e=window.location.href;-1!==e.indexOf("multilink=true")&&(e=t.filterUrl(e)),r!==e?setTimeout(function(){if(!t.collector.destroyInstance){var e=""+r;-1!==(e=-1===e.indexOf("http")?"https://"+e:e).indexOf("?")?e+="&multilink=true":e+="?multilink=true",window.location.href=e}},50):t.closeOverlayer()})}else this.closeOverlayer()}this.callbacks.forEach(function(e){t[e.type===ye.Var?"_getVar":"_getAllVars"](e,"")}),this.callbacks=[],this._updateVersions();try{this.Hook.emit("onAbSdkVersionChange",this.getVids())}catch(e){}this.isWait||this.closeOverlayer()},e.prototype._fetch=function(e,t){var i=this,o=void 0===t?{}:t,r=o.success,s=void 0===r?function(){}:r,a=o.fail,c=void 0===a?function(){}:a;this.fetchStatus=ze.Ing;var u=this.domain+"/service/2/abtest_config/",h=window.location.href,l=!1;-1!==h.indexOf("multilink=true")&&(h=this.filterUrl(h),l=!0);var d=l?this.mulilinkVersions:this.versions;I(u,{header:n({aid:this.appId},this.user||{},e||{},{ab_sdk_version:d.join(","),ab_url:h})},function(e){i.fetchStatus=ze.Complete;var t=e.data;"success"===e.message?(i._fetchComplete(t),s(t)):(i._fetchComplete(null),c())},function(){i.fetchStatus=ze.Complete,c(),i._fetchComplete(null)},"",this.timeout,!1)},e.prototype.filterUrl=function(e){try{var t="";-1!==e.indexOf("&multilink=true")?t="&multilink=true":-1!==e.indexOf("?multilink=true")&&(t="\\?multilink=true");var i=new RegExp(t,"g");e=e.replace(i,"")}catch(e){}return e},e}(),Se=function(e,t,i,n){if(t){var o=e.filter(function(e){return!e[0].__disable_storage__}).length;if(o>0)try{var r=n.getItem(i);if(r){var s=Object.keys(r),a=s.length+o-t;if(a>0){for(var c=s.map(function(e){var t=r[e];return{id:e,index:t&&t[0]?t[0].header.__storage_index__:+new Date}}).sort(function(e,t){return e.index-t.index}),u=0;u<a;u++){var h=c.shift();h&&h.id&&r[h.id]&&delete r[h.id]}n.setItem(i,r)}}}catch(e){}}},Ie=function(){function e(e){"string"==typeof e.event_verify_url?this.url=e.event_verify_url+"/"+k:console.log("please use correct et_test url")}return e.prototype.send=function(e){this.url&&O(this.url,1e4,e)},e}(),Te=function(e,t,i,n,o){t&&(t.enable_stay_duration&&(this.stay=new Y(n,t)),t.channel_domain&&(this.profile=new ee(i)),t.disable_session||(this.session=new Z(i)),t.channel_domain||t.disable_sdk_monitor||(this.monitor=new te),t.event_verify_url&&(this.et_test=new Ie(t)),t.enable_ab_test&&(this.ab=new Ee(e,o,t)),t.max_storage_num&&(this.maxStorage=Se))};function Oe(e,t){if(void 0===t&&(t="list"),!e)return!1;if(t&&"list"===t){if(["LI","TR","DL"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaIdx"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-idx"))return!0}else{if(["A","BUTTON"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaContainer"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-container"))return!0}return!1}function xe(e){for(var t=e;t&&!Oe(t,"container");){if("HTML"===t.nodeName||"BODY"===t.nodeName)return e;t=t.parentElement}return t||e}function Ce(e){var t="";return 3===e.nodeType?t=e.textContent.trim():e.dataset&&e.dataset.hasOwnProperty("teaTitle")?t=e.getAttribute("data-tea-title"):e.hasAttribute("ata-tea-title")?t=e.getAttribute("data-tea-title"):e.hasAttribute("title")?t=e.getAttribute("title"):"INPUT"===e.nodeName&&["button","submit"].includes(e.getAttribute("type"))?t=e.getAttribute("value"):"IMG"===e.nodeName&&e.getAttribute("alt")&&(t=e.getAttribute("alt")),t.slice(0,200)}var Ae,Ne,Ve=function(e){if(e.children.length){var t=e.children;return![].slice.call(t).some(function(e){return e.children.length>0})}return!0},De=function(e){for(var t=e.parentElement,i=!1;t;)"svg"===t.tagName.toLowerCase()?(t=null,i=!0):t=t.parentElement;return i};function je(e,t,i){void 0===t&&(t=""),void 0===i&&(i={});var n=e;"/"===(n=n.split("#")[0].split("?")[0])[e.length-1]&&(n=n.substr(0,e.length-1)),n="/"===t[0]?n.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?)(\/[.\w-]+)*\/?$/,"$1"+t):n.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?(\/[.\w-]+)*?)(\/[.\w-]+)?\/?$/,"$1/"+t);var o=Object.keys(i).map(function(e){return e+"="+i[e]}).join("&");return o.length>0?n+"?"+o:n}function Pe(){var e="";try{e=document.referrer?document.referrer:Ne.getItem("__tea_cache_refer_key")===location.href?"":Ne.getItem("__tea_cache_refer_key")}catch(e){}return{is_html:1,page_key:location.href,refer_page_key:e,page_manual_key:"",refer_page_manual_key:""}}function Le(e,t){var i=Pe();return i.is_back=0,i}function qe(e,t){void 0===t&&(t=!1),function(e){var t,i;t=window.history,i=t.pushState,t.pushState=function(n){"function"==typeof t.onpushstate&&t.onpushstate({state:n}),e("pushState",n,c);for(var o=arguments.length,r=new Array(o>1?o-1:0),s=1;s<o;s++)r[s-1]=arguments[s];var a=i.call.apply(i,[t,n].concat(r)),c=Le();return Ae=je(location.href,r[1]),e("popstate",n,c),a},function(t){var i=t.replaceState;t.replaceState=function(n){"function"==typeof t.onreplacestate&&t.onreplacestate({state:n});for(var o=arguments.length,r=new Array(o>1?o-1:0),s=1;s<o;s++)r[s-1]=arguments[s];var a=i.call.apply(i,[t,n].concat(r)),c=Le();return Ae=je(location.href,r[1]),e("replaceState",n,c),a}}(window.history)}(e),(Ne=new l(!0)).setItem("__tea_cache_refer_key",location.href);var i=null;window.addEventListener("hashchange",function(n){if(Ae!==window.location.href&&(clearTimeout(i),t)){Ae=window.location.href;var o=Pe();e("hashchange",n,o)}}),window.addEventListener("popstate",function(t){Ae!==window.location.href&&(i=setTimeout(function(){Ae=window.location.href;var i=Le();e("popstate",t,i)},10))});var n=Le();e("popstate",null,n)}"undefined"!=typeof window&&(Ae=window.location.href);var Je=function(){function e(e,t){var i=this;this.clickEvent=function(e){(function(e){if(window.innerHeight,window.innerWidth,1!==e.nodeType)return!1;if(De(e))return!1;if(["HTML","BODY"].includes(e.tagName.toUpperCase()))return!1;var t=e;return!("none"===t.style.display||!Oe(t,"container")&&!Ve(t))})(e.target)&&i.eventHandel({eventType:"dom",eventName:"click"},e)},this.changeEvent=function(e){i.eventHandel({eventType:"dom",eventName:"change"},e)},this.submitEvent=function(e){i.eventHandel({eventType:"dom",eventName:"submit"},e)},this.getPageViewEvent=function(e,t,n){"pushState"===e?i.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:0}):i.eventHandel({eventType:"dom",eventName:"page_view"},n)},this.getPageLoadEvent=function(e){i.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:e})},this.config=t.getConfig().eventConfig,this.options=e,this.beatTime=e.beat,this.statistics=!1}return e.prototype.init=function(e){this.eventHandel=e;var t=this.config.mode;this.addListener(t)},e.prototype.addListener=function(e){var t=this;if("proxy-capturing"===e&&(this.config.click&&window.document.addEventListener("click",this.clickEvent,!0),this.config.change&&window.document.addEventListener("change",this.changeEvent,!0),this.config.submit&&window.document.addEventListener("submit",this.submitEvent,!0),this.config.pv&&("complete"===document.readyState?qe(this.getPageViewEvent,this.options.hashTag||this.config.hashTag):window.addEventListener("load",function(){qe(t.getPageViewEvent,t.options.hashTag||t.config.hashTag)})),this.config.beat)){try{"complete"===document.readyState?this.beatEvent(this.beatTime):window.addEventListener("load",function(){t.beatEvent(t.beatTime)});var i=0,n=null;window.addEventListener("scroll",function(){clearTimeout(n),n=setTimeout(o,500),i=document.documentElement.scrollTop||document.body.scrollTop});var o=function(){(document.documentElement.scrollTop||document.body.scrollTop)==i&&t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(e){}try{var r=window.performance&&window.performance.getEntriesByType("paint");r&&r.length?(new PerformanceObserver(function(e){var i=e.getEntries(),n=i[i.length-1],o=n.renderTime||n.loadTime;t.statistics||(t.getPageLoadEvent(o),t.statistics=!0)}).observe({entryTypes:["largest-contentful-paint"]}),setTimeout(function(){t.statistics||(t.getPageLoadEvent(r[0].startTime||0),t.statistics=!0)},2e3)):this.getPageLoadEvent(0)}catch(e){this.getPageLoadEvent(0)}}},e.prototype.removeListener=function(){window.document.removeEventListener("click",this.clickEvent,!0),window.document.removeEventListener("change",this.changeEvent,!0),window.document.removeEventListener("submit",this.submitEvent,!0)},e.prototype.beatEvent=function(e){var t=this;try{var i;this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3}),this.beatTime&&(i=setInterval(function(){t.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})},e)),V(function(){t.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),t.beatTime&&clearInterval(i)})}catch(e){}},e}(),Ue={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},Me=function(){function e(e){this.config=e}return e.prototype.getConfig=function(){return this.config},e.prototype.setConfig=function(e){return this.config=e},e}();function Re(e,t){var i={element_path:"",positions:[],texts:[]},n=function(e){if(e){var t=e.getBoundingClientRect(),i=t.width,n=t.height;return{left:t.left,top:t.top,element_width:i,element_height:n}}}(t),o=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var i=e.clientX,n=e.clientY,o=t.left,r=t.top;return{touch_x:Math.floor(i-o),touch_y:Math.floor(n-r)}}(e,n),r=n.element_width,s=n.element_height,a=o.touch_x,c=o.touch_y,u=function(e){for(var t=[];null!==e.parentElement;)t.push(e),e=e.parentElement;var i=[],n=[];return t.forEach(function(e){var t=function(e){if(null===e)return{str:"",index:0};var t=0,i=e.parentElement;if(i)for(var n=i.children,o=0;o<n.length&&n[o]!==e;o++)n[o].nodeName===e.nodeName&&t++;return{str:[e.nodeName.toLowerCase(),Oe(e,"list")?"[]":""].join(""),index:t}}(e),o=t.str,r=t.index;i.unshift(o),n.unshift(r)}),{element_path:"/"+i.join("/"),positions:n}}(t),h=u.element_path,l=u.positions,d=function(e){var t=xe(e),i=[];return function e(t){var n=Ce(t);if(n&&-1===i.indexOf(n)&&i.push(n),t.childNodes.length>0)for(var o=t.childNodes,r=0;r<o.length;r++)8!==o[r].nodeType&&e(o[r])}(t),i}(t),p=window.performance.timing.navigationStart,f=Date.now()-p;i.element_path=h,i.positions=l.map(function(e){return""+e}),i.texts=d,i.element_width=Math.floor(r),i.element_height=Math.floor(s),i.touch_x=a,i.touch_y=c,i.page_manual_key="",i.elememt_manual_key="",i.since_page_start_ms=f,i.page_start_ms=p,i.element_title=function(e){var t=xe(e),i="";return function e(t){var n=Ce(t);if(n&&(i+=n),t.childNodes.length>0)for(var o=t.childNodes,r=0;r<o.length;r++)3===o[r].nodeType&&e(o[r])}(t),i}(t);var _=xe(t);return"A"===_.tagName&&(i.href=_.getAttribute("href")),"IMG"===t.tagName&&(i.src=t.getAttribute("src")),i}function He(e,t,i){return n({event:e},Re(t,i),{is_html:1,page_key:window.location.href,page_title:document.title})}var Ke=function(){function e(e){this.eventName=e&&"tea"===e.custom?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat",static:"__bav_page_statistics"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat",static:"bav2b_page_statistics"}}return e.prototype.handleEvent=function(e,t){try{if(function(e){for(var t=e;t&&t.parentNode;){if(t.hasAttribute("data-tea-ignore"))return!0;if("HTML"===t.nodeName||"body"===t.nodeName)return!1;t=t.parentNode}return!1}(e.target))return null;var i="bav2b_click";switch(t){case"click":return He(i=this.eventName.click,e,e.target);case"change":return n({},He(i="bav2b_change",e,e.target),function(e,t){try{if("bav2b_change"===e)return t.hasAttribute("data-tea-track")?{value:t.value}:{}}catch(e){return{}}}(i,e.target));case"submit":return He(i="bav2b_submit",e,e.target)}}catch(be){return console.error(be),null}},e.prototype.handleViewEvent=function(e){e.event=this.eventName.page,e.page_title=document.title,e.page_total_width=window.innerWidth,e.page_total_height=window.innerHeight;try{var t=window.sessionStorage.getItem("_tea_cache_duration");if(t){var i=JSON.parse(t);e.refer_page_duration_ms=i?i.duration:"",e.refer_page_title=i?i.page_title:""}else e.refer_page_duration_ms="",e.refer_page_title="";e.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,e.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,e.page_start_ms=window.performance.timing.navigationStart}catch(e){console.log("page event error "+JSON.stringify(e))}return e},e.prototype.handleStatisticsEvent=function(e){var t={};t.event=this.eventName.static,t.is_html=1,t.page_key=location.href,t.refer_page_key=document.referrer||"",t.page_title=document.title,t.page_manual_key="",t.refer_page_manual_key="";try{var i=e.lcp,n=window.performance.timing,o=n.loadEventEnd-n.navigationStart;t.page_init_cost_ms=parseInt(i||(o>0?o:0)),t.page_start_ms=n.navigationStart}catch(e){console.log("page_statistics event error "+JSON.stringify(e))}return t},e.prototype.handleBeadtEvent=function(e){e.event=this.eventName.beat,e.page_key=window.location.href,e.is_html=1,e.page_title=document.title,e.page_manual_key="";try{e.page_total_width=document.documentElement.scrollWidth,e.page_total_height=document.documentElement.scrollHeight,e.scroll_width=document.documentElement.scrollLeft+window.innerWidth,e.scroll_height=document.documentElement.scrollTop+window.innerHeight,e.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,e.page_start_ms=window.performance.timing.navigationStart}catch(e){console.log("beat event error "+JSON.stringify(e))}return e},e}(),We=function(){function e(e,t){this.logFunc=e,this.logFuncBecon=t,this.eventNameList=["report_click_event","report_change_event","report_submit_event","report_exposure_event","report_page_view_event","report_page_statistics_event","report_beat_event"]}return e.prototype.send=function(e,t){e.eventName;var i=e.eventSend,n=t.event;delete t.event,i&&"becon"===i?this.logFuncBecon(n,t,"autotrack"):this.logFunc(n,t,"autotrack")},e.prototype.get=function(e,t){var i=Object.assign({headers:{"content-type":"application/json"},method:"GET"},t);fetch(e,i)},e.prototype.post=function(e,t){var i=Object.assign({headers:{"content-type":"application/json"},method:"POST"},t);fetch(e,i)},e}(),Be="_TEA_VE_OPEN",Fe="_TEA_VE_APIHOST",$e="lang",Xe="_VISUAL_EDITOR_V",Ge="_VISUAL_EDITOR_U";function Qe(){try{var e=window.TEAVisualEditor.lang=window.TEAVisualEditor.lang||a.get($e),t=window.TEAVisualEditor.__editor_ajax_domain=window.TEAVisualEditor.__editor_ajax_domain||a.get(Fe),i=window.TEAVisualEditor.__editor_verison=window.TEAVisualEditor.__editor_verison||a.get(Xe),n=window.TEAVisualEditor.__editor_url=window.TEAVisualEditor.__editor_url||a.get(Ge),o=+new Date,r=new Date(o+18e5);a.set(Be,"1",{expires:r}),a.set(Fe,t,{expires:r}),a.set(Ge,n,{expires:r}),a.set($e,e,{expires:r}),a.set(Xe,i||"",{expires:r})}catch(e){console.log("set cookie err")}}window.TEAVisualEditor=window.TEAVisualEditor||{};var Ye="",Ze=window.TEAVisualEditor.__editor_url||A("1fz22z22z1nz21z4mz4bz4bz21z1dz4dz49z21z1az1kz1az1bz1lz49z22z1mz21z4az1nz21z22z18z22z1nz4az1az1mz1kz4bz1ez1mz1mz1dz27z4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z1cz1bz1gz22z1mz20z49z20z18z1lz1ez1cz20z21z4az1hz21");Ze=Ze+"?query="+Date.now();var et=A("1fz22z22z1nz21z4mz4bz4bz21z1dz4dz4iz49z21z1az1kz1az1bz1lz49z24z18z4az1gz19z27z22z1cz1bz22z1mz21z4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az49z23z21z4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z1cz1bz1gz22z1mz20z49z20z18z1lz1ez1cz20z21z4az1hz21")+"?query="+Date.now(),tt=!1;function it(e){var t=e.event,i=e.editorUrl,n=e.autoTrackInstance;e.fromSession,tt||(tt=!0,_e(i,function(){le(t,"editorScriptloadSuccess"),n.destroy()},function(){t&&le(t,"editorScriptloadError"),tt=!1}))}function nt(e,t){window.TEAVisualEditor.appId=t.app_id;var i=t.channel_domain,n="";if(he(["*"]),i){var o,r=window.performance.getEntriesByType("resource"),s="";try{if(r&&r.length&&(r.forEach(function(e){"script"===e.initiatorType&&e.name&&-1!==e.name.indexOf("collect")&&(s=e.name)}),s||document.currentScript&&(s=document.currentScript.src),s&&(o=s.split("/"))&&o.length)){n="https:/";for(var c=2;c<o.length&&c!==o.length-1;c++)n=n+"/"+o[c];n+="/visual-editor-rangers"}}catch(e){}}if(fe(t,_),"1"===a.get(Be)){var u=function(){var e=a.get(Fe);try{e=JSON.parse(e)}catch(e){}return e}();u?(window.TEAVisualEditor.__editor_ajax_domain=u,it({event:null,editorUrl:a.get(Ge)||et,autoTrackInstance:e,fromSession:!1})):it({event:null,editorUrl:et,autoTrackInstance:e,fromSession:!1}),Qe()}else try{de("tea:openVisualEditor",function(t){var o=t.data;if("string"==typeof t.data)try{o=JSON.parse(t.data)}catch(e){o=void 0}if(o){var r=o.referrer,s=o.lang;if(r?(window.TEAVisualEditor.__editor_ajax_domain=r,Ye=et):Ye=et,i){var a=o.version;Ye=n?n+(a?"-v"+a:"-v1.0.0")+".js":et,window.TEAVisualEditor.__editor_verison=a}window.TEAVisualEditor.__editor_url=Ye,window.TEAVisualEditor.lang=s,it({event:t,editorUrl:Ye,autoTrackInstance:e}),Qe()}}),window.TEAVisualEditor.openAutotrackEditor=function(){it({event:null,editorUrl:window.TEAVisualEditor.__editor_url,autoTrackInstance:e})}}catch(e){console.log("receive message error")}try{de("tea:openHeatMapCore",function(t){it({event:t,editorUrl:A(S)+"?query="+Date.now(),autoTrackInstance:e})})}catch(e){console.log("openHeatMapCore error")}}var ot,rt=function(){function e(){this.autoTrackStart=!1,this.defaultOpt={hashTag:!1,impr:!1}}return e.prototype.start=function(e,t,i){t=Object.assign(this.defaultOpt,t),this.destroyed=!1,this.options=t,this.logFunc=e,this.logFuncBecon=i,this.Config=new Me(Ue),this.Listener=new Je(t,this.Config),this.EventHandle=new Ke(t),this.Request=new We(this.logFunc,this.logFuncBecon),this.autoTrackStart=!0,this.init()},e.prototype.init=function(){this.Listener.init(this.handle.bind(this))},e.prototype.handle=function(e,t){"dom"===e.eventType&&this.handleDom(e,t)},e.prototype.handleDom=function(e,t){try{var i=e.eventName;if("click"===i||"change"===i||"submit"===i){var n=this.EventHandle.handleEvent(t,i);null!==n&&this.Request.send({eventType:"custom",eventName:"report_"+i+"_event",extra:{methods:"GET"}},n)}else if("page_view"===i||"page_statistics"===i){var o;o="page_view"===i?this.EventHandle.handleViewEvent(t):this.EventHandle.handleStatisticsEvent(t),this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"}},o)}else if("beat"===i){var r=this.EventHandle.handleBeadtEvent(t),s=e.eventSend;this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"},eventSend:s},r)}}catch(e){console.log("handel dom event error "+JSON.stringify(e))}},e.prototype.destroy=function(){if(!this.autoTrackStart)return console.warn("engine is undefined, make sure you have called autoTrack.start()");this.autoTrackStart=!1,this.Listener.removeListener()},e}(),st=r(["init","config","send","start","predefinePageView","beconEvent","resetStayDuration"],["profileSet","profileSetOnce","profileIncrement","profileUnset","profileAppend","getVar","getAbSdkVersion","onAbSdkVersionChange","offAbSdkVersionChange","getABconfig","openOverlayer","closeOverlayer","getAllVars","setExternalAbVersion","getToken","destroy"]),at=(ot=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return ot+=1}),ct=function(){function e(e){var t=this;this.staging=!1,this._getToken=!1,this.sdkload=!1,this.initPv=!0,this.predefinePageView=function(e){void 0===e&&(e={});var i=n({title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer},t._event.closeStorage?{}:{__disable_storage__:1},{$is_first_time:""+t.is_first_time}),o=n({},i,e);t.event("predefine_pageview",o,!0)},this.getToken=function(e,i){if(!t.sdkload)return t.logger.warn("sdk init error, api can not call, getToken will return {}"),void e({});var o=!1,r=function(){if(!o){o=!0;var i=t._config.get().user;return e(n({},i))}};i&&setTimeout(function(){r()},i),t._token.isTokenReady()?r():(t.hook.on("get-token",function(){r()}),t._getToken=!0)},this.name=e,this._isSend=!1,this.autoPV=!0,this.hook=new W,this.storage=new l(!1)}return e.prototype.init=function(e){var t=this;if(!this._inited){if(this._inited=!0,!e||"object"!=typeof e)throw new Error("init params is error,please check");var i=e.app_id,n=e.app_key,o=e.log;this._config=new M(i,e,e.configPersist||0),this.logger=new R(this.name,o),n||i||this.logger.throw("no app_key or app_id please check"),i&&"number"!=typeof i&&this.logger.throw("app_id param is error,must be number,please check "),n&&"string"!=typeof n&&this.logger.warn("app_key is empty"),e.channel_domain||-1!==["sg","va","in"].indexOf(e.channel)||this.logger.throw("channel must be `sg`,`va`,`in`"),this._config.set("app_id",i),e.channel=e.channel?e.channel:"sg",this._initConfig=e,this.storage.getItem("__tea_cache_first_"+i)?this.is_first_time=!1:(this.is_first_time=!0,this.storage.setItem("__tea_cache_first_"+i,"1")),this.sdkload=!0,this.hook.on("token-ready",function(){t.callbackSend?t._isSend?t._event&&t._event.report():t.start():t._event&&t._event.report()}),this._session=new K(n||i,e),this._token=new N(e,this._config,this.hook,this._session),this.plugin=new Te(this,e,this.event.bind(this),this.beconEvent.bind(this),this.hook),this._event=new j(this,e,this._config,this._token,this.plugin,this._session),this._token._getToken(),e.autotrack&&function(e,t,i){var n=new rt,o=e.autotrack;if(o){var r={};"object"==typeof o&&(r=o),n.start(t,r,i),nt(n,e)}else n.autoTrackStart&&n.destroy()}(e,this.event.bind(this),this.beconEvent.bind(this))}},e.prototype.config=function(e){if(this._inited)if(e&&"object"==typeof e){e.disable_auto_pv&&(this.autoPV=!1,delete e.disable_auto_pv),e._staging_flag&&1===e._staging_flag&&(this.staging=!0);var t=n({},e);if(this.configPersist){var i=this._config.getStore();i&&(t=Object.assign(i,e)),this._config.setStore(e)}for(var o in t)"user_unique_id"!==o?"web_id"!==o?this._config.set(o,t[o]):this._token._setWebid(t[o]):this._token._setUuid(t[o])}else this.logger.warn("config params is error, please check");else this.logger.warn("config must be use after function init")},e.prototype.send=function(){this.start()},e.prototype.start=function(){var e=this;if(this._token.isTokenReady()){if(this._isSend)return;this._isSend=!0,this.logger.info("appid:"+this._initConfig.app_id+", userInfo:"+JSON.stringify(this._config.get("user"))),this.logger.info("sdk is ready,version is "+_+". you can report now !!!"),this._event.setReady(),this.autoPV&&(this.predefinePageView(),this.initPv=!1),this.hook.on("uuid-change",function(){if(!e.initPv){var t={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+e.is_first_time};e.beconEvent("predefine_pageview",t)}}),this._getToken&&this.hook.emit("get-token"),this.plugin&&this.plugin.ab&&this.plugin.ab.init(this._config.get())}else this.callbackSend=!0},e.prototype.beconEvent=function(e,t){var i=[];i.push([e,t]),this._dealEvent(!0,i)},e.prototype.event=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=o(e,1)[0],n=[];"Array"!==Object.prototype.toString.call(i).slice(8,-1)?n[0]=e:n=e,this._dealEvent(!1,n)},e.prototype._dealEvent=function(e,t){var i=this;try{t=t.map(function(e){var t=e[0];/^event\./.test(e[0])&&(t=e[0].slice(6));var n,o=e[1];return"object"!=typeof o&&(o={}),o.profile?delete o.profile:o.event_index=at(),o.local_ms?(n=o.local_ms,delete o.local_ms):n=+new Date,{event:t,params:o,local_time_ms:n,is_bav:i._initConfig.autotrack?1:0}}),e?this._event.beconEvent(t):this._event.event(t),this._session._updateSessionId(),this.plugin&&this.plugin.session&&this.plugin.session.process()}catch(e){}},e.prototype.resetStayDuration=function(e,t,i){!this.plugin||this.plugin.stay?this.plugin&&this.plugin.stay&&this.plugin.stay.reset(e,t,i):this.logger.info("stayDuration is not init")},e.prototype.setExternalAbVersion=function(e){e&&this.plugin&&this.plugin.ab&&this.plugin.ab._setAbVersion(e)},e.prototype.getABconfig=function(e,t){var i=this;this.hook.on("token-error",function(){i.logger.warn("sdk init error, getABconfig return null"),t(null)}),this.plugin&&this.plugin.ab&&this.plugin.ab._getABconfig(e,t)},e.prototype.getVar=function(e,t,i){var n=this;this.hook.on("token-error",function(){n.logger.warn("sdk init error, getVar return default value"),i(t)}),this.plugin&&this.plugin.ab&&this.plugin.ab.getVar(e,t,i)},e.prototype.getAbSdkVersion=function(e){var t=this;this.hook.on("token-error",function(){t.logger.warn("sdk init error, getAbSdkVersion return null"),e(null)}),this.plugin&&this.plugin.ab&&this.plugin.ab.getAbSdkVersion(e)},e.prototype.onAbSdkVersionChange=function(e){this.hook.on("onAbSdkVersionChange",e)},e.prototype.offAbSdkVersionChange=function(e){e?this.hook.off("onAbSdkVersionChange",e):this.hook.off("onAbSdkVersionChange")},e.prototype.openOverlayer=function(){this.plugin&&this.plugin.ab&&this.plugin.ab.openOverlayer()},e.prototype.closeOverlayer=function(){this.plugin&&this.plugin.ab&&this.plugin.ab.closeOverlayer()},e.prototype.getAllVars=function(e){var t=this;this.hook.on("token-error",function(){t.logger.warn("sdk init error, getAllVars return null"),e(null)}),this.plugin&&this.plugin.ab&&this.plugin.ab.getAllVars(e)},e.prototype.profileSet=function(e){this.plugin&&this.plugin.profile&&this.plugin.profile.setProfile(e)},e.prototype.profileSetOnce=function(e){this.plugin&&this.plugin.profile&&this.plugin.profile.setOnceProfile(e)},e.prototype.profileIncrement=function(e){this.plugin&&this.plugin.profile&&this.plugin.profile.incrementProfile(e)},e.prototype.profileUnset=function(e){this.plugin&&this.plugin.profile&&this.plugin.profile.unsetProfile(e)},e.prototype.profileAppend=function(e){this.plugin&&this.plugin.profile&&this.plugin.profile.appendProfile(e)},e.prototype.destroy=function(){this.destroyInstance||(this.destroyInstance=!0)},e}();function ut(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var ht=function(e){var t=this;return ut(this,"_exportCollect",function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];t._isProcess?t._executeCmd.apply(t,i):(t.cmdQueue.push(i),t._processCmd())}),ut(this,"_processCmd",function(){if(0!==t.cmdQueue.length){var e,i,n=(e=t.cmdQueue,"init","0",i=-1,e.forEach(function(e,t){"init"===e[0]&&(i=t)}),i);-1!==n&&(t._isProcess=!0,t._executeCmd.apply(t,t.cmdQueue[n]),t.cmdQueue.forEach(function(e,i){i!==n&&t._executeCmd.apply(t,e)}),t.cmdQueue=[])}}),ut(this,"_executeCmd",function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];var o,r,s=i[0];st.indexOf(s)>-1?(o=t.colloctor)[s].apply(o,i.slice(1)):(r=t.colloctor).event.apply(r,i)}),this.cmdQueue=[],this.name=e,this.colloctor=new ct(e),this._isProcess=!1,this._alias={},this._processCmd(),st.forEach(function(e){t._exportCollect[e]=t._exportCollect.bind(t,e)}),this._exportCollect},lt={},dt={},pt=function(e){return dt[e]||(dt[e]=[]),dt[e]},ft=function(e){try{var t=o(e),i=t[0],n=t.slice(1);if(!i)return void console.error("the eventName is: "+i+", error, stop report, please check");var s=i.split(".");if(1===s.length)pt("default").push(r([i],n));else if(2===s.length)"event"===s[0]?pt("default").push(r([i],n)):pt(s[0]).push(r([s[1]],n));else{var a=s[0],c=[s[1],s[2]].join(".");pt(a).push(r([c],n))}}catch(e){console.log(e)}},_t=function(){mt.q.forEach(function(e){var t=[].slice.call(e);"Array"===Object.prototype.toString.call(t[0]).slice(8,-1)?t.forEach(function(e){ft(e)}):ft(t)}),Object.keys(dt).forEach(function(e){dt[e].forEach(function(t){(function(e){return lt[e]||(lt[e]=new ht(e)),lt[e]})(e).apply(void 0,r(t))}),dt[e]=[]}),mt.q=[]},mt=function e(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.q.push(t),_t()};mt.q=[],mt.l=Date.now(),mt._instanceMap=lt,mt._instanceCmdMap=dt,st.forEach(function(e){mt[e]=mt.bind(null,e)}),_t();var gt=ht;t.default=mt}}]);